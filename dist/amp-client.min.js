var AMPClientFactory;(()=>{var e={7217:(e,t,n)=>{var r=n(3702),i=n(80),s=n(4739),o=n(8655),a=n(1175);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},7828:(e,t,n)=>{var r=n(9325).Uint8Array;e.exports=r},1033:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},4932:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},7805:(e,t,n)=>{var r=n(3360),i=n(5288);e.exports=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},6547:(e,t,n)=>{var r=n(3360),i=n(5288),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var o=e[t];s.call(e,t)&&i(o,n)&&(void 0!==n||t in e)||r(e,t,n)}},6025:(e,t,n)=>{var r=n(5288);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},3360:(e,t,n)=>{var r=n(3243);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},9344:(e,t,n)=>{var r=n(3805),i=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},6649:(e,t,n)=>{var r=n(3221)();e.exports=r},2552:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5250:(e,t,n)=>{var r=n(7217),i=n(7805),s=n(6649),o=n(2824),a=n(3805),c=n(7241),l=n(4974);e.exports=function e(t,n,u,p,d){t!==n&&s(n,(function(s,c){if(d||(d=new r),a(s))o(t,n,c,u,e,p,d);else{var h=p?p(l(t,c),s,c+"",t,n,d):void 0;void 0===h&&(h=s),i(t,c,h)}}),c)}},2824:(e,t,n)=>{var r=n(7805),i=n(3290),s=n(1961),o=n(3007),a=n(5529),c=n(2428),l=n(6449),u=n(3693),p=n(3656),d=n(1882),h=n(3805),f=n(1331),m=n(7167),g=n(4974),b=n(9884);e.exports=function(e,t,n,v,y,E,w){var _=g(e,n),N=g(t,n),T=w.get(N);if(T)r(e,n,T);else{var x=E?E(_,N,n+"",e,t,w):void 0,S=void 0===x;if(S){var R=l(N),A=!R&&p(N),B=!R&&!A&&m(N);x=N,R||A||B?l(_)?x=_:u(_)?x=o(_):A?(S=!1,x=i(N,!0)):B?(S=!1,x=s(N,!0)):x=[]:f(N)||c(N)?(x=_,c(_)?x=b(_):h(_)&&!d(_)||(x=a(N))):S=!1}S&&(w.set(N,x),y(x,N,v,E,w),w.delete(N)),r(e,n,x)}}},4552:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},9302:(e,t,n)=>{var r=n(3488),i=n(6757),s=n(2865);e.exports=function(e,t){return s(i(e,t,r),e+"")}},514:(e,t,n)=>{var r=n(4932);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},9653:(e,t,n)=>{var r=n(7828);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},3290:(e,t,n)=>{e=n.nmd(e);var r=n(9325),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,o=s&&s.exports===i?r.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}},1961:(e,t,n)=>{var r=n(9653);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},3007:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},1791:(e,t,n)=>{var r=n(6547),i=n(3360);e.exports=function(e,t,n,s){var o=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var l=t[a],u=s?s(n[l],e[l],l,n,e):void 0;void 0===u&&(u=e[l]),o?i(n,l,u):r(n,l,u)}return n}},999:(e,t,n)=>{var r=n(9302),i=n(6800);e.exports=function(e){return r((function(t,n){var r=-1,s=n.length,o=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(s--,o):void 0,a&&i(n[0],n[1],a)&&(o=s<3?void 0:o,s=1),t=Object(t);++r<s;){var c=n[r];c&&e(t,c,r,o)}return t}))}},3221:e=>{e.exports=function(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===n(s[c],c,s))break}return t}}},3258:(e,t,n)=>{var r=n(5288),i=Object.prototype,s=i.hasOwnProperty;e.exports=function(e,t,n,o){return void 0===e||r(e,i[n])&&!s.call(o,n)?t:e}},3243:(e,t,n)=>{var r=n(6110),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},1599:(e,t,n)=>{var r=n(4552)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},1911:e=>{var t={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};e.exports=function(e){return"\\"+t[e]}},4840:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},6110:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},8879:(e,t,n)=>{var r=n(4335)(Object.getPrototypeOf,Object);e.exports=r},5529:(e,t,n)=>{var r=n(9344),i=n(8879),s=n(5527);e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:r(i(e))}},6800:e=>{e.exports=function(){return!1}},5527:e=>{e.exports=function(){return!1}},3702:e=>{e.exports=function(){this.__data__=[],this.size=0}},80:(e,t,n)=>{var r=n(6025),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},4739:(e,t,n)=>{var r=n(6025);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},8655:(e,t,n)=>{var r=n(6025);e.exports=function(e){return r(this.__data__,e)>-1}},1175:(e,t,n)=>{var r=n(6025);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},4335:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},6757:(e,t,n)=>{var r=n(1033),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var s=arguments,o=-1,a=i(s.length-t,0),c=Array(a);++o<a;)c[o]=s[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=s[o];return l[t]=n(c),r(e,this,l)}}},4491:e=>{e.exports=/<%-([\s\S]+?)%>/g},4459:e=>{e.exports=/<%([\s\S]+?)%>/g},3681:e=>{e.exports=/<%=([\s\S]+?)%>/g},9325:(e,t,n)=>{var r=n(4840),i="object"==typeof self&&self&&self.Object===Object&&self,s=r||i||Function("return this")();e.exports=s},4974:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},2865:e=>{e.exports=function(e){return e}},1200:(e,t,n)=>{var r=n(1791),i=n(999),s=n(7241),o=i((function(e,t,n,i){r(t,s(t),e,i)}));e.exports=o},8385:(e,t,n)=>{var r=n(1033),i=n(9302),s=n(3546),o=i((function(e,t){try{return r(e,void 0,t)}catch(e){return s(e)?e:new Error(e)}}));e.exports=o},5288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},4425:(e,t,n)=>{var r=n(1599),i=n(3222),s=/[&<>"']/g,o=RegExp(s.source);e.exports=function(e){return(e=i(e))&&o.test(e)?e.replace(s,r):e}},3488:e=>{e.exports=function(e){return e}},2428:e=>{e.exports=function(){return!1}},6449:e=>{var t=Array.isArray;e.exports=t},4894:(e,t,n)=>{var r=n(1882),i=n(294);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},3693:(e,t,n)=>{var r=n(4894),i=n(346);e.exports=function(e){return i(e)&&r(e)}},3656:e=>{e.exports=function(){return!1}},3546:(e,t,n)=>{var r=n(2552),i=n(346),s=n(1331);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!s(e)}},1882:(e,t,n)=>{var r=n(2552),i=n(3805);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},294:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},1331:(e,t,n)=>{var r=n(2552),i=n(8879),s=n(346),o=Function.prototype,a=Object.prototype,c=o.toString,l=a.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==u}},7167:e=>{e.exports=function(){return!1}},5950:(e,t,n)=>{var r=n(4335)(Object.keys,Object);e.exports=r},7241:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},5364:(e,t,n)=>{var r=n(5250),i=n(999)((function(e,t,n){r(e,t,n)}));e.exports=i},872:(e,t,n)=>{var r=n(1200),i=n(8385),s=n(514),o=n(3258),a=n(1911),c=n(3546),l=n(6800),u=n(5950),p=n(3681),d=n(7025),h=n(3222),f=/\b__p \+= '';/g,m=/\b(__p \+=) '' \+/g,g=/(__e\(.*?\)|\b__t\)) \+\n'';/g,b=/[()=,{}\[\]\/\s]/,v=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,y=/($^)/,E=/['\n\r\u2028\u2029\\]/g,w=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var _=d.imports._.templateSettings||d;n&&l(e,t,n)&&(t=void 0),e=h(e),t=r({},t,_,o);var N,T,x=r({},t.imports,_.imports,o),S=u(x),R=s(x,S),A=0,B=t.interpolate||y,O="__p += '",I=RegExp((t.escape||y).source+"|"+B.source+"|"+(B===p?v:y).source+"|"+(t.evaluate||y).source+"|$","g"),C=w.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(I,(function(t,n,r,i,s,o){return r||(r=i),O+=e.slice(A,o).replace(E,a),n&&(N=!0,O+="' +\n__e("+n+") +\n'"),s&&(T=!0,O+="';\n"+s+";\n__p += '"),r&&(O+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),A=o+t.length,t})),O+="';\n";var M=w.call(t,"variable")&&t.variable;if(M){if(b.test(M))throw new Error("Invalid `variable` option passed into `_.template`")}else O="with (obj) {\n"+O+"\n}\n";O=(T?O.replace(f,""):O).replace(m,"$1").replace(g,"$1;"),O="function("+(M||"obj")+") {\n"+(M?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(N?", __e = _.escape":"")+(T?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+O+"return __p\n}";var D=i((function(){return Function(S,C+"return "+O).apply(void 0,R)}));if(D.source=O,c(D))throw D;return D}},7025:(e,t,n)=>{var r=n(4425),i={escape:n(4491),evaluate:n(4459),interpolate:n(3681),variable:"",imports:{_:{escape:r}}};e.exports=i},9884:(e,t,n)=>{var r=n(1791),i=n(7241);e.exports=function(e){return r(e,i(e))}},3222:e=>{e.exports=function(e){return e}},9306:(e,t,n)=>{"use strict";var r=n(4901),i=n(6823),s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not a function")}},3506:(e,t,n)=>{"use strict";var r=n(3925),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s("Can't set "+i(e)+" as a prototype")}},679:(e,t,n)=>{"use strict";var r=n(1625),i=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new i("Incorrect invocation")}},8551:(e,t,n)=>{"use strict";var r=n(34),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not an object")}},9617:(e,t,n)=>{"use strict";var r=n(5397),i=n(5610),s=n(6198),o=function(e){return function(t,n,o){var a=r(t),c=s(a);if(0===c)return!e&&-1;var l,u=i(o,c);if(e&&n!=n){for(;c>u;)if((l=a[u++])!=l)return!0}else for(;c>u;u++)if((e||u in a)&&a[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},4527:(e,t,n)=>{"use strict";var r=n(3724),i=n(4376),s=TypeError,o=Object.getOwnPropertyDescriptor,a=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(i(e)&&!o(e,"length").writable)throw new s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},2195:(e,t,n)=>{"use strict";var r=n(9504),i=r({}.toString),s=r("".slice);e.exports=function(e){return s(i(e),8,-1)}},6955:(e,t,n)=>{"use strict";var r=n(2140),i=n(4901),s=n(2195),o=n(8227)("toStringTag"),a=Object,c="Arguments"===s(function(){return arguments}());e.exports=r?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=a(e),o))?n:c?s(t):"Object"===(r=s(t))&&i(t.callee)?"Arguments":r}},7740:(e,t,n)=>{"use strict";var r=n(9297),i=n(5031),s=n(7347),o=n(4913);e.exports=function(e,t,n){for(var a=i(t),c=o.f,l=s.f,u=0;u<a.length;u++){var p=a[u];r(e,p)||n&&r(n,p)||c(e,p,l(t,p))}}},6699:(e,t,n)=>{"use strict";var r=n(3724),i=n(4913),s=n(6980);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},6980:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6840:(e,t,n)=>{"use strict";var r=n(4901),i=n(4913),s=n(283),o=n(9433);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:t;if(r(n)&&s(n,l,a),a.global)c?e[t]=n:o(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},9433:(e,t,n)=>{"use strict";var r=n(4576),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4606:(e,t,n)=>{"use strict";var r=n(6823),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+r(t)+" of "+r(e))}},3724:(e,t,n)=>{"use strict";var r=n(9039);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:(e,t,n)=>{"use strict";var r=n(4576),i=n(34),s=r.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},6837:e=>{"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},5002:e=>{"use strict";e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8727:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2839:(e,t,n)=>{"use strict";var r=n(4576).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},9519:(e,t,n)=>{"use strict";var r,i,s=n(4576),o=n(2839),a=s.process,c=s.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},6193:(e,t,n)=>{"use strict";var r=n(9504),i=Error,s=r("".replace),o=String(new i("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,c=a.test(o);e.exports=function(e,t){if(c&&"string"==typeof e&&!i.prepareStackTrace)for(;t--;)e=s(e,a,"");return e}},6518:(e,t,n)=>{"use strict";var r=n(4576),i=n(7347).f,s=n(6699),o=n(6840),a=n(9433),c=n(7740),l=n(2796);e.exports=function(e,t){var n,u,p,d,h,f=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[f]||a(f,{}):r[f]&&r[f].prototype)for(u in t){if(d=t[u],p=e.dontCallGetSet?(h=i(n,u))&&h.value:n[u],!l(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==p){if(typeof d==typeof p)continue;c(d,p)}(e.sham||p&&p.sham)&&s(d,"sham",!0),o(n,u,d,e)}}},9039:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},616:(e,t,n)=>{"use strict";var r=n(9039);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9565:(e,t,n)=>{"use strict";var r=n(616),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},350:(e,t,n)=>{"use strict";var r=n(3724),i=n(9297),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},6706:(e,t,n)=>{"use strict";var r=n(9504),i=n(9306);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},9504:(e,t,n)=>{"use strict";var r=n(616),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);e.exports=r?o:function(e){return function(){return s.apply(e,arguments)}}},7751:(e,t,n)=>{"use strict";var r=n(4576),i=n(4901);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},5966:(e,t,n)=>{"use strict";var r=n(9306),i=n(4117);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},4576:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(e,t,n)=>{"use strict";var r=n(9504),i=n(8981),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},421:e=>{"use strict";e.exports={}},5917:(e,t,n)=>{"use strict";var r=n(3724),i=n(9039),s=n(4055);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},7055:(e,t,n)=>{"use strict";var r=n(9504),i=n(9039),s=n(2195),o=Object,a=r("".split);e.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?a(e,""):o(e)}:o},3167:(e,t,n)=>{"use strict";var r=n(4901),i=n(34),s=n(2967);e.exports=function(e,t,n){var o,a;return s&&r(o=t.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(e,a),e}},3706:(e,t,n)=>{"use strict";var r=n(9504),i=n(4901),s=n(7629),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},1181:(e,t,n)=>{"use strict";var r,i,s,o=n(8622),a=n(4576),c=n(34),l=n(6699),u=n(9297),p=n(7629),d=n(6119),h=n(421),f="Object already initialized",m=a.TypeError,g=a.WeakMap;if(o||p.state){var b=p.state||(p.state=new g);b.get=b.get,b.has=b.has,b.set=b.set,r=function(e,t){if(b.has(e))throw new m(f);return t.facade=e,b.set(e,t),t},i=function(e){return b.get(e)||{}},s=function(e){return b.has(e)}}else{var v=d("state");h[v]=!0,r=function(e,t){if(u(e,v))throw new m(f);return t.facade=e,l(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},4376:(e,t,n)=>{"use strict";var r=n(2195);e.exports=Array.isArray||function(e){return"Array"===r(e)}},4901:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},2796:(e,t,n)=>{"use strict";var r=n(9039),i=n(4901),s=/#|\.prototype\./,o=function(e,t){var n=c[a(e)];return n===u||n!==l&&(i(t)?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},4117:e=>{"use strict";e.exports=function(e){return null==e}},34:(e,t,n)=>{"use strict";var r=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},3925:(e,t,n)=>{"use strict";var r=n(34);e.exports=function(e){return r(e)||null===e}},6395:e=>{"use strict";e.exports=!1},757:(e,t,n)=>{"use strict";var r=n(7751),i=n(4901),s=n(1625),o=n(7040),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&s(t.prototype,a(e))}},6198:(e,t,n)=>{"use strict";var r=n(8014);e.exports=function(e){return r(e.length)}},283:(e,t,n)=>{"use strict";var r=n(9504),i=n(9039),s=n(4901),o=n(9297),a=n(3724),c=n(350).CONFIGURABLE,l=n(3706),u=n(1181),p=u.enforce,d=u.get,h=String,f=Object.defineProperty,m=r("".slice),g=r("".replace),b=r([].join),v=a&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),E=e.exports=function(e,t,n){"Symbol("===m(h(t),0,7)&&(t="["+g(h(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!o(e,"name")||c&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&o(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=p(e);return o(r,"source")||(r.source=b(y,"string"==typeof t?t:"")),e};Function.prototype.toString=E((function(){return s(this)&&d(this).source||l(this)}),"toString")},741:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},2603:(e,t,n)=>{"use strict";var r=n(655);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},4913:(e,t,n)=>{"use strict";var r=n(3724),i=n(5917),s=n(8686),o=n(8551),a=n(6969),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,p="enumerable",d="configurable",h="writable";t.f=r?s?function(e,t,n){if(o(e),t=a(t),o(n),"function"==typeof e&&"prototype"===t&&"value"in n&&h in n&&!n[h]){var r=u(e,t);r&&r[h]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:p in n?n[p]:r[p],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(o(e),t=a(t),o(n),i)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},7347:(e,t,n)=>{"use strict";var r=n(3724),i=n(9565),s=n(8773),o=n(6980),a=n(5397),c=n(6969),l=n(9297),u=n(5917),p=Object.getOwnPropertyDescriptor;t.f=r?p:function(e,t){if(e=a(e),t=c(t),u)try{return p(e,t)}catch(e){}if(l(e,t))return o(!i(s.f,e,t),e[t])}},8480:(e,t,n)=>{"use strict";var r=n(1828),i=n(8727).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},3717:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},1625:(e,t,n)=>{"use strict";var r=n(9504);e.exports=r({}.isPrototypeOf)},1828:(e,t,n)=>{"use strict";var r=n(9504),i=n(9297),s=n(5397),o=n(9617).indexOf,a=n(421),c=r([].push);e.exports=function(e,t){var n,r=s(e),l=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&c(u,n);for(;t.length>l;)i(r,n=t[l++])&&(~o(u,n)||c(u,n));return u}},8773:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2967:(e,t,n)=>{"use strict";var r=n(6706),i=n(34),s=n(7750),o=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return s(n),o(r),i(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},4270:(e,t,n)=>{"use strict";var r=n(9565),i=n(4901),s=n(34),o=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!s(a=r(n,e)))return a;if(i(n=e.valueOf)&&!s(a=r(n,e)))return a;if("string"!==t&&i(n=e.toString)&&!s(a=r(n,e)))return a;throw new o("Can't convert object to primitive value")}},5031:(e,t,n)=>{"use strict";var r=n(7751),i=n(9504),s=n(8480),o=n(3717),a=n(8551),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(a(e)),n=o.f;return n?c(t,n(e)):t}},7750:(e,t,n)=>{"use strict";var r=n(4117),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},6119:(e,t,n)=>{"use strict";var r=n(5745),i=n(3392),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},7629:(e,t,n)=>{"use strict";var r=n(6395),i=n(4576),s=n(9433),o="__core-js_shared__",a=e.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(e,t,n)=>{"use strict";var r=n(7629);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},4495:(e,t,n)=>{"use strict";var r=n(9519),i=n(9039),s=n(4576).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},5610:(e,t,n)=>{"use strict";var r=n(1291),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},5397:(e,t,n)=>{"use strict";var r=n(7055),i=n(7750);e.exports=function(e){return r(i(e))}},1291:(e,t,n)=>{"use strict";var r=n(741);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},8014:(e,t,n)=>{"use strict";var r=n(1291),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8981:(e,t,n)=>{"use strict";var r=n(7750),i=Object;e.exports=function(e){return i(r(e))}},2777:(e,t,n)=>{"use strict";var r=n(9565),i=n(34),s=n(757),o=n(5966),a=n(4270),c=n(8227),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var n,c=o(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!i(n)||s(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},6969:(e,t,n)=>{"use strict";var r=n(2777),i=n(757);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2140:(e,t,n)=>{"use strict";var r={};r[n(8227)("toStringTag")]="z",e.exports="[object z]"===String(r)},655:(e,t,n)=>{"use strict";var r=n(6955),i=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},6823:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},3392:(e,t,n)=>{"use strict";var r=n(9504),i=0,s=Math.random(),o=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},7040:(e,t,n)=>{"use strict";var r=n(4495);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(e,t,n)=>{"use strict";var r=n(3724),i=n(9039);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(e,t,n)=>{"use strict";var r=n(4576),i=n(4901),s=r.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},8227:(e,t,n)=>{"use strict";var r=n(4576),i=n(5745),s=n(9297),o=n(3392),a=n(4495),c=n(7040),l=r.Symbol,u=i("wks"),p=c?l.for||l:l&&l.withoutSetter||o;e.exports=function(e){return s(u,e)||(u[e]=a&&s(l,e)?l[e]:p("Symbol."+e)),u[e]}},4114:(e,t,n)=>{"use strict";var r=n(6518),i=n(8981),s=n(6198),o=n(4527),a=n(6837);r({target:"Array",proto:!0,arity:1,forced:n(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=i(this),n=s(t),r=arguments.length;a(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return o(t,n),n}})},3609:(e,t,n)=>{"use strict";var r=n(6518),i=n(8981),s=n(6198),o=n(4527),a=n(4606),c=n(6837);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=i(this),n=s(t),r=arguments.length;if(r){c(n+r);for(var l=n;l--;){var u=l+r;l in t?t[u]=t[l]:a(t,u)}for(var p=0;p<r;p++)t[p]=arguments[p]}return o(t,n+r)}})},4979:(e,t,n)=>{"use strict";var r=n(6518),i=n(4576),s=n(7751),o=n(6980),a=n(4913).f,c=n(9297),l=n(679),u=n(3167),p=n(2603),d=n(5002),h=n(6193),f=n(3724),m=n(6395),g="DOMException",b=s("Error"),v=s(g),y=function(){l(this,E);var e=arguments.length,t=p(e<1?void 0:arguments[0]),n=p(e<2?void 0:arguments[1],"Error"),r=new v(t,n),i=new b(t);return i.name=g,a(r,"stack",o(1,h(i.stack,1))),u(r,this,y),r},E=y.prototype=v.prototype,w="stack"in new b(g),_="stack"in new v(1,2),N=v&&f&&Object.getOwnPropertyDescriptor(i,g),T=!(!N||N.writable&&N.configurable),x=w&&!T&&!_;r({global:!0,constructor:!0,forced:m||x},{DOMException:x?y:v});var S=s(g),R=S.prototype;if(R.constructor!==S)for(var A in m||a(R,"constructor",o(1,S)),d)if(c(d,A)){var B=d[A],O=B.s;c(S,O)||a(S,O,o(6,B.c))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var r={};(()=>{"use strict";n.d(r,{default:()=>Le});var e={};n.r(e),n.d(e,{exclude:()=>I,extract:()=>x,parse:()=>S,parseUrl:()=>A,pick:()=>O,stringify:()=>R,stringifyUrl:()=>B});class t{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get semver(){return this.#e}get full(){return this.#t}}n(4114);var i=n(5364);const s={single:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--single"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',random:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--random"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',multiple:'\n    <% if(data.length) { %>\n        <div class="amp-banner amp-banner--multiple">\n            <div class="amp-banner__list">\n                <% for (index in data) { var b = data[index]; %>\n                    <div class="amp-banner__item"\n                         data-amp-banner-fingerprint="<%= b.fingerprint %>">\n    \n                        <% if(\'img\' === b.content.type) { %>\n                            <a class="amp-banner__content amp-banner__content--img"\n                               href="<%= b.content.href %>"\n                               <% if(null !== b.content.target) { %>target="<%- b.content.target %>"<% } %>>\n                                <picture>\n                                    <% (b.content.sources || []).forEach(function(source) { %>\n                                        <source type="<%= source.type %>"\n                                                srcset="<%= source.srcset %>"\n                                                sizes="<%- b.content.sizes %>">\n                                    <% }); %>\n                                    <img srcset="<%= b.content.srcset %>"\n                                         src="<%= b.content.src %>"\n                                         sizes="<%- b.content.sizes %>"\n                                         alt="<%- b.content.alt %>"\n                                         <% if(null !== b.content.dimensions.width) { %>width="<%- b.content.dimensions.width %>"<% } %>\n                                         <% if(null !== b.content.dimensions.height) { %>height="<%- b.content.dimensions.height %>"<% } %>\n                                         <% if(\'\' !== b.content.title) { %>title="<%- b.content.title %>"<% } %>\n                                         <% var loading; if(loading = banner.options.evaluate(\'loading\', index)) { %>loading="<%- loading %>"<% } %>\n                                         <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', index)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                                </picture>\n                            </a>\n                        <% } else if (\'html\' === b.content.type) { %>\n                            <div class="amp-banner__content amp-banner__content--html">\n                                <%= b.content.html %>\n                            </div>\n                        <% } %>\n    \n                    </div>\n                <% } %>\n            </div>\n        </div>\n    <% } %>\n'},o=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};class a{constructor(){if(this.constructor===a)throw new TypeError("Can not construct abstract class AbstractGateway.");if(this.fetch===a.prototype.fetch)throw new TypeError("Please implement abstract method ::fetch().")}fetch(e,t){throw new TypeError("Do not call abstract method ::fetch() from child.")}}const c="%[a-f0-9]{2}",l=new RegExp("("+c+")|([^%]+?)","gi"),u=new RegExp("("+c+")+","gi");function p(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],p(n),p(r))}function d(e){try{return decodeURIComponent(e)}catch{let t=e.match(l)||[];for(let n=1;n<t.length;n++)t=(e=p(t,n).join("")).match(l)||[];return e}}function h(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"��","%FF%FE":"��"};let n=u.exec(e);for(;n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{const e=d(n[0]);e!==n[0]&&(t[n[0]]=e)}n=u.exec(e)}t["%C2"]="�";const r=Object.keys(t);for(const n of r)e=e.replace(new RegExp(n,"g"),t[n]);return e}(e)}}function f(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const n=e.indexOf(t);return-1===n?[]:[e.slice(0,n),e.slice(n+t.length)]}function m(e,t){const n={};if(Array.isArray(t))for(const r of t){const t=Object.getOwnPropertyDescriptor(e,r);t?.enumerable&&Object.defineProperty(n,r,t)}else for(const r of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){t(r,e[r],e)&&Object.defineProperty(n,r,i)}}return n}const g=e=>null==e,b=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)),v=Symbol("encodeFragmentIdentifier");function y(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function E(e,t){return t.encode?t.strict?b(e):encodeURIComponent(e):e}function w(e,t){return t.decode?h(e):e}function _(e){return Array.isArray(e)?e.sort():"object"==typeof e?_(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function N(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function T(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function x(e){const t=(e=N(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function S(e,t){y((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...t}).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!i&&w(n,e).includes(e.arrayFormatSeparator);n=s?w(n,e):n;const o=i||s?n.split(e.arrayFormatSeparator).map((t=>w(t,e))):null===n?n:w(n,e);r[t]=o};case"bracket-separator":return(t,n,r)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i)return void(r[t]=n?w(n,e):n);const s=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>w(t,e)));void 0!==r[t]?r[t]=[...r[t],...s]:r[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[...[n[e]].flat(),t]:n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){if(""===i)continue;const e=t.decode?i.replace(/\+/g," "):i;let[s,o]=f(e,"=");void 0===s&&(s=e),o=void 0===o?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?o:w(o,t),n(w(s,t),o,r)}for(const[e,n]of Object.entries(r))if("object"==typeof n&&null!==n)for(const[e,r]of Object.entries(n))n[e]=T(r,t);else r[e]=T(n,t);return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=_(n):e[t]=n,e}),Object.create(null))}function R(e,t){if(!e)return"";y((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const n=n=>t.skipNull&&g(e[n])||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[E(t,e),"[",i,"]"].join("")]:[...n,[E(t,e),"[",E(i,e),"]=",E(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[E(t,e),"[]"].join("")]:[...n,[E(t,e),"[]=",E(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[E(t,e),":list="].join("")]:[...n,[E(t,e),":list=",E(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length?[[E(n,e),t,E(i,e)].join("")]:[[r,E(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,E(t,e)]:[...n,[E(t,e),"=",E(r,e)].join("")]}}(t),i={};for(const[t,r]of Object.entries(e))n(t)||(i[t]=r);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((n=>{const i=e[n];return void 0===i?"":null===i?E(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?E(n,t)+"[]":i.reduce(r(n),[]).join("&"):E(n,t)+"="+E(i,t)})).filter((e=>e.length>0)).join("&")}function A(e,t){t={decode:!0,...t};let[n,r]=f(e,"#");return void 0===n&&(n=e),{url:n?.split("?")?.[0]??"",query:S(x(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:w(r,t)}:{}}}function B(e,t){t={encode:!0,strict:!0,[v]:!0,...t};const n=N(e.url).split("?")[0]||"";let r=R({...S(x(e.url),{sort:!1}),...e.query},t);r&&(r=`?${r}`);let i=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);if(e.fragmentIdentifier){const r=new URL(n);r.hash=e.fragmentIdentifier,i=t[v]?r.hash:`#${e.fragmentIdentifier}`}return`${n}${r}${i}`}function O(e,t,n){n={parseFragmentIdentifier:!0,[v]:!1,...n};const{url:r,query:i,fragmentIdentifier:s}=A(e,n);return B({url:r,query:m(i,t),fragmentIdentifier:s},n)}function I(e,t,n){return O(e,Array.isArray(t)?e=>!t.includes(e):(e,n)=>!t(e,n),n)}const C=e;class M extends a{fetch(e,t,n){const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(XMLHttpRequest.DONE!==r.readyState||0===r.status)return!1;const e=JSON.parse(r.responseText);200<=r.status&&300>r.status?t(e):n(e)},r.onerror=()=>{n({status:"error",data:{code:r.status,error:r.statusText||"unknown"}})};let i=e.endpoint;"GET"===e.method&&(i+=`?${C.stringify(e.parameters)}`),r.open(e.method,i,!0),r.overrideMimeType("application/json"),r.setRequestHeader("Accept","application/json");for(let t of e.headers)r.setRequestHeader(t.name,t.value);r.send("POST"===e.method?JSON.stringify(e.parameters):null)}}class D extends a{#n;constructor(e){super(),this.#n=e}fetch(e,t,n){const r=2>e.version?e=>{const{status:n,data:r,settings:i}=e;t({status:n,positions:r,settings:i||{},response:e})}:e=>{const{status:n,data:r}=e;t({status:n,positions:r.positions||{},settings:r.settings||{},response:e})};this.#n.fetch(e,r,n)}}class k{#r;#i;constructor(e,t){this.#r=e,this.#i=this.#s(t)}get name(){return this.#r}get value(){return this.#i}withValues(e){return new k(this.name,this.#s(e).concat(this.value).filter(((e,t,n)=>n.indexOf(e)===t)))}#s(e){return Array.isArray(e)?e:[e]}}class j{#o;#a;#c;#l;#u;#p;#d;constructor(e){let{method:t,endpoint:n,version:r,locale:i=null,defaultResources:s=[],headers:o=[]}=e;this.#o=t,this.#a=n,this.#c=r,this.#l=i,this.#u={},this.#p=s,this.#d=o}addPosition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.#u;if(e in r)throw new Error('Position "'+e+'" already exists.');r[e]={},n&&this.addPositionResources(e,this.#p),this.addPositionResources(e,t)}addPositionResources(e,t){for(let n in t)this.addPositionResource(e,t[n])}addPositionResource(e,t){if(!(t instanceof k))throw new TypeError("Argument resource must be instance of Resource class.");const n=this.#u;if(!(e in n))throw new Error('Missing position "'+e+'".');const r=n[e];t.name in r?r[t.name]=r[t.name].withValues(t.value):r[t.name]=t}get method(){return this.#o}get endpoint(){return this.#a}get version(){return this.#c}get locale(){return this.#l}get parameters(){const e=this.#h(this.#u),t={query:"GET"===this.method?JSON.stringify(e):e};return null!==this.locale&&(t.locale=this.locale),t}get headers(){return this.#d}#h=e=>{const t={};for(let n in e){t[n]={};for(let r in e[n]){const i=e[n][r].value.filter((e=>""!==e));i.length&&(t[n][r]=i)}}return t}}class L{#o;#a;#l;#c;#p;#f;constructor(e,t,n,r){this.#o=e,this.#a=`${t}/api/v${n}/content/${encodeURIComponent(r)}`,this.#l=null,this.#c=n,this.#p=[],this.#f=null}set locale(e){this.#l=e}set origin(e){this.#f=e}addDefaultResource(e,t){this.#p.push(new k(e,t))}create(){const e=[];return"string"==typeof this.#f&&""!==this.#f&&e.push({name:"X-Amp-Origin",value:this.#f}),new j({method:this.#o,endpoint:this.#a,version:this.#c,locale:this.#l,defaultResources:this.#p,headers:e})}}class F{#a;#l;#p;constructor(e,t,n){this.#a=`${e}/api/v${t}/preview/position/${encodeURIComponent(n)}`,this.#l=null,this.#p={}}set locale(e){this.#l=e}addDefaultResource(e,t){const n=this.#p,r=new k(e,t);r.name in n?n[r.name]=n[r.name].withValues(r.value):n[r.name]=r}create(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"1"!==(r["omit-default-resources"]||"0").toString()?t={...this.#p}:(t={},delete r["omit-default-resources"]);for(let e in n){const r=new k(e,n[e]);r.name in t?t[r.name]=t[r.name].withValues(r.value):t[r.name]=r}let i={};for(let e in t){t[e].value.filter((e=>""!==e)).length&&(i[e]=t[e].value)}i=JSON.stringify(i);const s=JSON.stringify(r),o={};"{}"!==i&&(o.resources=i),"{}"!==s&&(o.options=s),null!==this.#l&&(o.locale=this.#l);const a=C.stringify(o);return`${this.#a}/${encodeURIComponent(e)}${""!==a?"?"+a:""}`}}class P{static get NEW(){return"NEW"}static get RENDERED(){return"RENDERED"}static get NOT_FOUND(){return"NOT_FOUND"}static get ERROR(){return"ERROR"}static get CLOSED(){return"CLOSED"}static get STATES(){return[P.NEW,P.RENDERED,P.NOT_FOUND,P.ERROR,P.CLOSED]}}class ${static get ON_BANNER_ATTACHED(){return"amp:banner:attached"}static get ON_BANNER_STATE_CHANGED(){return"amp:banner:state-changed"}static get ON_BANNER_INTERSECTION_CHANGED(){return"amp:banner:intersection-changed"}static get ON_BANNER_FIRST_TIME_SEEN(){return"amp:banner:first-time-seen"}static get ON_BANNER_FIRST_TIME_FULLY_SEEN(){return"amp:banner:first-time-fully-seen"}static get ON_BANNER_LINK_CLICKED(){return"amp:banner:link-clicked"}static get ON_BANNER_BEFORE_CLOSE(){return"amp:banner:before-close"}static get ON_BANNER_AFTER_CLOSE(){return"amp:banner:after-close"}static get ON_BANNER_MUTATED(){return"amp:banner:mutated"}static get ON_BEFORE_FETCH(){return"amp:fetch:before"}static get ON_FETCH_ERROR(){return"amp:fetch:error"}static get ON_FETCH_SUCCESS(){return"amp:fetch:success"}}class U{constructor(e){let{id:t,code:n,name:r,rotationSeconds:i,displayType:s,breakpointType:o,closedExpiration:a=null}=e;this.id=t,this.code=n,this.name=r,this.rotationSeconds=i,this.displayType=s,this.breakpointType=o,this.closedExpiration=a}static createInitial(e){return new U({id:null,code:e,name:null,rotationSeconds:0,displayType:null,breakpointType:null,closedExpiration:null})}isSingle(){return"single"===this.displayType}isRandom(){return"random"===this.displayType}isMultiple(){return"multiple"===this.displayType}toObject(){return{id:this.id,code:this.code,name:this.name,rotationSeconds:this.rotationSeconds,displayType:this.displayType,breakpointType:this.breakpointType,closedExpiration:this.closedExpiration}}}const W=/^(?:(?<INTERVAL_FROM>\d+)-(?<INTERVAL_TO>\d+):|(?<EQ>\d+):|<(?<LT>\d+):|<=(?<LTE>\d+):|>(?<GT>\d+):|>=(?<GTE>\d+):)?(?<VALUE>[^:\s]+)$/,H={};function G(e,t){const n=function(e){if(e in H)return H[e];const t=e.split(",").map((e=>e.trim())),n=[];for(let e=0;e<t.length;e++){const r=t[e].match(W);if(null===r||void 0===r.groups||void 0===r.groups.VALUE)continue;let i;switch(!0){case void 0!==r.groups.INTERVAL_FROM&&void 0!==r.groups.INTERVAL_TO:i={from:parseInt(r.groups.INTERVAL_FROM),to:parseInt(r.groups.INTERVAL_TO),matches:function(e){return e>=this.from&&e<=this.to}};break;case void 0!==r.groups.EQ:i={eq:parseInt(r.groups.EQ),matches:function(e){return e===this.eq}};break;case void 0!==r.groups.LT:i={lt:parseInt(r.groups.LT),matches:function(e){return e<this.lt}};break;case void 0!==r.groups.LTE:i={lte:parseInt(r.groups.LTE),matches:function(e){return e<=this.lte}};break;case void 0!==r.groups.GT:i={gt:parseInt(r.groups.GT),matches:function(e){return e>this.gt}};break;case void 0!==r.groups.GTE:i={gte:parseInt(r.groups.GTE),matches:function(e){return e>=this.gte}};break;default:i={matches:function(){return!0}}}i&&(i.matches=i.matches.bind(i),i.value=r.groups.VALUE,n.push(i))}const r={rules:n,cache:{}};return r.evaluate=function(e){Number.isInteger(e)||(e=parseInt(e));const t=`i_${e}`;if(t in this.cache)return this.cache[t];for(let n=0;n<this.rules.length;n++){const r=this.rules[n];if(r.matches(e))return this.cache[t]=r.value}return this.cache[t]=null}.bind(r),H[e]=r,r}(e);return n.evaluate(t)}class q{constructor(e){this.options={},this.options=this.#m({...e})}has(e){return void 0!==this.options[e]}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.options[e]||t}evaluate(e,t){return void 0===this.options[e]?null:G(this.options[e],t)}override(e){this.options={...this.options,...this.#m({...e})}}#m(e){if("loading-offset"in e){const t=e["loading-offset"],n="loading"in e?e.loading:"loading"in this.options?this.options.loading:null,r=null!==n?`>=${t}:${n}`:null;let i='AMP deprecation warning: The banner option "loading-offset" is deprecated and will be removed in some future release.';null!==r&&(i+=` Instead of options {"loading": "${n}", "loading-offset": "${t}"} use an expression based option {"loading": "${r}"}.`),console.warn(i),delete e["loading-offset"],null!==r&&(e.loading=r)}return e}}class V{#g;#b;#v;#y=null;#E=null;#w={};constructor(e,t,n,r,i){if(this.constructor===V)throw new TypeError("Can not construct abstract class Banner.");this.#g=t,this.#b=n,this.#v=new q(i),this._eventBus=e,this._positionData=U.createInitial(r),this.STATE=P}get uid(){return this.#g}get element(){return this.#b}get state(){return this.#y}get stateInfo(){return this.#E}get stateCounter(){return this.#w[this.state]||0}get position(){return this.positionData.code}get positionData(){return this._positionData}get options(){return this.#v}get fingerprints(){return[]}unsetFingerprint(e){}setState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(-1===this.STATE.STATES.indexOf(e))throw new TypeError(`${e} is not valid state.`);this.#y=e,this.#E=t.toString(),this.#w[e]=(this.#w[e]||0)+1,this._eventBus.dispatch($.ON_BANNER_STATE_CHANGED,{banner:this})}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.startsWith("amp:banner:"))throw new Error(`Unable to attach listener on event "${e}" through a banner.`);return this._eventBus.subscribe(e,(function(e){const{banner:r}=e;r===this&&(null!==n?t.call(n,e):t(e))}),this)}getCurrentBreakpoint(e){return null}overrideOptions(e){this.#v.override(e)}redrawIfNeeded(){}isManaged(){return!1}isExternal(){return!1}isEmbed(){return!1}}n(4979);class Q{constructor(e,t){let{bannerId:n,bannerName:r,positionId:i,positionCode:s,positionName:o,campaignId:a,campaignCode:c,campaignName:l,closedExpiration:u=null}=t;this.value=e,this.bannerId=n,this.bannerName=r,this.positionId=i,this.positionCode=s,this.positionName=o,this.campaignId=a,this.campaignCode=c,this.campaignName=l,this.closedExpiration=u}static createFromProperties(e){return new Q(btoa(encodeURIComponent(JSON.stringify(e))),e)}static createFromValue(e){return new Q(e,JSON.parse(decodeURIComponent(atob(e))))}toString(){return this.value}}n(3609);class z{#_;#N;constructor(e,t){this.#_=e,this.#N=t}get breakpoint(){return this.#_}get data(){return this.#N}}class Y{#T;#x;#S=[];#R=void 0;#A={min:null,max:null,reset:function(){this.min=this.max=null}};constructor(e,t){this.#T=e,this.#x=t}addContent(e,t){this.#S.push(new z(e,t)),this.#R=void 0}get contents(){return this.#S}get content(){if(void 0!==this.#R&&!this.needRedraw())return this.#R;this.#A.reset();const e=this.#T.width,t=this.#x;let n=null,r=null,i=null;const s=[];this.#B(this.#S,(o=>{let a=o.breakpoint;null!==a?(s.push(a),("min"===t&&e>=a&&(null===i||i<a)||"max"===t&&e<=a&&(null===i||i>a))&&(r=o,i=a,this.#A[t]=a)):n=o})),s.sort(((e,t)=>e-t)),"min"===t?s.unshift(null):s.push(null);const o=s.indexOf(i);return"max"===t&&o-1 in s&&(this.#A.min=s[o-1]+1),"min"===t&&o+1 in s&&(this.#A.max=s[o+1]-1),this.#R=null!==r?r:n}needRedraw(){if(void 0===this.#R)return!0;const e=this.#T.width;return null!==this.#A.min&&e<this.#A.min||null!==this.#A.max&&e>this.#A.max}#B(e,t){for(let n in e)t(e[n],n)}}class J{#N;#S;#O=null;constructor(e,t,n){this.#N=e,this.#S=new Y(n,t);for(let e of this.#N.contents)"img"!==e.type||"dimensions"in e||(e.dimensions={width:null,height:null}),this.#S.addContent(e.breakpoint,e)}set fingerprint(e){if(!(e instanceof Q))throw new TypeError("The value must be instance of Fingerprint object.");this.#O=e}get fingerprint(){return this.#O}get id(){return this.#N.id}get name(){return this.#N.name||null}get score(){return this.#N.score}get campaign(){return console.warn("Usage of deprecated property `BannerData.campaign`. Please use property `campaignCode` instead."),this.campaignCode()}get campaignId(){return this.#N.campaign_id||null}get campaignCode(){return this.#N.campaign_code||this.#N.campaign||null}get campaignName(){return this.#N.campaign_name||null}get closedExpiration(){return"closed_expiration"in this.#N?this.#N.closed_expiration:null}get content(){return this.#S.content?.data||null}needRedraw(){return this.#S.needRedraw()}}class K{#I;constructor(e){this.#I=e}get positionCode(){return this.#I.positionData.code}get rotationSeconds(){return this.#I.positionData.rotationSeconds}get displayType(){return this.#I.positionData.displayType}get breakpointType(){return this.#I.positionData.breakpointType}get fingerprints(){return this.#I.fingerprints}get bannerData(){return this.#I.bannerData}}class X{static randomByWeights(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"weight";const n={};let r=0;for(let n=0;n<e.length;n++)r+=e[n][t];for(let i=0;i<e.length;i++)n[i]=e[i][t]/r;let i=0,s=Math.random();for(;s>0;)s-=n[i],i++;return i--,e[i]?e[i]:e[0]}}function Z(e,t){if(e instanceof t.HTMLElement)return e;if("string"!=typeof e)throw new TypeError("Element must be instance of HTMLElement or String");let n;if(n="#"===e.charAt(0)?document.getElementById(e.slice(1)):document.querySelector(e),!(n instanceof t.HTMLElement))throw new TypeError("Selector "+e+" is invalid.");return n}function ee(e){Array.from(e.getElementsByTagName("script")).forEach((e=>{if(""!==e.type&&"text/javascript"!==e.type)return;const t=document.createElement("script");Array.from(e.attributes).forEach((e=>{t.setAttribute(e.name,e.value)})),t.appendChild(document.createTextNode(e.innerHTML)),e.parentNode.replaceChild(t,e)}))}class te extends V{#T;#C;#M=[];#D;#k=!1;#j=null;#L=[];constructor(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};super(n,r,i,s,arguments.length>7&&void 0!==arguments[7]?arguments[7]:{}),this.#T=e,this.#C=t,this.#D=o;for(let e in o)this.#M.push(new k(e,o[e]));this.setState(this.STATE.NEW,"Banner created.")}set html(e){this.element.innerHTML=e,ee(this.element)}get resources(){return this.#M}get rawResources(){return this.#D}get data(){return console.warn("Usage of deprecated property `ManagedBanner.data`. Please use property `positionData` for accessing information about a position."),new K(this)}get fingerprints(){let e;try{e=this.bannerData}catch(e){return[]}return null===e?[]:(this.positionData.isMultiple()||(e=[e]),e.map((e=>e.fingerprint)))}get bannerData(){if(null!==this.#j)return this.#j;if(!this.#L.length)return null;let e=null;const t=this.positionData,n=e=>Q.createFromProperties({bannerId:e.id,bannerName:e.name,positionId:t.id,positionCode:t.code,positionName:t.name,campaignId:e.campaignId,campaignCode:e.campaignCode,campaignName:e.campaignName,closedExpiration:e.closedExpiration});switch(!0){case t.isSingle():e=this.#L.reduce(((e,t)=>e.score>=t.score?e:t)),e.fingerprint=n(e);break;case t.isRandom():e=X.randomByWeights(this.#L,"score"),e.fingerprint=n(e);break;case t.isMultiple():e=this.#L.sort(((e,t)=>t.score-e.score));for(let t of e)t.fingerprint=n(t);break;default:throw new Error(`Invalid display type ${this.displayType}.`)}return this.#j=e,e}unsetFingerprint(e){const t=e.bannerId,n=this.positionData;if(!!this.#L.filter((e=>e.id===t))[0]){switch(!0){case n.isSingle():this.#L=[],this.#j=null;break;case n.isRandom():this.#j&&this.#j.id===t?(this.#L=[],this.#j=null):this.#L=this.#L.filter((e=>e.id!==t));break;case n.isMultiple():this.#L=this.#L.filter((e=>e.id!==t)),this.#j&&(this.#j=this.#j.filter((e=>e.id!==t)))}0>=this.#L.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):n.isRandom()&&this.redrawIfNeeded()}}setResponseData(e){if(this.#k)throw new Error(`Data for banner on position ${this.position} is already set.`);this._positionData=new U({id:e.position_id||null,code:this._positionData.code,name:e.position_name||null,rotationSeconds:e.rotation_seconds,displayType:e.display_type,breakpointType:e.breakpoint_type,closedExpiration:e.closed_expiration||null}),"options"in e&&this.overrideOptions(e.options);const t=[];for(let n in e.banners||[])t.push(new J(e.banners[n],e.breakpoint_type,this.#T));this.#L=t,this.#k=!0,0>=this.#L.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):this.#F("Banner was successfully rendered.")}getCurrentBreakpoint(e){let t=this.bannerData;t=(Array.isArray(t)?t:t?[t]:[]).find((t=>t.id===e));const n=t&&t.content?t.content.breakpoint:null;return null===n?null:parseInt(n)}isManaged(){return!0}redrawIfNeeded(){this.#P()&&this.#F("Banner was successfully redrawn.")}#F(e){try{this.html=this.#C.render(this)}catch(e){return void this.setState(this.STATE.ERROR,"Render error: "+e.message)}this.setState(this.STATE.RENDERED,e)}#P(){let e=this.bannerData;Array.isArray(e)||(e=[e]);for(let t in e)if(e[t].needRedraw())return!0;return!1}}class ne{static parseResources(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-resource-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(18)]=e.value.split(",").map((e=>e.trim())));return t}static parseOptions(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-option-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(16)]=e.value.trim());return t}}class re extends V{#$=[];#U={};#W=null;constructor(e,t,n,r){if(!("ampBannerExternal"in r.dataset))throw new Error('Unable to initialize ExternalBanner from element that does not have an attribute "data-amp-external".');const i=JSON.parse(decodeURIComponent(atob(r.dataset.ampBannerExternal)));if(!("state"in i)||!("positionData"in i))throw new Error('Unable to initialize ExternalBanner data attribute "data-amp-external" is malformed.');const s=i.state,o=new U(i.positionData),a=ne.parseOptions(r);super(t,n,r,o.code,a);const c=[],l={},u=r.cloneNode(!0),p=u.querySelectorAll("[data-amp-banner-fingerprint]");let d=p.item(0)?.parentElement||null,h=d;if(d===u)d=h=null;else for(;null!==h&&h!==u&&h?.parentElement!==u;)h=h.parentElement||null;for(let t of p){const n=Q.createFromValue(t.dataset.ampBannerFingerprint);c.push(n);for(let r of t.querySelectorAll("[data-amp-content-breakpoint]")){let i=r.dataset.ampContentBreakpoint;i="default"===i?null:parseInt(i),n.bannerId in l||(l[n.bannerId]=new Y(e,o.breakpointType));const s=t.cloneNode(!1);s.insertAdjacentElement("afterbegin",r),l[n.bannerId].addContent(i,{html:s.outerHTML})}}d&&(d.dataset.ampBannerList="true"),d&&(d.innerHTML=""),this._positionData=o,this.#$=c,this.#U=l,this.#W=h,this.#H(!1),this.setState(s.value,s.info)}get fingerprints(){return this.#$}unsetFingerprint(e){this.#$=this.#$.filter((t=>t.value!==e.value));const t=e.bannerId;t in this.#U&&delete this.#U[t],0>=this.#$.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){const t=this.#U[e]||null;return null===t?null:t.content?.breakpoint||null}isExternal(){return!0}redrawIfNeeded(){this.#H(!0)&&this.setState(this.STATE.RENDERED,"Banner was successfully redrawn.")}#H(e){let t=!e;if(!t)for(let e in this.#U){if(this.#U[e].needRedraw()){t=!0;break}}if(!t)return!1;const n=[];for(let e in this.#U){const t=this.#U[e].content;null!==t&&n.push(t.data.html)}if(0>=n.length)return this.element.innerHTML="",!0;const r=this.#W?this.#W.cloneNode(!0):null;return((null!==r&&void 0===r.dataset.ampBannerList?r.querySelector("[data-amp-banner-list]"):null)??r??this.element).innerHTML=n.join("\n"),null!==r&&(this.element.innerHTML=r.outerHTML),ee(this.element),!0}}class ie extends V{#G;#$;constructor(e,t,n,r,i,s){super(e,t,n,i,s),this.#G=r,this.#$=[],this.setState(this.STATE.NEW,"Banner created.")}get iframe(){return this.#G}get fingerprints(){return this.#$}unsetFingerprint(e){this.#$=this.#$.filter((t=>t.value!==e.value)),0>=this.#$.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){throw new Error("Method EmbedBanner.getCurrentBreakpoint() is not readable.")}isEmbed(){return!0}updatePositionData(e){const t=["id","name","rotationSeconds","displayType","breakpointType","closedExpiration"],n=this.positionData;for(let r of t)r in e&&(n[r]=e[r])}updateFingerprints(e){this.#$=e.map((e=>e instanceof Q?e:Q.createFromValue(e)))}}class se{#q;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.#q=e-1}getNextIdentifier(){return++this.#q}}class oe{#V;#T;#Q;#z;#L=[];#Y;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.#V=e,this.#T=t,this.#Q=n,this.#z=new se,this.#Y=new MutationObserver((e=>{for(const t of e){if(!(t.target instanceof HTMLElement))continue;const e=t.target.closest("[data-amp-attached]")?.dataset?.ampAttached,n=void 0!==e?this.getBannerByUid(parseInt(e)):null;n&&this.#V.dispatch($.ON_BANNER_MUTATED,{banner:n,mutation:t})}})),this.STATE=P}addExternalBanner(e){e=Z(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:window);const t=this.#z.getNextIdentifier();e.setAttribute("data-amp-attached",t);const n=new re(this.#T,this.#V,t,e);return this.#J(e),this.#L.push(n),n}addManagedBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window;if(null===this.#Q)throw new Error("Unable to add managed banner, renderer is not provided.");e=Z(e,i);const s=this.#z.getNextIdentifier();e.setAttribute("data-amp-attached",s);const o=new te(this.#T,this.#Q,this.#V,s,e,t,n,r);return this.#J(e),this.#L.push(o),o}addEmbedBanner(e,t,n,r){e=Z(e,window),t=Z(t,window);const i=this.#z.getNextIdentifier();e.setAttribute("data-amp-attached",i);const s=new ie(this.#V,i,e,t,n,r);return this.#J(e),this.#L.push(s),s}removeBanner(e){const t=this.#L.length;return this.#L=this.#L.filter((t=>t!==e)),t!==this.#L.length}getBannersByState(e){let{state:t,managed:n=!0,external:r=!0,embed:i=!0}=e;return this.#L.filter((e=>e instanceof V&&e.state===t&&!(e instanceof te&&!n||e instanceof re&&!r||e instanceof ie&&!i)))}getBannerByFingerprint(e){const t=e instanceof Q?e.value:e;for(let e of this.#L)if(!(e instanceof ie))for(let n of e.fingerprints)if(n.value===t)return e;return null}getBannerByUid(e){for(let t of this.#L)if(t.uid===e)return t;return null}getBannerByPosition(e){for(let t of this.#L)if(t.position===e)return t;return null}#J(e){e._ampBannerMutationsObserved||(this.#Y.observe(e,{subtree:!0,childList:!0,characterData:!1,attributes:!0,attributeFilter:["data-amp-banner-close"]}),e._ampBannerMutationsObserved=!0)}}class ae{#K;constructor(e){this.#K=e}static fromCurrentWindow(){return new ae((()=>document.documentElement.clientWidth||document.body.clientWidth))}get width(){return this.#K()}}class ce{constructor(e){let{key:t,expiresAt:n,metadata:r={}}=e;this.key=t,this.expiresAt=n,this.metadata=r}static position(e){let{positionCode:t,closingExpiration:n,metadata:r={}}=e;if("number"!=typeof n)throw new Error(`Unable to create position entry via factory ClosingEntry::position({ positionCode: ${t}, closingExpiration: ${n} }), argument "closingExpiration" must be a number.`);return new ce({key:le.position(t),expiresAt:Math.round(+new Date/1e3+n),metadata:r})}static banner(e){let{positionCode:t,bannerId:n,closingExpiration:r,metadata:i}=e;return new ce({key:le.banner(t,n),expiresAt:"number"==typeof r&&Math.round(+new Date/1e3+r),metadata:i})}}class le{constructor(e){let{value:t,type:n,args:r}=e;this.value=t,this.type=n,this.args=r}static position(e){return new le({value:`p:${e}`,type:"position",args:{positionCode:e}})}static banner(e,t){return new le({value:`b:${e}:${t}`,type:"banner",args:{positionCode:e,bannerId:t}})}static tryParse(e){const t=e.split(":");switch(!0){case"p"===t[0]&&2===t.length:return le.position(t[1]);case"b"===t[0]&&3===t.length:return le.banner(t[1],t[2])}return null}isPosition(){return"position"===this.type}isBanner(){return"banner"===this.type}toString(){return this.value}}class ue{#X;#Z;#ee;#te=null;#ne=0;#re=null;constructor(e){let{storage:t,key:n,maxItems:r,externalOptions:i,onStorageChange:s}=e;switch(t){case"localStorage":"localStorage"in window?t=window.localStorage:(console.warn("LocalStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ie());break;case"sessionStorage":"sessionStorage"in window?t=window.sessionStorage:(console.warn("SessionStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ie());break;default:"memoryStorage"!==t&&console.warn(`Unknown storage "${t}", fallback to memoryStorage.`),t=this.#ie()}this.#X=t,this.#Z=n,this.#ee=r,"cookieName"in i&&i.cookieName&&(this.#re={cookieName:i.cookieName,cookieDomain:i.cookieDomain||null,cookiePath:i.cookiePath||"/",cookieExpire:i.cookieExpire||1}),s&&this.#X instanceof Storage&&window.addEventListener("storage",(e=>{if(null!==e.key&&this.#Z!==e.key)return;const t=this.#te||{r:this.#ne};let n;try{n=null!==e.newValue&&""!==e.newValue?JSON.parse(e.newValue):{}}catch(e){return void console.warn("Failed to parse storage data as JSON, skipping closed items synchronization.",e)}"r"in n&&n.r!==t.r&&this.setRevision(n.r);const r=Object.keys(t),i=Object.keys(n).filter((e=>"r"!==e&&!r.includes(e))).map((e=>le.tryParse(e))).filter((e=>null!==e));this.#te=n,0<i.length&&s(i)}))}setRevision(e){"number"==typeof e&&Number.isInteger(e)&&(this.#ne=e,this.#te=null)}close(e){const t=this.#se();let n=null;const r=[];let i=null;const s=[];for(let o in e){const a=e[o];if(!1!==a.expiresAt&&a.expiresAt<=t)continue;const c=a.key.toString();null===n&&(n=this.#oe()),c in n&&n[c]===a.expiresAt||(n[c]=a.expiresAt,r.push(c)),null!==this.#re&&"external"in a.metadata&&!0===a.metadata.external&&(i=null!==i?i:this.#ae(),c in i&&i[c]===a.expiresAt||(i[c]=a.expiresAt,s.push(c)))}if(0<r.length){const e=Object.values(n||{}).length;e>this.#ee&&Object.entries(n).filter((e=>"r"!==e[0]&&-1===r.indexOf(e[0]))).sort(((e,t)=>(e[1]||Number.MAX_SAFE_INTEGER)-(t[1]||Number.MAX_SAFE_INTEGER))).slice(0,e-this.#ee).forEach((e=>{delete n[e[0]]})),this.#te=n,this.#ce()}if(0<s.length){let e=!1,t=0;const n=10;do{if(e=this.#le(i),!e){if(t>=n){console.warn("Failed to flush cookie after multiple attempts, discarding remaining items.");break}Object.entries(i).filter((e=>"r"!==e[0]&&-1===s.indexOf(e[0]))).sort(((e,t)=>(e[1]||Number.MAX_SAFE_INTEGER)-(t[1]||Number.MAX_SAFE_INTEGER))).slice(0,Object.values(i||{}).length-1).forEach((e=>{delete i[e[0]]})),t++}}while(!e)}}release(e,t){let{includeExternal:n=!1}=t;const r=this.#oe(),i=n&&null!==this.#re?this.#ae():null;let s=!1,o=!1;for(let t in e){const n=e[t].toString();n in r&&(delete r[n],s=!0),null!==i&&n in i&&(delete i[n],o=!0)}s&&(this.#te=r,this.#ce()),o&&this.#le(i)}isClosed(e){const t=this.#oe(),n=e.toString();return n in t&&(!1===t[n]||t[n]>this.#se()||(setTimeout((()=>this.release([e],{includeExternal:!1})),0),!1))}#oe(){if(null!==this.#te){if(this.#ne===this.#te.r)return this.#te;this.#te=null}const e=this.#X.getItem(this.#Z);let t;try{t=null!==e&&""!==e?JSON.parse(e):{r:this.#ne}}catch(e){t={}}return("object"!=typeof t||Array.isArray(t)||t.r!==this.#ne)&&(t={r:this.#ne},this.#X.removeItem(this.#Z)),this.#te=t}#ae(){if(null===this.#re)return{r:this.#ne};const e=document.cookie.split("; ").find((e=>e.startsWith(this.#re.cookieName+"=")));if(!e)return{r:this.#ne};let t;try{t=JSON.parse(decodeURIComponent(e.split("=")[1]))}catch(e){t={}}return("object"!=typeof t||Array.isArray(t)||t.r!==this.#ne)&&(t={r:this.#ne},this.#le({})),t}#ce(){if(null!==this.#te){const e=Object.keys(this.#te).length;0>=e||"r"in this.#te&&1===e?this.#X.removeItem(this.#Z):this.#X.setItem(this.#Z,JSON.stringify(this.#te))}}#le(e){if(null===this.#re)return!1;const t=Object.keys(e).length;let n;if(0>=t||"r"in this.#te&&1===t)n="Thu, 01 Jan 1970 00:00:01 GMT";else{const e=new Date;e.setTime(e.getTime()+24*this.#re.cookieExpire*60*60*1e3),n=e.toUTCString()}let r=`${this.#re.cookieName}=${encodeURIComponent(JSON.stringify(e))}; path=${this.#re.cookiePath}; expires=${n}; samesite=Lax`;return this.#re.cookieDomain&&(r+=`; domain=${this.#re.cookieDomain}`),"https:"===window.location.protocol&&(r+="; secure"),!(r.length>4096)&&(document.cookie=r,!0)}#ie(){const e={items:{}};return e.setItem=function(e,t){this.items[e]=t}.bind(e),e.getItem=function(e){return e in this.items?this.items[e]:null}.bind(e),e.removeItem=function(e){e in this.items&&delete this.items[e]}.bind(e),e}#se(){return Math.round(+new Date/1e3)}}class pe{#ue;#V;#pe;#de;#he;constructor(e){let{bannerManager:t,eventBus:n,config:r={storage:"memoryStorage",key:"amp-closed-banners",maxItems:500,external:{cookieName:null}},bannerFrameMessenger:i,parentFrameMessenger:s}=e;this.#ue=t,this.#V=n,this.#pe=i,this.#de=s;const{storage:o,key:a,maxItems:c,external:l}=r;this.#he=new ue({storage:o,key:a,maxItems:c,externalOptions:l,onStorageChange:e=>{for(let t=0;t<e.length;t++){const n=e[t];n.isBanner()&&this.closeBanner(n.args.positionCode,n.args.bannerId,{})}}}),this.#pe&&this.#pe.on("storeClosedEntries",(e=>{let{data:t}=e;const{uid:n,entries:r,fingerprints:i}=t,s=this.#ue.getBannerByUid(n);if(s.isEmbed()){for(let e=0;e<i.length;e++)s.unsetFingerprint(Q.createFromValue(i[e]));this.#he.close(r.map((e=>new ce({key:le.tryParse(e.key),expiresAt:e.expiresAt}))))}})),this.#de&&this.#de.on("closeBanner",(e=>{let{data:t}=e;const{positionCode:n,bannerId:r,options:i}=t;n&&r&&this.closeBanner(n,r,i||{})}))}setRevision(e){this.#he.setRevision(e)}attachUi(){const e=e=>{let{banner:t,button:n}=e;n._ampCloseActionAttached||(n._ampCloseActionAttached=!0,n.addEventListener("click",(e=>{e.preventDefault();const r=n.closest("[data-amp-banner-fingerprint]");if(!r)return;const i=r.dataset.ampBannerFingerprint,s=t.fingerprints;for(let e=0;e<s.length;e++){const r=s[e];r.value===i&&this.closeBanner(t.position,r.bannerId,{animation:n.dataset.ampBannerClose||void 0})}})))};this.#V.subscribe($.ON_BANNER_STATE_CHANGED,(t=>{let{banner:n}=t;n.state===n.STATE.RENDERED?Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})):n.state===n.STATE.CLOSED&&(n.element.innerHTML="")}),null,-100),this.#V.subscribe($.ON_BANNER_MUTATED,(t=>{let{banner:n,mutation:r}=t;n.state===n.STATE.RENDERED&&(0<r.addedNodes.length&&Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})),r.attributeName&&e({banner:n,button:r.target}))}))}isBannerClosed(e,t){return this.#he.isClosed(le.banner(e,t))}isPositionClosed(e){return this.#he.isClosed(le.position(e))}closeBanner(e,t,n){let{animation:r}=n;const i=this.#ue.getBannerByPosition(e);if(null===i)return;const s=[...i.fingerprints],o=s.filter((e=>e.bannerId===t))[0];if(void 0===o)return;if(i.isEmbed())return void(this.#pe&&this.#pe.sendToBanner(i,"closeBanner",{positionCode:e,bannerId:t,options:{animation:r}}));const a=o.closedExpiration;this.#fe({banner:i,fingerprint:o,animation:r}).then((()=>{const n=[];if(n.push(ce.banner({positionCode:e,bannerId:t,closingExpiration:a,metadata:{external:i.isExternal()}})),null!==i.positionData.closedExpiration){const t=[],o=i.fingerprints;for(let e=0;e<o.length;e++)t.push(this.#fe({banner:i,fingerprint:o[e],animation:r}));Promise.all(t).then((()=>{n.push(ce.position({positionCode:e,closingExpiration:i.positionData.closedExpiration,metadata:{external:i.isExternal()}})),setTimeout((()=>this.#he.close(n)),0),this.#de&&this.#de.sendToParent("storeClosedEntries",{entries:n.map((e=>({key:e.key.toString(),expiresAt:e.expiresAt}))),fingerprints:s.map((e=>e.toString()))})}))}else setTimeout((()=>this.#he.close(n)),0),this.#de&&this.#de.sendToParent("storeClosedEntries",{entries:n.map((e=>({key:e.key.toString(),expiresAt:e.expiresAt}))),fingerprints:[o.toString()]})}))}#fe(e){let{banner:t,fingerprint:n,animation:r}=e;const i=t.element.querySelector(`[data-amp-banner-fingerprint="${n.value}"]`);if(!i)return Promise.resolve(void 0);let s,o=[];if("string"==typeof r){const e=r.match(/^(?<fn>[a-zA-Z\d]+)(\((?<options>.+)?\))?$/)?.groups??{};s=e.fn?e.fn.trim():void 0,o=e.options&&""!==e.options.trim()?e.options.split(",").map((e=>e.trim())):[]}let a=this.#me(s,o);return this.#V.dispatch($.ON_BANNER_BEFORE_CLOSE,{fingerprint:n,element:i,banner:t,setOperation:e=>a=e}),Promise.resolve(a(i)).then((()=>{this.#V.dispatch($.ON_BANNER_AFTER_CLOSE,{fingerprint:n,element:i,banner:t}),t.unsetFingerprint(n)}))}#me(e,t){return"slideUp"===e?e=>{let n=200,r=t[1]||"ease-in-out";try{n=parseInt(t[0]||"200"),n>0||(console.error("Unable to parse animation duration.",t[0]),n=200)}catch(e){console.error("Unable to parse animation duration.",t[0])}return e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=`${n}ms`,e.style.transitionTimingFunction=r,e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",new Promise((e=>{setTimeout(e,n)}))}:e=>e.remove()}}class de{#ge;#be;#ve;constructor(){this.#ge=new se,this.#be={},this.#ve={}}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("function"!=typeof t)throw new TypeError("Listener must be of type function.");const i="idx_"+this.#ge.getNextIdentifier();return this.#be[e]=this.#be[e]||{},this.#be[e][i]={callback:t,scope:n,priority:r},e in this.#ve&&delete this.#ve[e],()=>{e in this.#be&&i in this.#be[e]&&delete this.#be[e][i]}}dispatch(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let t of this.getSortedListeners(e))null!==t.scope?t.callback.call(t.scope,...n):t.callback(...n)}reset(){this.#be={}}getSortedListeners(e){if(e in this.#ve)return this.#ve[e];const t=Object.values(this.#be[e]||{}).sort(((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:0));return this.#ve[e]=t}}var he=n(872);class fe{#ye;#Ee;constructor(e){this.#ye=e,this.#Ee={}}getTemplate(e){if(e in this.#Ee)return this.#Ee[e];if(!(e in this.#ye))throw new Error(`Template with type "${e}" not found.`);return this.#Ee[e]=he(this.#ye[e])}}class me{#we;constructor(e){this.#we=new fe(e)}render(e){let t=e.bannerData;return t=Array.isArray(t)?t.filter((e=>null!==e.content)):t,this.#we.getTemplate(e.positionData.displayType)({banner:e,data:t})}}class ge{static create(e,t,n,r,i,s){let o=[];for(let e in i)o.push({pixels:parseInt(e),ratio:i[e]});o=o.sort(((e,t)=>t.pixels-e.pixels));const a=e=>{const t=getComputedStyle(e),n=(e.offsetWidth-(parseFloat(t.paddingLeft)+parseFloat(t.paddingRight))-(parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)))*(e.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom))-(parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)));for(let e of o)if(n>=e.pixels)return e.ratio;return r};return new IntersectionObserver((r=>{const i=[];let o={},c={};for(let t of r){const r=t.target.dataset.ampBannerFingerprint,s=e.getBannerByFingerprint(r);if(!s)continue;const l=n[r];if(!l)continue;const u={fingerprint:l.fingerprint,element:t.target,banner:s};if(i.push({...u,entry:t}),!l.alreadySeen){const e=t.intersectionRatio>=a(t.target);o[r]=!(r in o)||!o[r].isIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isIntersecting:e}:o[r]}if(!l.alreadyFullySeen){const e=.99<=t.intersectionRatio;c[r]=!(r in c)||!c[r].isFullyIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isFullyIntersecting:e}:c[r]}}for(let e of Object.values(o)){const{fingerprintArgs:n,fingerprintMetadata:r,isIntersecting:i}=e;i&&!r.alreadySeen&&null===r.firstTimeSeenTimeoutId?r.firstTimeSeenTimeoutId=setTimeout((()=>{r.alreadySeen=!0,t.dispatch($.ON_BANNER_FIRST_TIME_SEEN,n)}),s):i||null===r.firstTimeSeenTimeoutId||(clearTimeout(r.firstTimeSeenTimeoutId),r.firstTimeSeenTimeoutId=null)}for(let e of Object.values(c)){const{fingerprintArgs:n,fingerprintMetadata:r,isFullyIntersecting:i}=e;i&&!r.alreadyFullySeen&&null===r.firstTimeFullySeenTimeoutId?r.firstTimeFullySeenTimeoutId=setTimeout((()=>{r.alreadyFullySeen=!0,t.dispatch($.ON_BANNER_FIRST_TIME_FULLY_SEEN,n)}),s):i||null===r.firstTimeFullySeenTimeoutId||(clearTimeout(r.firstTimeFullySeenTimeoutId),r.firstTimeFullySeenTimeoutId=null)}for(let e of i)t.dispatch($.ON_BANNER_INTERSECTION_CHANGED,e)}),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,.99]})}}class be{#_e;#ue;#V;#$;#Ne;constructor(e,t,n){this.#_e=!1,this.#ue=e,this.#V=t,this.#$={},this.#Ne=ge.create(e,t,this.#$,n.defaultIntersectionRatio,n.intersectionRatioMap,n.firstTimeSeenTimeout)}start(){if(this.#_e)return;this.#_e=!0,this.#V.subscribe($.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;P.RENDERED!==t.state||t.isEmbed()||this.#Te(t)}),null,-100),this.#V.subscribe($.ON_BANNER_MUTATED,(e=>{let{banner:t,mutation:n}=e;P.RENDERED===t.state&&!t.isEmbed()&&0<n.addedNodes.length&&this.#Te(t)}));const e=this.#ue.getBannersByState({state:P.RENDERED,embed:!1});for(let t of e)this.#Te(t)}#Te(e){const t=this,n=e.element.querySelectorAll("[data-amp-banner-fingerprint]");for(let e of n){const n=e.dataset.ampBannerFingerprint;n in this.#$||(this.#$[n]={fingerprint:Q.createFromValue(n),alreadySeen:!1,alreadyFullySeen:!1,firstTimeSeenTimeoutId:null,firstTimeFullySeenTimeoutId:null}),e._ampBannerFingerprintObserved||(e._ampBannerFingerprintObserved=!0,this.#Ne.observe(e));const r=e.getElementsByTagName("a");for(let e of r)e._ampClickingMetricsAttached||(e._ampClickingMetricsAttached=!0,e.addEventListener("click",(function(e){const r=t.#$[n];if(!r)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the fingerprint "${n}" not managed.`);const i=t.#ue.getBannerByFingerprint(n);if(!i)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the banner for fingerprint "${n}" not found.`);const s={fingerprint:r.fingerprint,element:this.closest("[data-amp-banner-fingerprint]"),banner:i,target:this,clickEvent:e};r.alreadySeen||(r.alreadySeen=!0,t.#V.dispatch($.ON_BANNER_FIRST_TIME_SEEN,s)),t.#V.dispatch($.ON_BANNER_LINK_CLICKED,s)})))}}}class ve{static get BANNER_LOADED(){return"amp:banner:loaded"}static get BANNER_DISPLAYED(){return"amp:banner:displayed"}static get BANNER_FULLY_DISPLAYED(){return"amp:banner:fully-displayed"}static get BANNER_CLICKED(){return"amp:banner:clicked"}static get BANNER_CLOSED(){return"amp:banner:closed"}static get EVENTS(){return[ve.BANNER_LOADED,ve.BANNER_DISPLAYED,ve.BANNER_FULLY_DISPLAYED,ve.BANNER_CLICKED,ve.BANNER_CLOSED]}}class ye{constructor(e){const t={channel_code:"channel_code",banner_id:"banner_id",banner_name:"banner_name",position_id:"position_id",position_code:"position_code",position_name:"position_name",campaign_id:"campaign_id",campaign_code:"campaign_code",campaign_name:"campaign_name",breakpoint:"breakpoint",link:"link"};if("params"in e)for(let n in e.params)n in t&&"string"==typeof e.params[n]&&(t[n]=e.params[n]);const n="extraParams"in e&&"object"==typeof e.extraParams?e.extraParams:{},r={},i=e=>({name:e,enabled:!0,params:{...t},extraParams:{...n}});if(r[ve.BANNER_LOADED]=i(ve.BANNER_LOADED),r[ve.BANNER_DISPLAYED]=i(ve.BANNER_DISPLAYED),r[ve.BANNER_FULLY_DISPLAYED]=i(ve.BANNER_FULLY_DISPLAYED),r[ve.BANNER_CLICKED]=i(ve.BANNER_CLICKED),r[ve.BANNER_CLOSED]=i(ve.BANNER_CLOSED),"events"in e)for(let t in e.events){const n=e.events[t];if(!0!==n&&t in r)if(!1!==n)if("string"!=typeof n){if("object"==typeof n){if("name"in n&&"string"==typeof n.name&&(r[t].name=n.name),"params"in n&&"object"==typeof n.params)for(let e in n.params)e in r[t].params&&"string"==typeof n.params[e]&&(r[t].params[e]=n.params[e]);"extraParams"in n&&"object"==typeof n.extraParams&&(r[t].extraParams={...r[t].extraParams,...n.extraParams})}}else r[t].name=n;else r[t].enabled=!1}this.events=r}}class Ee{#xe;#V;#Se;#Re;#Ae={started:!1,events:[],cleanup:[]};constructor(e,t,n){this.#xe=e,this.#V=t,this.#Se=n,this.#Re=!1}collectBeforeAttach(){if(this.#Ae.started||this.#Re)return;this.#Ae.started=!0;const e=this.#V,t=new ye({}),n=t.events[ve.BANNER_LOADED],r=t.events[ve.BANNER_DISPLAYED],i=t.events[ve.BANNER_FULLY_DISPLAYED],s=t.events[ve.BANNER_CLICKED],o=t.events[ve.BANNER_CLOSED];this.#Ae.cleanup.push(e.subscribe($.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&P.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)this.#Ae.events.push({name:ve.BANNER_LOADED,params:this.#Be({event:n,fingerprint:e,banner:t})})}))),this.#Ae.cleanup.push(e.subscribe($.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#Ae.events.push({name:ve.BANNER_DISPLAYED,params:this.#Be({event:r,fingerprint:t,banner:n})})}))),this.#Ae.cleanup.push(e.subscribe($.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#Ae.events.push({name:ve.BANNER_FULLY_DISPLAYED,params:this.#Be({event:i,fingerprint:t,banner:n})})}))),this.#Ae.cleanup.push(e.subscribe($.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:n,target:r}=e;const i=this.#Be({event:s,fingerprint:t,banner:n});i[s.params.link]=r.href||"",this.#Ae.events.push({name:ve.BANNER_CLICKED,params:i})}))),this.#Ae.cleanup.push(e.subscribe($.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:n}=e;this.#Ae.events.push({name:ve.BANNER_CLOSED,params:this.#Be({event:o,fingerprint:t,banner:n})})})))}attach(e){if(this.#Re)return;this.#Re=!0;const t=this.#V,n=this.#xe;if(!n.hasAnyReceiver())return void this.#Oe();const r=e.events[ve.BANNER_LOADED],i=e.events[ve.BANNER_DISPLAYED],s=e.events[ve.BANNER_FULLY_DISPLAYED],o=e.events[ve.BANNER_CLICKED],a=e.events[ve.BANNER_CLOSED];if(this.#Ae.started){for(let t in this.#Ae.events){const{name:r,params:i}=this.#Ae.events[t],s=e.events[r];if(!s.enabled)continue;const o={};for(let e in i)o[s.params[e]]=i[e];n.send(s.name,{...o,...s.extraParams})}this.#Oe()}r.enabled&&t.subscribe($.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&P.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)n.send(r.name,this.#Be({event:r,fingerprint:e,banner:t}))})),i.enabled&&t.subscribe($.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(i.name,this.#Be({event:i,fingerprint:t,banner:r}))})),s.enabled&&t.subscribe($.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(s.name,this.#Be({event:s,fingerprint:t,banner:r}))})),o.enabled&&t.subscribe($.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:r,target:i}=e;const s=this.#Be({event:o,fingerprint:t,banner:r});s[o.params.link]=i.href||"",n.send(o.name,s)})),a.enabled&&t.subscribe($.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:r}=e;n.send(a.name,this.#Be({event:a,fingerprint:t,banner:r}))}))}#Be=e=>{let{event:t,fingerprint:n,banner:r}=e,i=r.getCurrentBreakpoint(n.bannerId);i=null===i?"default":`${"min"===r.positionData.breakpointType?">=":"<="}${i}`;const s={};return s[t.params.channel_code]=this.#Se,s[t.params.banner_id]=n.bannerId,s[t.params.banner_name]=n.bannerName,s[t.params.position_id]=n.positionId,s[t.params.position_code]=n.positionCode,s[t.params.position_name]=n.positionName,s[t.params.campaign_id]=n.campaignId,s[t.params.campaign_code]=n.campaignCode,s[t.params.campaign_name]=n.campaignName,s[t.params.breakpoint]=i,{...s,...t.extraParams}};#Oe(){for(let e in this.#Ae.cleanup)this.#Ae.cleanup[e]();this.#Ae.events=[],this.#Ae.cleanup=[]}}let we=!1;const _e=(e,t)=>{if(!("plausible"in window)||"function"!=typeof window.plausible)return!we&&console.warn("Unable to send metrics to Plausible because the function plausible() does not occur in the window."),void(we=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.plausible(e,{props:t})};let Ne=!1;const Te=(e,t)=>{if(!("gtag"in window)||"function"!=typeof window.gtag)return!Ne&&console.warn("Unable to send metrics to Google Analytics because the function gtag() does not occur in the window."),void(Ne=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.gtag("event",e,t)};let xe=!1;const Se=(e,t)=>{if(!("dataLayer"in window))return!xe&&console.warn("Unable to send metrics to GTM because the dataLayer does not occur in the window."),void(xe=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.dataLayer.push({event:e,...t})},Re=(e,t)=>{console.log("Sending metrics.",{eventName:e,eventArgs:t})};class Ae{#Ie;constructor(e){this.#Ie=Array.isArray(e)?e:[e]}static createFromReceivers(e){if(!e)return new Ae([]);e=Array.isArray(e)?e:[e];const t=[];for(let n of e)if("function"!=typeof n)switch(n){case"plausible":t.push(_e);break;case"gtag":t.push(Te);break;case"gtm":t.push(Se);break;case"debug":t.push(Re);break;default:console.warn("Unable to send metrics to a receiver of unknown type",n)}else t.push(n);return new Ae(t)}hasAnyReceiver(){return this.#Ie.length}send(e,t){for(let n of this.#Ie)n(e,t)}}class Be{#Ce;#V;constructor(e){let{origins:t=[]}=e;this.#V=new de,this.#Ce=t}on(e,t){this.#V.subscribe(e,t)}send(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";e.postMessage({message:t,data:n},r)}listen(){window.addEventListener("message",(e=>{if(0<this.#Ce.length&&-1===this.#Ce.indexOf(e.origin)||"object"!=typeof e.data||!("message"in e.data)||!("data"in e.data))return;const{message:t,data:n}=e.data,r={data:n,origin:e.origin};this._beforeDispatch(t,r)&&this.#V.dispatch(t,r)}),!1)}_beforeDispatch(){return!0}}class Oe extends Be{#f;#Me;#ue;#xe;#De=[];constructor(e){let{origin:t,connectionData:n,bannerManager:r,metricsSender:i}=e;super({origins:[t]}),this.#f=t,this.#Me=n,this.#ue=r,this.#xe=i;const s={};s.adjustHeight=this.#ke,s.stateChanged=this.#je,s.linkClicked=this.#Le,s.metrics=this.#Fe;for(let e in s)this.on(e,s[e].bind(this));window.addEventListener("resize",(()=>{const e=this.#ue.getBannersByState({state:this.#ue.STATE.RENDERED,managed:!1,external:!1,embed:!0});for(let t of e)this.sendToBanner(t,"windowResized",{windowWidth:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth})}))}connectBanner(e){e.iframe.addEventListener("load",(()=>{const t=this.#Me;t.uid=e.uid,t.windowWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.sendToBanner(e,"connect",t)}))}sendToBanner(e,t,n){this.send(e.iframe.contentWindow,t,n,this.#f)}_beforeDispatch(e,t){let{data:n}=t;const{uid:r}=n;if(-1===this.#De.indexOf(r)){const e=this.#Pe(r);e&&(e.iframe.style.visibility="visible",this.#De.push(r))}return!0}#ke(e){let{data:t}=e;const n=this.#Pe(t.uid);n&&(n.iframe.style.height=t.height+"px")}#je(e){let{data:t}=e;const n=this.#Pe(t.uid);null!==n&&("positionData"in t&&n.updatePositionData(t.positionData),"fingerprints"in t&&n.updateFingerprints(t.fingerprints),n.setState(t.state,`[embed]: ${t.stateInfo}`))}#Le(e){let{data:t}=e;const{href:n,target:r}=t;"_blank"===r?window.open(n,r):window.location.href=n}#Fe(e){let{data:t}=e;const{eventName:n,eventArgs:r}=t;this.#xe.hasAnyReceiver()&&this.#xe.send(n,r)}#Pe(e){const t=this.#ue.getBannerByUid(e);return t instanceof ie?t:(console.warn(`Error in communication with embed banner. Embed banner with UID ${e} not attached.`),null)}}class Ie{#c;#$e;#V;#Ue;#We;#n=null;#ue;#He;#Ge;#xe;#qe;#Ve;#Qe=null;constructor(e,t){this.EVENTS=$,this.#c=e,this.#$e=t=function(e){const t=i({method:"GET",url:null,version:2,channel:null,locale:null,resources:{},origin:null,template:s,interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{receiver:null,events:{},params:{},extraParams:{}},closing:{storage:"localStorage",key:"amp-closed-banners",maxItems:500,external:{cookieName:"amp-c",cookieDomain:null,cookiePath:"/",cookieExpire:365}}},e);if("string"!=typeof t.method||!(t.method.toUpperCase()in{GET:1,POST:1}))throw new Error(`The option "method" must be one of these ["GET", "POST"], ${t.method} passed.`);if(t.method=t.method.toUpperCase(),"string"!=typeof t.url)throw new Error(`The option "url" is required and must be a valid URL, ${t.url} passed.`);if("number"!=typeof t.version)throw new Error(`The option "version" must be a number, ${t.version} passed.`);if("string"!=typeof t.channel)throw new Error(`The option "channel" is required and must be a string, ${t.channel} passed.`);if(null!==t.locale&&"string"!=typeof t.locale)throw new Error(`The option "locale" must be a string, ${t.locale} passed.`);if("object"!=typeof t.resources)throw new Error(`The option "resources" must be an object of that describes resources, ${t.resources} passed.`);if(null!==t.origin&&"string"!=typeof t.origin)throw new Error(`The option "origin" must be a valid URL, ${t.origin} passed.`);if("object"!=typeof t.template)throw new Error(`The option "template" must be an object of the format { single: string, random: string, multiple: string }, ${t.template} passed.`);for(const[e,n]of Object.entries(t.template))if("string"!=typeof n)throw new Error(`The option "template.${e}" must be a string (lodash template), ${n} passed.`);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=o(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=o(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { receiver: null|string|function|array<string|function>, events: object, params: object }, ${t.metrics} passed.`);if(null!==t.metrics.receiver&&-1===["string","function"].indexOf(typeof t.metrics.receiver)&&!Array.isArray(t.metrics.receiver))throw new Error(`The option "metrics.receiver" must be a null or a string or a function or an array of strings|functions, "${t.metrics.receiver}" passed.`);if(Array.isArray(t.metrics.receiver)){for(let e in t.metrics.receiver)if(-1===["string","function"].indexOf(typeof t.metrics.receiver[e]))throw new Error(`The option "metrics.receiver.${e}" must be a string or a function, "${t.metrics.receiver[e]}" passed.`)}else t.metrics.receiver=null!==t.metrics.receiver?[t.metrics.receiver]:[];if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.closing||"string"!=typeof t.closing.storage||"string"!=typeof t.closing.key||!Number.isInteger(t.closing.maxItems)||1>t.closing.maxItems)throw new Error(`The option "closing" must be an object of the format { storage?: "memoryStorage"|"localStorage"|"sessionStorage", key?: string, maxItems?: integer<1, max> }, ${JSON.stringify(t.closing)} passed.`);if("object"!=typeof t.closing.external||"string"!=typeof t.closing.external.cookieName||null!==t.closing.external.cookieDomain&&"string"!=typeof t.closing.external.cookieDomain||"string"!=typeof t.closing.external.cookiePath||"number"!=typeof t.closing.external.cookieExpire||!Number.isInteger(t.closing.external.cookieExpire)||1>t.closing.external.cookieExpire)throw new Error(`The option "closing.external" must be an object of the format { cookieName?: string, cookieDomain?: string|null, cookiePath?: string, cookieExpire?: integer<1, max> }, ${JSON.stringify(t.closing.external)} passed.`);return t}(t),this.#V=new de,this.#Ue=new L(t.method,t.url,t.version,t.channel),this.#We=new F(t.url,t.version,t.channel),this.#ue=new oe(this.#V,ae.fromCurrentWindow(),new me(t.template)),this.#He=new be(this.#ue,this.#V,t.interaction),this.#xe=Ae.createFromReceivers(t.metrics.receiver),this.#qe=new Ee(this.#xe,this.#V,t.channel),this.#Ve=new Oe({origin:t.url,connectionData:{extendedConfig:{interaction:t.interaction,metrics:{events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams}}},bannerManager:this.#ue,metricsSender:this.#xe}),this.#Ge=new pe({bannerManager:this.#ue,eventBus:this.#V,config:{...t.closing},bannerFrameMessenger:this.#Ve}),this.setLocale(t.locale),this.#Ue.origin=t.origin;for(let e in t.resources)this.#Ue.addDefaultResource(e,t.resources[e]),this.#We.addDefaultResource(e,t.resources[e]);window.addEventListener("resize",(()=>{const e=this.#ue.getBannersByState({state:this.#ue.STATE.RENDERED,managed:!0,external:!0,embed:!1});for(let t of e)t.redrawIfNeeded()})),this.#Ve.listen(),this.#qe.attach(new ye({events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams})),this.#He.start(),this.#Ge.attachUi()}get version(){return this.#c}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#V.subscribe(e,t,n)}setLocale(e){this.#Ue.locale=e,this.#We.locale=e}setGateway(e){if(!function(e){return e instanceof a}(e))throw new TypeError("Argument gateway mut be instance of AbstractGateway.");this.#n=e}getGateway(){return null===this.#n&&this.setGateway(new D(new M)),this.#n}createBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"managed",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window;if(e=Z(e,s),"embed"===i){const i=this.#ze(e,t,n,r),s=this.#ue.addEmbedBanner(e,i,t,r);return this.#Ve.connectBanner(s),e.insertAdjacentElement("beforeend",i),s}return this.#ue.addManagedBanner(e,t,n,r,s)}closeBanner(e,t,n){let{animation:r}=n;this.#Ge.closeBanner(e,t,{animation:r})}attachBanners(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;const n=e.querySelectorAll("[data-amp-banner]:not([data-amp-attached])");for(let e of n){const n=e.dataset.ampBanner;if(!n){console.warn("Unable to attach a banner to the element ",e,' because the attribute "data-amp-banner" has an empty value.');continue}let r;if("ampBannerExternal"in e.dataset)r=this.#ue.addExternalBanner(e,t);else{const i=ne.parseResources(e),s=ne.parseOptions(e),o=e.dataset.ampMode||"managed";r=this.createBanner(e,n,i,s,o,t)}this.#V.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:r})}}fetch(){const e=this.#ue.getBannersByState({state:this.#ue.STATE.NEW,managed:!0,external:!1,embed:!1});if(!e.length&&null!==this.#Qe)return;const t=this.#Ue.create();for(let n of e)t.addPosition(n.position,n.resources,"1"!==n.options.get("omit-default-resources","0").toString());this.#V.dispatch(this.EVENTS.ON_BEFORE_FETCH),this.getGateway().fetch(t,(t=>{let{positions:n,settings:r,response:i}=t;this.#Ye(r);for(let t of e){if(!(t.position in n)||!("banners"in n[t.position])||!Object.values(n[t.position].banners).length){t.setState(this.#ue.STATE.NOT_FOUND,"Banner not found in fetched response.");continue}const e=n[t.position];if(this.#Ge.isPositionClosed(t.position))e.banners=[];else{const n=Array.isArray(e.banners)?e.banners:Object.values(e.banners),r=[];for(let e=0;e<n.length;e++){const i=n[e];i.id&&!this.#Ge.isBannerClosed(t.position,i.id)&&r.push(i)}e.banners=r}"embed"===e.mode&&0<e.banners.length?("options"in e&&t.overrideOptions(e.options),this.createBanner(t.element,t.position,t.rawResources,t.options.options,e.mode),this.#ue.removeBanner(t)):t.setResponseData(e)}this.#V.dispatch(this.EVENTS.ON_FETCH_SUCCESS,{response:i})}),(t=>{for(let t of e)t.setState(this.#ue.STATE.ERROR,"Request on api failed.");this.#V.dispatch(this.EVENTS.ON_FETCH_ERROR,{response:t})}))}#ze(e,t,n,r){const i=document.createElement("iframe"),s=`cv=${encodeURIComponent(this.version.semver)}`,o=new q(r);let a=e.dataset.ampEmbedSrc||this.#We.create(t,n,o.options);a+=-1===a.indexOf("?")?`?${s}`:`&${s}`,i.width="100%",i.height="100%",i.allowFullscreen=!0,i.scrolling="no",i.style.border="none",i.style.overflow="hidden",i.style.background="transparent",i.style.visibility="hidden",i.setAttribute("allowtransparency","true");const c=o.evaluate("loading",0),l=o.evaluate("fetchpriority",0);return null!==c&&(i.loading=c),null!==l&&i.setAttribute("fetchpriority",l),[...e.attributes].map((e=>{let{name:t,value:n}=e;return t.startsWith("data-iframe-")&&i.setAttribute(t.substring(12),n)})),i.src=a,i}#Ye(e){this.#Qe=e,"closed_revision"in e&&this.#Ge.setRevision(e.closed_revision)}}const Ce=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};function Me(e){const t=i({interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{events:{},params:{},extraParams:{}}},e);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=Ce(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=Ce(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { events: object, params: object }, ${JSON.stringify(t.metrics)} passed.`);if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);return t}class De extends Be{#Je;#f;#g;#Ke;constructor(e){let{clientEventBus:t,origin:n}=e;super({origins:void 0!==n?[n]:[]}),this.#Je=t,this.#f=n,this.#g=null,this.#Ke=[];const r={};r.connect=this.#Xe;const i={};i[$.ON_BANNER_STATE_CHANGED]=[this.#Ze,0],i[$.ON_BANNER_LINK_CLICKED]=[this.#et,-100];for(let e in i)this.#Je.subscribe(e,i[e][0].bind(this),null,i[e][1]);for(let e in r)this.on(e,r[e].bind(this))}sendToParent(e,t){null!==this.#g?(t.uid=this.#g,this.send(window.parent,e,t,this.#f||"*")):this.#Ke.push({message:e,data:t})}#Xe(e){let{data:t}=e;if(null!==this.#g)return void console.warn(`The frame is already connected to the parent under the UID ${this.#g}.`);const{uid:n}=t;let r;this.#g=n;const i=()=>{const e=document.body.scrollHeight;r!==e&&(r=e,this.sendToParent("adjustHeight",{height:e}))};i(),setInterval(i,100),this.#tt()}#Ze(e){let{banner:t}=e;if(P.NEW===t.state)return;const n={state:t.state,stateInfo:t.stateInfo};1===t.stateCounter&&(n.positionData=t.positionData.toObject(),n.fingerprints=t.fingerprints.map((e=>e.value))),this.sendToParent("stateChanged",n)}#et(e){let{target:t,clickEvent:n}=e;n.preventDefault(),this.sendToParent("linkClicked",{href:t.href,target:t.target||null})}#tt(){for(let e of this.#Ke)this.sendToParent(e.message,e.data);this.#Ke=[]}}class ke{#c;#nt;#rt;#V;#ue;#Ve;#He;#Ge;#xe;#qe;#Re;#it=null;constructor(e,t){this.EVENTS=$,this.#c=e,this.#nt=function(e){return i({channel:null},e)}(t),this.#rt=Me({}),this.#rt=null,this.#V=new de,this.#ue=new oe(this.#V,new ae((()=>this.#it||document.documentElement.clientWidth||document.body.clientWidth))),this.#Ve=new De({clientEventBus:this.#V}),this.#Ge=new pe({bannerManager:this.#ue,eventBus:this.#V,parentFrameMessenger:this.#Ve}),this.#Re=!1,this.#He=null,this.#xe=new Ae([this.#st.bind(this)]),this.#qe=new Ee(this.#xe,this.#V,this.#nt.channel),this.#Ve.on("connect",(e=>{let{data:t}=e;this.#rt=Me(t.extendedConfig),this.#it=t.windowWidth,this.#He=new be(this.#ue,this.#V,this.#rt.interaction),this.#ot(),this.#qe.attach(new ye(this.#rt.metrics)),this.#He.start()})),this.#Ve.on("windowResized",(e=>{let{data:t}=e;this.#it=t.windowWidth,this.#ot()})),this.#Ve.listen(),this.#qe.collectBeforeAttach(),this.#Ge.attachUi()}get version(){return this.#c}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#V.subscribe(e,t,n)}attachBanner(){if(this.#Re)throw new Error("Method attachBanner() should be called only once.");const e=document.querySelector("[data-amp-banner]:not([data-amp-attached])");if(!e)return void console.warn("No banner found in the embed client.");const t=this.#ue.addExternalBanner(e);this.#Re=!0,this.#V.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:t})}#st(e,t){this.#Ve.sendToParent("metrics",{eventName:e,eventArgs:t})}#ot(){for(let e of this.#ue.getBannersByState({state:P.RENDERED}))e.redrawIfNeeded()}}const je="1.8.0";class Le{static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Ie(new t(je,`standard@${je}`),e)}static createEmbed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ke(new t(je,`embed@${je}`),e)}static get version(){return je}}})(),AMPClientFactory=r.default})();