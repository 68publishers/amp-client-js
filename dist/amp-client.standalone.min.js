var AMPClientFactory;(()=>{"use strict";var e={9306:(e,t,n)=>{var r=n(4901),i=n(6823),s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not a function")}},3506:(e,t,n)=>{var r=n(3925),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s("Can't set "+i(e)+" as a prototype")}},679:(e,t,n)=>{var r=n(1625),i=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new i("Incorrect invocation")}},8551:(e,t,n)=>{var r=n(34),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not an object")}},9617:(e,t,n)=>{var r=n(5397),i=n(5610),s=n(6198),a=function(e){return function(t,n,a){var o=r(t),c=s(o);if(0===c)return!e&&-1;var l,u=i(a,c);if(e&&n!=n){for(;c>u;)if((l=o[u++])!=l)return!0}else for(;c>u;u++)if((e||u in o)&&o[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},4527:(e,t,n)=>{var r=n(3724),i=n(4376),s=TypeError,a=Object.getOwnPropertyDescriptor,o=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=o?function(e,t){if(i(e)&&!a(e,"length").writable)throw new s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},2195:(e,t,n)=>{var r=n(9504),i=r({}.toString),s=r("".slice);e.exports=function(e){return s(i(e),8,-1)}},6955:(e,t,n)=>{var r=n(2140),i=n(4901),s=n(2195),a=n(8227)("toStringTag"),o=Object,c="Arguments"===s(function(){return arguments}());e.exports=r?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=o(e),a))?n:c?s(t):"Object"===(r=s(t))&&i(t.callee)?"Arguments":r}},7740:(e,t,n)=>{var r=n(9297),i=n(5031),s=n(7347),a=n(4913);e.exports=function(e,t,n){for(var o=i(t),c=a.f,l=s.f,u=0;u<o.length;u++){var d=o[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},6699:(e,t,n)=>{var r=n(3724),i=n(4913),s=n(6980);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},6980:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6840:(e,t,n)=>{var r=n(4901),i=n(4913),s=n(283),a=n(9433);e.exports=function(e,t,n,o){o||(o={});var c=o.enumerable,l=void 0!==o.name?o.name:t;if(r(n)&&s(n,l,o),o.global)c?e[t]=n:a(t,n);else{try{o.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},9433:(e,t,n)=>{var r=n(4576),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4606:(e,t,n)=>{var r=n(6823),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+r(t)+" of "+r(e))}},3724:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:(e,t,n)=>{var r=n(4576),i=n(34),s=r.document,a=i(s)&&i(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},6837:e=>{var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},5002:e=>{e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8727:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2839:(e,t,n)=>{var r=n(4576).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},9519:(e,t,n)=>{var r,i,s=n(4576),a=n(2839),o=s.process,c=s.Deno,l=o&&o.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},6193:(e,t,n)=>{var r=n(9504),i=Error,s=r("".replace),a=String(new i("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,c=o.test(a);e.exports=function(e,t){if(c&&"string"==typeof e&&!i.prepareStackTrace)for(;t--;)e=s(e,o,"");return e}},6518:(e,t,n)=>{var r=n(4576),i=n(7347).f,s=n(6699),a=n(6840),o=n(9433),c=n(7740),l=n(2796);e.exports=function(e,t){var n,u,d,h,p,f=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[f]||o(f,{}):r[f]&&r[f].prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(p=i(n,u))&&p.value:n[u],!l(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&s(h,"sham",!0),a(n,u,h,e)}}},9039:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},616:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9565:(e,t,n)=>{var r=n(616),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},350:(e,t,n)=>{var r=n(3724),i=n(9297),s=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,o=i(s,"name"),c=o&&"something"===function(){}.name,l=o&&(!r||r&&a(s,"name").configurable);e.exports={EXISTS:o,PROPER:c,CONFIGURABLE:l}},6706:(e,t,n)=>{var r=n(9504),i=n(9306);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},9504:(e,t,n)=>{var r=n(616),i=Function.prototype,s=i.call,a=r&&i.bind.bind(s,s);e.exports=r?a:function(e){return function(){return s.apply(e,arguments)}}},7751:(e,t,n)=>{var r=n(4576),i=n(4901);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},5966:(e,t,n)=>{var r=n(9306),i=n(4117);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},4576:function(e,t,n){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(e,t,n)=>{var r=n(9504),i=n(8981),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},421:e=>{e.exports={}},5917:(e,t,n)=>{var r=n(3724),i=n(9039),s=n(4055);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},7055:(e,t,n)=>{var r=n(9504),i=n(9039),s=n(2195),a=Object,o=r("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?o(e,""):a(e)}:a},3167:(e,t,n)=>{var r=n(4901),i=n(34),s=n(2967);e.exports=function(e,t,n){var a,o;return s&&r(a=t.constructor)&&a!==n&&i(o=a.prototype)&&o!==n.prototype&&s(e,o),e}},3706:(e,t,n)=>{var r=n(9504),i=n(4901),s=n(7629),a=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},1181:(e,t,n)=>{var r,i,s,a=n(8622),o=n(4576),c=n(34),l=n(6699),u=n(9297),d=n(7629),h=n(6119),p=n(421),f="Object already initialized",m=o.TypeError,g=o.WeakMap;if(a||d.state){var b=d.state||(d.state=new g);b.get=b.get,b.has=b.has,b.set=b.set,r=function(e,t){if(b.has(e))throw new m(f);return t.facade=e,b.set(e,t),t},i=function(e){return b.get(e)||{}},s=function(e){return b.has(e)}}else{var v=h("state");p[v]=!0,r=function(e,t){if(u(e,v))throw new m(f);return t.facade=e,l(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},4376:(e,t,n)=>{var r=n(2195);e.exports=Array.isArray||function(e){return"Array"===r(e)}},4901:e=>{var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},2796:(e,t,n)=>{var r=n(9039),i=n(4901),s=/#|\.prototype\./,a=function(e,t){var n=c[o(e)];return n===u||n!==l&&(i(t)?r(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},4117:e=>{e.exports=function(e){return null==e}},34:(e,t,n)=>{var r=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},3925:(e,t,n)=>{var r=n(34);e.exports=function(e){return r(e)||null===e}},6395:e=>{e.exports=!1},757:(e,t,n)=>{var r=n(7751),i=n(4901),s=n(1625),a=n(7040),o=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&s(t.prototype,o(e))}},6198:(e,t,n)=>{var r=n(8014);e.exports=function(e){return r(e.length)}},283:(e,t,n)=>{var r=n(9504),i=n(9039),s=n(4901),a=n(9297),o=n(3724),c=n(350).CONFIGURABLE,l=n(3706),u=n(1181),d=u.enforce,h=u.get,p=String,f=Object.defineProperty,m=r("".slice),g=r("".replace),b=r([].join),v=o&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),E=e.exports=function(e,t,n){"Symbol("===m(p(t),0,7)&&(t="["+g(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||c&&e.name!==t)&&(o?f(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&a(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?o&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return a(r,"source")||(r.source=b(y,"string"==typeof t?t:"")),e};Function.prototype.toString=E((function(){return s(this)&&h(this).source||l(this)}),"toString")},741:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},2603:(e,t,n)=>{var r=n(655);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},4913:(e,t,n)=>{var r=n(3724),i=n(5917),s=n(8686),a=n(8551),o=n(6969),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=r?s?function(e,t,n){if(a(e),t=o(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=o(t),a(n),i)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},7347:(e,t,n)=>{var r=n(3724),i=n(9565),s=n(8773),a=n(6980),o=n(5397),c=n(6969),l=n(9297),u=n(5917),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=o(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return a(!i(s.f,e,t),e[t])}},8480:(e,t,n)=>{var r=n(1828),i=n(8727).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},3717:(e,t)=>{t.f=Object.getOwnPropertySymbols},1625:(e,t,n)=>{var r=n(9504);e.exports=r({}.isPrototypeOf)},1828:(e,t,n)=>{var r=n(9504),i=n(9297),s=n(5397),a=n(9617).indexOf,o=n(421),c=r([].push);e.exports=function(e,t){var n,r=s(e),l=0,u=[];for(n in r)!i(o,n)&&i(r,n)&&c(u,n);for(;t.length>l;)i(r,n=t[l++])&&(~a(u,n)||c(u,n));return u}},8773:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2967:(e,t,n)=>{var r=n(6706),i=n(34),s=n(7750),a=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return s(n),a(r),i(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},4270:(e,t,n)=>{var r=n(9565),i=n(4901),s=n(34),a=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&i(n=e.toString)&&!s(o=r(n,e)))return o;if(i(n=e.valueOf)&&!s(o=r(n,e)))return o;if("string"!==t&&i(n=e.toString)&&!s(o=r(n,e)))return o;throw new a("Can't convert object to primitive value")}},5031:(e,t,n)=>{var r=n(7751),i=n(9504),s=n(8480),a=n(3717),o=n(8551),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(o(e)),n=a.f;return n?c(t,n(e)):t}},7750:(e,t,n)=>{var r=n(4117),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},6119:(e,t,n)=>{var r=n(5745),i=n(3392),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},7629:(e,t,n)=>{var r=n(6395),i=n(4576),s=n(9433),a="__core-js_shared__",o=e.exports=i[a]||s(a,{});(o.versions||(o.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(e,t,n)=>{var r=n(7629);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},4495:(e,t,n)=>{var r=n(9519),i=n(9039),s=n(4576).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},5610:(e,t,n)=>{var r=n(1291),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},5397:(e,t,n)=>{var r=n(7055),i=n(7750);e.exports=function(e){return r(i(e))}},1291:(e,t,n)=>{var r=n(741);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},8014:(e,t,n)=>{var r=n(1291),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8981:(e,t,n)=>{var r=n(7750),i=Object;e.exports=function(e){return i(r(e))}},2777:(e,t,n)=>{var r=n(9565),i=n(34),s=n(757),a=n(5966),o=n(4270),c=n(8227),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var n,c=a(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!i(n)||s(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},6969:(e,t,n)=>{var r=n(2777),i=n(757);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2140:(e,t,n)=>{var r={};r[n(8227)("toStringTag")]="z",e.exports="[object z]"===String(r)},655:(e,t,n)=>{var r=n(6955),i=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},6823:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},3392:(e,t,n)=>{var r=n(9504),i=0,s=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+s,36)}},7040:(e,t,n)=>{var r=n(4495);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(e,t,n)=>{var r=n(3724),i=n(9039);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(e,t,n)=>{var r=n(4576),i=n(4901),s=r.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},8227:(e,t,n)=>{var r=n(4576),i=n(5745),s=n(9297),a=n(3392),o=n(4495),c=n(7040),l=r.Symbol,u=i("wks"),d=c?l.for||l:l&&l.withoutSetter||a;e.exports=function(e){return s(u,e)||(u[e]=o&&s(l,e)?l[e]:d("Symbol."+e)),u[e]}},4114:(e,t,n)=>{var r=n(6518),i=n(8981),s=n(6198),a=n(4527),o=n(6837);r({target:"Array",proto:!0,arity:1,forced:n(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=i(this),n=s(t),r=arguments.length;o(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return a(t,n),n}})},3609:(e,t,n)=>{var r=n(6518),i=n(8981),s=n(6198),a=n(4527),o=n(4606),c=n(6837);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=i(this),n=s(t),r=arguments.length;if(r){c(n+r);for(var l=n;l--;){var u=l+r;l in t?t[u]=t[l]:o(t,u)}for(var d=0;d<r;d++)t[d]=arguments[d]}return a(t,n+r)}})},4979:(e,t,n)=>{var r=n(6518),i=n(4576),s=n(7751),a=n(6980),o=n(4913).f,c=n(9297),l=n(679),u=n(3167),d=n(2603),h=n(5002),p=n(6193),f=n(3724),m=n(6395),g="DOMException",b=s("Error"),v=s(g),y=function(){l(this,E);var e=arguments.length,t=d(e<1?void 0:arguments[0]),n=d(e<2?void 0:arguments[1],"Error"),r=new v(t,n),i=new b(t);return i.name=g,o(r,"stack",a(1,p(i.stack,1))),u(r,this,y),r},E=y.prototype=v.prototype,w="stack"in new b(g),N="stack"in new v(1,2),T=v&&f&&Object.getOwnPropertyDescriptor(i,g),S=!(!T||T.writable&&T.configurable),R=w&&!S&&!N;r({global:!0,constructor:!0,forced:m||R},{DOMException:R?y:v});var _=s(g),A=_.prototype;if(A.constructor!==_)for(var B in m||o(A,"constructor",a(1,_)),h)if(c(h,B)){var I=h[B],O=I.s;c(_,O)||o(_,O,a(6,I.c))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.d(r,{default:()=>$e});var i={};n.r(i),n.d(i,{exclude:()=>k,extract:()=>I,parse:()=>O,parseUrl:()=>M,pick:()=>D,stringify:()=>x,stringifyUrl:()=>C});const s=JSON.parse('{"rE":"1.8.0-beta.5"}');class a{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get semver(){return this.#e}get full(){return this.#t}}n(4114);const o=_.merge,c={single:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--single"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',random:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--random"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',multiple:'\n    <% if(data.length) { %>\n        <div class="amp-banner amp-banner--multiple">\n            <div class="amp-banner__list">\n                <% for (index in data) { var b = data[index]; %>\n                    <div class="amp-banner__item"\n                         data-amp-banner-fingerprint="<%= b.fingerprint %>">\n    \n                        <% if(\'img\' === b.content.type) { %>\n                            <a class="amp-banner__content amp-banner__content--img"\n                               href="<%= b.content.href %>"\n                               <% if(null !== b.content.target) { %>target="<%- b.content.target %>"<% } %>>\n                                <picture>\n                                    <% (b.content.sources || []).forEach(function(source) { %>\n                                        <source type="<%= source.type %>"\n                                                srcset="<%= source.srcset %>"\n                                                sizes="<%- b.content.sizes %>">\n                                    <% }); %>\n                                    <img srcset="<%= b.content.srcset %>"\n                                         src="<%= b.content.src %>"\n                                         sizes="<%- b.content.sizes %>"\n                                         alt="<%- b.content.alt %>"\n                                         <% if(null !== b.content.dimensions.width) { %>width="<%- b.content.dimensions.width %>"<% } %>\n                                         <% if(null !== b.content.dimensions.height) { %>height="<%- b.content.dimensions.height %>"<% } %>\n                                         <% if(\'\' !== b.content.title) { %>title="<%- b.content.title %>"<% } %>\n                                         <% var loading; if(loading = banner.options.evaluate(\'loading\', index)) { %>loading="<%- loading %>"<% } %>\n                                         <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', index)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                                </picture>\n                            </a>\n                        <% } else if (\'html\' === b.content.type) { %>\n                            <div class="amp-banner__content amp-banner__content--html">\n                                <%= b.content.html %>\n                            </div>\n                        <% } %>\n    \n                    </div>\n                <% } %>\n            </div>\n        </div>\n    <% } %>\n'},l=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};class u{constructor(){if(this.constructor===u)throw new TypeError("Can not construct abstract class AbstractGateway.");if(this.fetch===u.prototype.fetch)throw new TypeError("Please implement abstract method ::fetch().")}fetch(e,t){throw new TypeError("Do not call abstract method ::fetch() from child.")}}const d="%[a-f0-9]{2}",h=new RegExp("("+d+")|([^%]+?)","gi"),p=new RegExp("("+d+")+","gi");function f(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],f(n),f(r))}function m(e){try{return decodeURIComponent(e)}catch{let t=e.match(h)||[];for(let n=1;n<t.length;n++)t=(e=f(t,n).join("")).match(h)||[];return e}}function g(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"��","%FF%FE":"��"};let n=p.exec(e);for(;n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{const e=m(n[0]);e!==n[0]&&(t[n[0]]=e)}n=p.exec(e)}t["%C2"]="�";const r=Object.keys(t);for(const n of r)e=e.replace(new RegExp(n,"g"),t[n]);return e}(e)}}function b(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const n=e.indexOf(t);return-1===n?[]:[e.slice(0,n),e.slice(n+t.length)]}function v(e,t){const n={};if(Array.isArray(t))for(const r of t){const t=Object.getOwnPropertyDescriptor(e,r);t?.enumerable&&Object.defineProperty(n,r,t)}else for(const r of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){t(r,e[r],e)&&Object.defineProperty(n,r,i)}}return n}const y=e=>null==e,E=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)),w=Symbol("encodeFragmentIdentifier");function N(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function T(e,t){return t.encode?t.strict?E(e):encodeURIComponent(e):e}function S(e,t){return t.decode?g(e):e}function R(e){return Array.isArray(e)?e.sort():"object"==typeof e?R(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function A(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function B(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function I(e){const t=(e=A(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function O(e,t){N((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...t}).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!i&&S(n,e).includes(e.arrayFormatSeparator);n=s?S(n,e):n;const a=i||s?n.split(e.arrayFormatSeparator).map((t=>S(t,e))):null===n?n:S(n,e);r[t]=a};case"bracket-separator":return(t,n,r)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i)return void(r[t]=n?S(n,e):n);const s=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>S(t,e)));void 0!==r[t]?r[t]=[...r[t],...s]:r[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[...[n[e]].flat(),t]:n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){if(""===i)continue;const e=t.decode?i.replace(/\+/g," "):i;let[s,a]=b(e,"=");void 0===s&&(s=e),a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:S(a,t),n(S(s,t),a,r)}for(const[e,n]of Object.entries(r))if("object"==typeof n&&null!==n)for(const[e,r]of Object.entries(n))n[e]=B(r,t);else r[e]=B(n,t);return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=R(n):e[t]=n,e}),Object.create(null))}function x(e,t){if(!e)return"";N((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const n=n=>t.skipNull&&y(e[n])||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[T(t,e),"[",i,"]"].join("")]:[...n,[T(t,e),"[",T(i,e),"]=",T(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[T(t,e),"[]"].join("")]:[...n,[T(t,e),"[]=",T(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[T(t,e),":list="].join("")]:[...n,[T(t,e),":list=",T(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length?[[T(n,e),t,T(i,e)].join("")]:[[r,T(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,T(t,e)]:[...n,[T(t,e),"=",T(r,e)].join("")]}}(t),i={};for(const[t,r]of Object.entries(e))n(t)||(i[t]=r);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((n=>{const i=e[n];return void 0===i?"":null===i?T(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?T(n,t)+"[]":i.reduce(r(n),[]).join("&"):T(n,t)+"="+T(i,t)})).filter((e=>e.length>0)).join("&")}function M(e,t){t={decode:!0,...t};let[n,r]=b(e,"#");return void 0===n&&(n=e),{url:n?.split("?")?.[0]??"",query:O(I(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:S(r,t)}:{}}}function C(e,t){t={encode:!0,strict:!0,[w]:!0,...t};const n=A(e.url).split("?")[0]||"";let r=x({...O(I(e.url),{sort:!1}),...e.query},t);r&&(r=`?${r}`);let i=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);if(e.fragmentIdentifier){const r=new URL(n);r.hash=e.fragmentIdentifier,i=t[w]?r.hash:`#${e.fragmentIdentifier}`}return`${n}${r}${i}`}function D(e,t,n){n={parseFragmentIdentifier:!0,[w]:!1,...n};const{url:r,query:i,fragmentIdentifier:s}=M(e,n);return C({url:r,query:v(i,t),fragmentIdentifier:s},n)}function k(e,t,n){return D(e,Array.isArray(t)?e=>!t.includes(e):(e,n)=>!t(e,n),n)}const L=i;class F extends u{fetch(e,t,n){const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(XMLHttpRequest.DONE!==r.readyState||0===r.status)return!1;const e=JSON.parse(r.responseText);200<=r.status&&300>r.status?t(e):n(e)},r.onerror=()=>{n({status:"error",data:{code:r.status,error:r.statusText||"unknown"}})};let i=e.endpoint;"GET"===e.method&&(i+=`?${L.stringify(e.parameters)}`),r.open(e.method,i,!0),r.overrideMimeType("application/json"),r.setRequestHeader("Accept","application/json");for(let t of e.headers)r.setRequestHeader(t.name,t.value);r.send("POST"===e.method?JSON.stringify(e.parameters):null)}}class P{#n;#r;constructor(e,t){this.#n=e,this.#r=this.#i(t)}get name(){return this.#n}get value(){return this.#r}withValues(e){return new P(this.name,this.#i(e).concat(this.value).filter(((e,t,n)=>n.indexOf(e)===t)))}#i(e){return Array.isArray(e)?e:[e]}}class j{#s;#a;#o;#c;#l;#u;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.#s=e,this.#a=t,this.#o=n,this.#c={},this.#l=r,this.#u=i}addPosition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.#c;if(e in r)throw new Error('Position "'+e+'" already exists.');r[e]={},n&&this.addPositionResources(e,this.#l),this.addPositionResources(e,t)}addPositionResources(e,t){for(let n in t)this.addPositionResource(e,t[n])}addPositionResource(e,t){if(!(t instanceof P))throw new TypeError("Argument resource must be instance of Resource class.");const n=this.#c;if(!(e in n))throw new Error('Missing position "'+e+'".');const r=n[e];t.name in r?r[t.name]=r[t.name].withValues(t.value):r[t.name]=t}get method(){return this.#s}get endpoint(){return this.#a}get locale(){return this.#o}get parameters(){const e=this.#d(this.#c),t={query:"GET"===this.method?JSON.stringify(e):e};return null!==this.locale&&(t.locale=this.locale),t}get headers(){return this.#u}#d=e=>{const t={};for(let n in e){t[n]={};for(let r in e[n]){const i=e[n][r].value.filter((e=>""!==e));i.length&&(t[n][r]=i)}}return t}}class ${#s;#a;#o;#l;#h;constructor(e,t,n,r){this.#s=e,this.#a=`${t}/api/v${n}/content/${encodeURIComponent(r)}`,this.#o=null,this.#l=[],this.#h=null}set locale(e){this.#o=e}set origin(e){this.#h=e}addDefaultResource(e,t){this.#l.push(new P(e,t))}create(){const e=[];return"string"==typeof this.#h&&""!==this.#h&&e.push({name:"X-Amp-Origin",value:this.#h}),new j(this.#s,this.#a,this.#o,this.#l,e)}}class U{#a;#o;#l;constructor(e,t,n){this.#a=`${e}/api/v${t}/preview/position/${encodeURIComponent(n)}`,this.#o=null,this.#l={}}set locale(e){this.#o=e}addDefaultResource(e,t){const n=this.#l,r=new P(e,t);r.name in n?n[r.name]=n[r.name].withValues(r.value):n[r.name]=r}create(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"1"!==(r["omit-default-resources"]||"0").toString()?t={...this.#l}:(t={},delete r["omit-default-resources"]);for(let e in n){const r=new P(e,n[e]);r.name in t?t[r.name]=t[r.name].withValues(r.value):t[r.name]=r}let i={};for(let e in t){t[e].value.filter((e=>""!==e)).length&&(i[e]=t[e].value)}i=JSON.stringify(i);const s=JSON.stringify(r),a={};"{}"!==i&&(a.resources=i),"{}"!==s&&(a.options=s),null!==this.#o&&(a.locale=this.#o);const o=L.stringify(a);return`${this.#a}/${encodeURIComponent(e)}${""!==o?"?"+o:""}`}}class W{static get NEW(){return"NEW"}static get RENDERED(){return"RENDERED"}static get NOT_FOUND(){return"NOT_FOUND"}static get ERROR(){return"ERROR"}static get CLOSED(){return"CLOSED"}static get STATES(){return[W.NEW,W.RENDERED,W.NOT_FOUND,W.ERROR,W.CLOSED]}}class H{static get ON_BANNER_ATTACHED(){return"amp:banner:attached"}static get ON_BANNER_STATE_CHANGED(){return"amp:banner:state-changed"}static get ON_BANNER_INTERSECTION_CHANGED(){return"amp:banner:intersection-changed"}static get ON_BANNER_FIRST_TIME_SEEN(){return"amp:banner:first-time-seen"}static get ON_BANNER_FIRST_TIME_FULLY_SEEN(){return"amp:banner:first-time-fully-seen"}static get ON_BANNER_LINK_CLICKED(){return"amp:banner:link-clicked"}static get ON_BANNER_BEFORE_CLOSE(){return"amp:banner:before-close"}static get ON_BANNER_AFTER_CLOSE(){return"amp:banner:after-close"}static get ON_BANNER_MUTATED(){return"amp:banner:mutated"}static get ON_BEFORE_FETCH(){return"amp:fetch:before"}static get ON_FETCH_ERROR(){return"amp:fetch:error"}static get ON_FETCH_SUCCESS(){return"amp:fetch:success"}}class q{constructor(e){let{id:t,code:n,name:r,rotationSeconds:i,displayType:s,breakpointType:a,closeExpiration:o=null}=e;this.id=t,this.code=n,this.name=r,this.rotationSeconds=i,this.displayType=s,this.breakpointType=a,this.closeExpiration=o}static createInitial(e){return new q({id:null,code:e,name:null,rotationSeconds:0,displayType:null,breakpointType:null,closeExpiration:null})}isSingle(){return"single"===this.displayType}isRandom(){return"random"===this.displayType}isMultiple(){return"multiple"===this.displayType}toObject(){return{id:this.id,code:this.code,name:this.name,rotationSeconds:this.rotationSeconds,displayType:this.displayType,breakpointType:this.breakpointType,closeExpiration:this.closeExpiration}}}const G=/^(?:(?<INTERVAL_FROM>\d+)-(?<INTERVAL_TO>\d+):|(?<EQ>\d+):|<(?<LT>\d+):|<=(?<LTE>\d+):|>(?<GT>\d+):|>=(?<GTE>\d+):)?(?<VALUE>[^:\s]+)$/,V={};function Q(e,t){const n=function(e){if(e in V)return V[e];const t=e.split(",").map((e=>e.trim())),n=[];for(let e=0;e<t.length;e++){const r=t[e].match(G);if(null===r||void 0===r.groups||void 0===r.groups.VALUE)continue;let i;switch(!0){case void 0!==r.groups.INTERVAL_FROM&&void 0!==r.groups.INTERVAL_TO:i={from:parseInt(r.groups.INTERVAL_FROM),to:parseInt(r.groups.INTERVAL_TO),matches:function(e){return e>=this.from&&e<=this.to}};break;case void 0!==r.groups.EQ:i={eq:parseInt(r.groups.EQ),matches:function(e){return e===this.eq}};break;case void 0!==r.groups.LT:i={lt:parseInt(r.groups.LT),matches:function(e){return e<this.lt}};break;case void 0!==r.groups.LTE:i={lte:parseInt(r.groups.LTE),matches:function(e){return e<=this.lte}};break;case void 0!==r.groups.GT:i={gt:parseInt(r.groups.GT),matches:function(e){return e>this.gt}};break;case void 0!==r.groups.GTE:i={gte:parseInt(r.groups.GTE),matches:function(e){return e>=this.gte}};break;default:i={matches:function(){return!0}}}i&&(i.matches=i.matches.bind(i),i.value=r.groups.VALUE,n.push(i))}const r={rules:n,cache:{}};return r.evaluate=function(e){Number.isInteger(e)||(e=parseInt(e));const t=`i_${e}`;if(t in this.cache)return this.cache[t];for(let n=0;n<this.rules.length;n++){const r=this.rules[n];if(r.matches(e))return this.cache[t]=r.value}return this.cache[t]=null}.bind(r),V[e]=r,r}(e);return n.evaluate(t)}class Y{constructor(e){this.options={},this.options=this.#p({...e})}has(e){return void 0!==this.options[e]}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.options[e]||t}evaluate(e,t){return void 0===this.options[e]?null:Q(this.options[e],t)}override(e){this.options={...this.options,...this.#p({...e})}}#p(e){if("loading-offset"in e){const t=e["loading-offset"],n="loading"in e?e.loading:"loading"in this.options?this.options.loading:null,r=null!==n?`>=${t}:${n}`:null;let i='AMP deprecation warning: The banner option "loading-offset" is deprecated and will be removed in some future release.';null!==r&&(i+=` Instead of options {"loading": "${n}", "loading-offset": "${t}"} use an expression based option {"loading": "${r}"}.`),console.warn(i),delete e["loading-offset"],null!==r&&(e.loading=r)}return e}}class z{#f;#m;#g;#b=null;#v=null;#y={};constructor(e,t,n,r,i){if(this.constructor===z)throw new TypeError("Can not construct abstract class Banner.");this.#f=t,this.#m=n,this.#g=new Y(i),this._eventBus=e,this._positionData=q.createInitial(r),this.STATE=W}get uid(){return this.#f}get element(){return this.#m}get state(){return this.#b}get stateInfo(){return this.#v}get stateCounter(){return this.#y[this.state]||0}get position(){return this.positionData.code}get positionData(){return this._positionData}get options(){return this.#g}get fingerprints(){return[]}unsetFingerprint(e){}setState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(-1===this.STATE.STATES.indexOf(e))throw new TypeError(`${e} is not valid state.`);this.#b=e,this.#v=t.toString(),this.#y[e]=(this.#y[e]||0)+1,this._eventBus.dispatch(H.ON_BANNER_STATE_CHANGED,{banner:this})}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.startsWith("amp:banner:"))throw new Error(`Unable to attach listener on event "${e}" through a banner.`);return this._eventBus.subscribe(e,(function(e){const{banner:r}=e;r===this&&(null!==n?t.call(n,e):t(e))}),this)}getCurrentBreakpoint(e){return null}overrideOptions(e){this.#g.override(e)}redrawIfNeeded(){}isManaged(){return!1}isExternal(){return!1}isEmbed(){return!1}}n(4979);class J{constructor(e,t){let{bannerId:n,bannerName:r,positionId:i,positionCode:s,positionName:a,campaignId:o,campaignCode:c,campaignName:l,closeExpiration:u=null}=t;this.value=e,this.bannerId=n,this.bannerName=r,this.positionId=i,this.positionCode=s,this.positionName=a,this.campaignId=o,this.campaignCode=c,this.campaignName=l,this.closeExpiration=u}static createFromProperties(e){return new J(btoa(encodeURIComponent(JSON.stringify(e))),e)}static createFromValue(e){return new J(e,JSON.parse(decodeURIComponent(atob(e))))}toString(){return this.value}}n(3609);class K{#E;#w;constructor(e,t){this.#E=e,this.#w=t}get breakpoint(){return this.#E}get data(){return this.#w}}class X{#N;#T;#S=[];#R=void 0;#_={min:null,max:null,reset:function(){this.min=this.max=null}};constructor(e,t){this.#N=e,this.#T=t}addContent(e,t){this.#S.push(new K(e,t)),this.#R=void 0}get contents(){return this.#S}get content(){if(void 0!==this.#R&&!this.needRedraw())return this.#R;this.#_.reset();const e=this.#N.width,t=this.#T;let n=null,r=null,i=null;const s=[];this.#A(this.#S,(a=>{let o=a.breakpoint;null!==o?(s.push(o),("min"===t&&e>=o&&(null===i||i<o)||"max"===t&&e<=o&&(null===i||i>o))&&(r=a,i=o,this.#_[t]=o)):n=a})),s.sort(((e,t)=>e-t)),"min"===t?s.unshift(null):s.push(null);const a=s.indexOf(i);return"max"===t&&a-1 in s&&(this.#_.min=s[a-1]+1),"min"===t&&a+1 in s&&(this.#_.max=s[a+1]-1),this.#R=null!==r?r:n}needRedraw(){if(void 0===this.#R)return!0;const e=this.#N.width;return null!==this.#_.min&&e<this.#_.min||null!==this.#_.max&&e>this.#_.max}#A(e,t){for(let n in e)t(e[n],n)}}class Z{#w;#S;#B=null;constructor(e,t,n){this.#w=e,this.#S=new X(n,t);for(let e of this.#w.contents)"img"!==e.type||"dimensions"in e||(e.dimensions={width:null,height:null}),this.#S.addContent(e.breakpoint,e)}set fingerprint(e){if(!(e instanceof J))throw new TypeError("The value must be instance of Fingerprint object.");this.#B=e}get fingerprint(){return this.#B}get id(){return this.#w.id}get name(){return this.#w.name||null}get score(){return this.#w.score}get campaign(){return console.warn("Usage of deprecated property `BannerData.campaign`. Please use property `campaignCode` instead."),this.campaignCode()}get campaignId(){return this.#w.campaign_id||null}get campaignCode(){return this.#w.campaign_code||this.#w.campaign||null}get campaignName(){return this.#w.campaign_name||null}get closeExpiration(){return"close_expiration"in this.#w?this.#w.close_expiration:null}get content(){return this.#S.content?.data||null}needRedraw(){return this.#S.needRedraw()}}class ee{#I;constructor(e){this.#I=e}get positionCode(){return this.#I.positionData.code}get rotationSeconds(){return this.#I.positionData.rotationSeconds}get displayType(){return this.#I.positionData.displayType}get breakpointType(){return this.#I.positionData.breakpointType}get fingerprints(){return this.#I.fingerprints}get bannerData(){return this.#I.bannerData}}class te{static randomByWeights(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"weight";const n={};let r=0;for(let n=0;n<e.length;n++)r+=e[n][t];for(let i=0;i<e.length;i++)n[i]=e[i][t]/r;let i=0,s=Math.random();for(;s>0;)s-=n[i],i++;return i--,e[i]?e[i]:e[0]}}function ne(e,t){if(e instanceof t.HTMLElement)return e;if("string"!=typeof e)throw new TypeError("Element must be instance of HTMLElement or String");let n;if(n="#"===e.charAt(0)?document.getElementById(e.slice(1)):document.querySelector(e),!(n instanceof t.HTMLElement))throw new TypeError("Selector "+e+" is invalid.");return n}function re(e){Array.from(e.getElementsByTagName("script")).forEach((e=>{if(""!==e.type&&"text/javascript"!==e.type)return;const t=document.createElement("script");Array.from(e.attributes).forEach((e=>{t.setAttribute(e.name,e.value)})),t.appendChild(document.createTextNode(e.innerHTML)),e.parentNode.replaceChild(t,e)}))}class ie extends z{#N;#O;#x=[];#M;#C=!1;#D=null;#k=[];constructor(e,t,n,r,i,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};super(n,r,i,s,arguments.length>7&&void 0!==arguments[7]?arguments[7]:{}),this.#N=e,this.#O=t,this.#M=a;for(let e in a)this.#x.push(new P(e,a[e]));this.setState(this.STATE.NEW,"Banner created.")}set html(e){this.element.innerHTML=e,re(this.element)}get resources(){return this.#x}get rawResources(){return this.#M}get data(){return console.warn("Usage of deprecated property `ManagedBanner.data`. Please use property `positionData` for accessing information about a position."),new ee(this)}get fingerprints(){let e;try{e=this.bannerData}catch(e){return[]}return null===e?[]:(this.positionData.isMultiple()||(e=[e]),e.map((e=>e.fingerprint)))}get bannerData(){if(null!==this.#D)return this.#D;if(!this.#k.length)return null;let e=null;const t=this.positionData,n=e=>J.createFromProperties({bannerId:e.id,bannerName:e.name,positionId:t.id,positionCode:t.code,positionName:t.name,campaignId:e.campaignId,campaignCode:e.campaignCode,campaignName:e.campaignName,closeExpiration:e.closeExpiration});switch(!0){case t.isSingle():e=this.#k.reduce(((e,t)=>e.score>=t.score?e:t)),e.fingerprint=n(e);break;case t.isRandom():e=te.randomByWeights(this.#k,"score"),e.fingerprint=n(e);break;case t.isMultiple():e=this.#k.sort(((e,t)=>t.score-e.score));for(let t of e)t.fingerprint=n(t);break;default:throw new Error(`Invalid display type ${this.displayType}.`)}return this.#D=e,e}unsetFingerprint(e){const t=e.bannerId,n=this.positionData;if(!!this.#k.filter((e=>e.id===t))[0]){switch(!0){case n.isSingle():this.#k=[],this.#D=null;break;case n.isRandom():this.#D&&this.#D.id===t?(this.#k=[],this.#D=null):this.#k=this.#k.filter((e=>e.id!==t));break;case n.isMultiple():this.#k=this.#k.filter((e=>e.id!==t)),this.#D&&(this.#D=this.#D.filter((e=>e.id!==t)))}0>=this.#k.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):n.isRandom()&&this.redrawIfNeeded()}}setResponseData(e){if(this.#C)throw new Error(`Data for banner on position ${this.position} is already set.`);this._positionData=new q({id:e.position_id||null,code:this._positionData.code,name:e.position_name||null,rotationSeconds:e.rotation_seconds,displayType:e.display_type,breakpointType:e.breakpoint_type,closeExpiration:e.close_expiration||null}),"options"in e&&this.overrideOptions(e.options);const t=[];for(let n in e.banners||[])t.push(new Z(e.banners[n],e.breakpoint_type,this.#N));this.#k=t,this.#C=!0,0>=this.#k.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):this.#L("Banner was successfully rendered.")}getCurrentBreakpoint(e){let t=this.bannerData;t=(Array.isArray(t)?t:t?[t]:[]).find((t=>t.id===e));const n=t&&t.content?t.content.breakpoint:null;return null===n?null:parseInt(n)}isManaged(){return!0}redrawIfNeeded(){this.#F()&&this.#L("Banner was successfully redrawn.")}#L(e){try{this.html=this.#O.render(this)}catch(e){return void this.setState(this.STATE.ERROR,"Render error: "+e.message)}this.setState(this.STATE.RENDERED,e)}#F(){let e=this.bannerData;Array.isArray(e)||(e=[e]);for(let t in e)if(e[t].needRedraw())return!0;return!1}}class se{static parseResources(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-resource-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(18)]=e.value.split(",").map((e=>e.trim())));return t}static parseOptions(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-option-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(16)]=e.value.trim());return t}}class ae extends z{#P=[];#j={};#$=null;constructor(e,t,n,r){if(!("ampBannerExternal"in r.dataset))throw new Error('Unable to initialize ExternalBanner from element that does not have an attribute "data-amp-external".');const i=JSON.parse(decodeURIComponent(atob(r.dataset.ampBannerExternal)));if(!("state"in i)||!("positionData"in i))throw new Error('Unable to initialize ExternalBanner data attribute "data-amp-external" is malformed.');const s=i.state,a=new q(i.positionData),o=se.parseOptions(r);super(t,n,r,a.code,o);const c=[],l={},u=r.cloneNode(!0),d=u.querySelectorAll("[data-amp-banner-fingerprint]"),h=d.item(0)?.parentElement||null;let p=h;for(;null!==p&&p!==u&&p?.parentElement!==u;)p=p.parentElement||null;for(let t of d){const n=J.createFromValue(t.dataset.ampBannerFingerprint);c.push(n);for(let r of t.querySelectorAll("[data-amp-content-breakpoint]")){let i=r.dataset.ampContentBreakpoint;i="default"===i?null:parseInt(i),n.bannerId in l||(l[n.bannerId]=new X(e,a.breakpointType));const s=t.cloneNode(!1);s.insertAdjacentElement("afterbegin",r),l[n.bannerId].addContent(i,{html:s.outerHTML})}}h&&(h.dataset.ampBannerList="true"),h&&(h.innerHTML=""),this._positionData=a,this.#P=c,this.#j=l,this.#$=p,this.#U(!1),this.setState(s.value,s.info)}get fingerprints(){return this.#P}unsetFingerprint(e){this.#P=this.#P.filter((t=>t.value!==e.value));const t=e.bannerId;t in this.#j&&delete this.#j[t],0>=this.#P.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){const t=this.#j[e]||null;return null===t?null:t.content?.breakpoint||null}isExternal(){return!0}redrawIfNeeded(){this.#U(!0)&&this.setState(this.STATE.RENDERED,"Banner was successfully redrawn.")}#U(e){let t=!e;if(!t)for(let e in this.#j){if(this.#j[e].needRedraw()){t=!0;break}}if(!t)return!1;const n=[];for(let e in this.#j){const t=this.#j[e].content;null!==t&&n.push(t.data.html)}if(0>=n.length)return this.element.innerHTML="",!0;const r=this.#$?this.#$.cloneNode(!0):null;return((null!==r&&void 0===r.dataset.ampBannerList?r.querySelector("[data-amp-banner-list]"):null)??r??this.element).innerHTML=n.join("\n"),null!==r&&(this.element.innerHTML=r.outerHTML,re(this.element)),!0}}class oe extends z{#W;#P;constructor(e,t,n,r,i,s){super(e,t,n,i,s),this.#W=r,this.#P=[],this.setState(this.STATE.NEW,"Banner created.")}get iframe(){return this.#W}get fingerprints(){return this.#P}unsetFingerprint(e){this.#P=this.#P.filter((t=>t.value!==e.value)),0>=this.#P.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){throw new Error("Method EmbedBanner.getCurrentBreakpoint() is not readable.")}isEmbed(){return!0}updatePositionData(e){const t=["id","name","rotationSeconds","displayType","breakpointType","closeExpiration"],n=this.positionData;for(let r of t)r in e&&(n[r]=e[r])}updateFingerprints(e){this.#P=e.map((e=>e instanceof J?e:J.createFromValue(e)))}}class ce{#H;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.#H=e-1}getNextIdentifier(){return++this.#H}}class le{#q;#N;#G;#V;#k=[];#Q;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.#q=e,this.#N=t,this.#G=n,this.#V=new ce,this.#Q=new MutationObserver((e=>{for(const t of e){if(!(t.target instanceof HTMLElement))continue;const e=t.target.closest("[data-amp-attached]")?.dataset?.ampAttached,n=void 0!==e?this.getBannerByUid(parseInt(e)):null;n&&this.#q.dispatch(H.ON_BANNER_MUTATED,{banner:n,mutation:t})}})),this.STATE=W}addExternalBanner(e){e=ne(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:window);const t=this.#V.getNextIdentifier();e.setAttribute("data-amp-attached",t);const n=new ae(this.#N,this.#q,t,e);return this.#Y(e),this.#k.push(n),n}addManagedBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window;if(null===this.#G)throw new Error("Unable to add managed banner, renderer is not provided.");e=ne(e,i);const s=this.#V.getNextIdentifier();e.setAttribute("data-amp-attached",s);const a=new ie(this.#N,this.#G,this.#q,s,e,t,n,r);return this.#Y(e),this.#k.push(a),a}addEmbedBanner(e,t,n,r){e=ne(e,window),t=ne(t,window);const i=this.#V.getNextIdentifier();e.setAttribute("data-amp-attached",i);const s=new oe(this.#q,i,e,t,n,r);return this.#Y(e),this.#k.push(s),s}removeBanner(e){const t=this.#k.length;return this.#k=this.#k.filter((t=>t!==e)),t!==this.#k.length}getBannersByState(e){let{state:t,managed:n=!0,external:r=!0,embed:i=!0}=e;return this.#k.filter((e=>e instanceof z&&e.state===t&&!(e instanceof ie&&!n||e instanceof ae&&!r||e instanceof oe&&!i)))}getBannerByFingerprint(e){const t=e instanceof J?e.value:e;for(let e of this.#k)if(!(e instanceof oe))for(let n of e.fingerprints)if(n.value===t)return e;return null}getBannerByUid(e){for(let t of this.#k)if(t.uid===e)return t;return null}getBannerByPosition(e){for(let t of this.#k)if(t.position===e)return t;return null}#Y(e){e._ampBannerMutationsObserved||(this.#Q.observe(e,{subtree:!0,childList:!0,characterData:!1,attributes:!0,attributeFilter:["data-amp-banner-close"]}),e._ampBannerMutationsObserved=!0)}}class ue{#z;constructor(e){this.#z=e}static fromCurrentWindow(){return new ue((()=>document.documentElement.clientWidth||document.body.clientWidth))}get width(){return this.#z()}}class de{constructor(e){let{key:t,expiresAt:n}=e;this.key=t,this.expiresAt=n}static position(e){let{positionCode:t,closingExpiration:n}=e;if("number"!=typeof n)throw new Error(`Unable to create position entry via factory ClosingEntry::position({ positionCode: ${t}, closingExpiration: ${n} }), argument "closingExpiration" must be a number.`);return new de({key:he.position(t),expiresAt:Math.round(+new Date/1e3+n)})}static banner(e){let{positionCode:t,bannerId:n,closingExpiration:r}=e;return new de({key:he.banner(t,n),expiresAt:"number"==typeof r&&Math.round(+new Date/1e3+r)})}}class he{constructor(e){let{value:t,type:n,args:r}=e;this.value=t,this.type=n,this.args=r}static position(e){return new he({value:`p:${e}`,type:"position",args:{positionCode:e}})}static banner(e,t){return new he({value:`b:${e}:${t}`,type:"banner",args:{positionCode:e,bannerId:t}})}static tryParse(e){const t=e.split(":");switch(!0){case"p"===t[0]&&2===t.length:return he.position(t[1]);case"b"===t[0]&&3===t.length:return he.banner(t[1],t[2])}return null}isPosition(){return"position"===this.type}isBanner(){return"banner"===this.type}toString(){return this.value}}class pe{#J;#K;#X;#Z=null;constructor(e){let{storage:t,key:n,maxItems:r,onExternalChange:i}=e;switch(t){case"localStorage":"localStorage"in window?t=window.localStorage:(console.warn("LocalStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ee());break;case"sessionStorage":"sessionStorage"in window?t=window.sessionStorage:(console.warn("SessionStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ee());break;default:"memoryStorage"!==t&&console.warn(`Unknown storage "${t}", fallback to memoryStorage.`),t=this.#ee()}this.#J=t,this.#K=n,this.#X=r,i&&this.#J instanceof Storage&&window.addEventListener("storage",(e=>{if(null!==e.key&&this.#K!==e.key)return;const t=this.#Z||{},n=null!==e.newValue&&""!==e.newValue?JSON.parse(e.newValue):{},r=Object.keys(t),s=Object.keys(n).filter((e=>!r.includes(e))).map((e=>he.tryParse(e))).filter((e=>null!==e));this.#Z=n,0<s.length&&i(s)}))}close(e){const t=this.#te(),n=this.#ne(),r=[];for(let i in e){const s=e[i];if(!1!==s.expiresAt&&s.expiresAt<=n)continue;const a=s.key.toString();a in t&&t[a]===s.expiresAt||(t[a]=s.expiresAt,r.push(a))}if(0>=r.length)return;const i=Object.values(t).length;i>this.#X&&Object.entries(t).filter((e=>-1===r.indexOf(e[0]))).sort(((e,t)=>(e[1]||Number.MAX_SAFE_INTEGER)-(t[1]||Number.MAX_SAFE_INTEGER))).slice(0,i-this.#X).forEach((e=>{delete t[e[0]]})),this.#Z=t,this.#re()}release(e){const t=this.#te();let n=!1;for(let r in e){const i=e[r].toString();i in t&&(delete t[i],n=!0)}n&&(this.#Z=t,this.#re())}isClosed(e){const t=this.#te(),n=e.toString();return n in t&&(!1===t[n]||t[n]>this.#ne()||(setTimeout((()=>this.release([e])),0),!1))}#te(){if(null!==this.#Z)return this.#Z;const e=this.#J.getItem(this.#K);let t=null!==e&&""!==e?JSON.parse(e):{};return Array.isArray(t)&&(t={},this.#J.setItem(this.#K,"{}")),this.#Z=t}#re(){null!==this.#Z&&this.#J.setItem(this.#K,JSON.stringify(this.#Z))}#ee(){const e={items:{}};return e.setItem=function(e,t){this.items[e]=t}.bind(e),e.getItem=function(e){return e in this.items?this.items[e]:null}.bind(e),e}#ne(){return Math.round(+new Date/1e3)}}class fe{#ie;#q;#se;#ae;#oe;constructor(e){let{bannerManager:t,eventBus:n,config:r={storage:"memoryStorage",key:"amp-closed-banners",maxItems:500},bannerFrameMessenger:i,parentFrameMessenger:s}=e;this.#ie=t,this.#q=n,this.#se=i,this.#ae=s;const{storage:a,key:o,maxItems:c}=r;this.#oe=new pe({storage:a,key:o,maxItems:c,onExternalChange:e=>{for(let t=0;t<e.length;t++){const n=e[t];n.isBanner()&&this.closeBanner(n.args.positionCode,n.args.bannerId)}}}),this.#se&&this.#se.on("storeClosedEntries",(e=>{let{data:t}=e;const{uid:n,entries:r,fingerprints:i}=t,s=this.#ie.getBannerByUid(n);if(s instanceof oe){for(let e=0;e<i.length;e++)s.unsetFingerprint(J.createFromValue(i[e]));this.#oe.close(r.map((e=>new de({key:he.tryParse(e.key),expiresAt:e.expiresAt}))))}})),this.#ae&&this.#ae.on("closeBanner",(e=>{let{data:t}=e;const{positionCode:n,bannerId:r}=t;n&&r&&this.closeBanner(n,r)}))}attachUi(){const e=e=>{let{banner:t,button:n}=e;n._ampCloseActionAttached||(n._ampCloseActionAttached=!0,n.addEventListener("click",(e=>{e.preventDefault();const r=n.closest("[data-amp-banner-fingerprint]");if(!r)return;const i=r.dataset.ampBannerFingerprint,s=t.fingerprints;for(let e=0;e<s.length;e++){const n=s[e];n.value===i&&this.closeBanner(t.position,n.bannerId)}})))};this.#q.subscribe(H.ON_BANNER_STATE_CHANGED,(t=>{let{banner:n}=t;n.state===n.STATE.RENDERED?Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})):n.state===n.STATE.CLOSED&&(n.element.innerHTML="")}),null,-100),this.#q.subscribe(H.ON_BANNER_MUTATED,(t=>{let{banner:n,mutation:r}=t;n.state===n.STATE.RENDERED&&(0<r.addedNodes.length&&Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})),r.attributeName&&e({banner:n,button:r.target}))}))}isBannerClosed(e,t){return this.#oe.isClosed(he.banner(e,t))}isPositionClosed(e){return this.#oe.isClosed(he.position(e))}closeBanner(e,t){const n=this.#ie.getBannerByPosition(e);if(null===n)return;const r=[...n.fingerprints],i=r.filter((e=>e.bannerId===t))[0];if(void 0===i)return;if(n instanceof oe)return void(this.#se&&this.#se.sendToBanner(n,"closeBanner",{positionCode:e,bannerId:t}));const s=i.closeExpiration;this.#ce({banner:n,fingerprint:i}).then((()=>{const a=[];if(a.push(de.banner({positionCode:e,bannerId:t,closingExpiration:s})),null!==n.positionData.closeExpiration){const t=[],i=n.fingerprints;for(let e=0;e<i.length;e++)t.push(this.#ce({banner:n,fingerprint:i[e]}));Promise.all(t).then((()=>{a.push(de.position({positionCode:e,closingExpiration:n.positionData.closeExpiration})),setTimeout((()=>this.#oe.close(a)),0),this.#ae&&this.#ae.sendToParent("storeClosedEntries",{entries:a.map((e=>({key:e.key.toString(),expiresAt:e.expiresAt}))),fingerprints:r.map((e=>e.toString()))})}))}else setTimeout((()=>this.#oe.close(a)),0),this.#ae&&this.#ae.sendToParent("storeClosedEntries",{entries:a.map((e=>({key:e.key.toString(),expiresAt:e.expiresAt}))),fingerprints:[i.toString()]})}))}#ce(e){let{banner:t,fingerprint:n}=e;const r=t.element.querySelector(`[data-amp-banner-fingerprint="${n.value}"]`);if(!r)return Promise.resolve(void 0);let i=e=>e.remove();return this.#q.dispatch(H.ON_BANNER_BEFORE_CLOSE,{fingerprint:n,element:r,banner:t,setOperation:e=>i=e}),Promise.resolve(i(r)).then((()=>{this.#q.dispatch(H.ON_BANNER_AFTER_CLOSE,{fingerprint:n,element:r,banner:t}),t.unsetFingerprint(n)}))}}class me{#le;#ue;#de;constructor(){this.#le=new ce,this.#ue={},this.#de={}}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("function"!=typeof t)throw new TypeError("Listener must be of type function.");const i="idx_"+this.#le.getNextIdentifier();return this.#ue[e]=this.#ue[e]||{},this.#ue[e][i]={callback:t,scope:n,priority:r},e in this.#de&&delete this.#de[e],()=>{e in this.#ue&&i in this.#ue[e]&&delete this.#ue[e][i]}}dispatch(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let t of this.getSortedListeners(e))null!==t.scope?t.callback.call(t.scope,...n):t.callback(...n)}reset(){this.#ue={}}getSortedListeners(e){if(e in this.#de)return this.#de[e];const t=Object.values(this.#ue[e]||{}).sort(((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:0));return this.#de[e]=t}}const ge=_.template;class be{#he;#pe;constructor(e){this.#he=e,this.#pe={}}getTemplate(e){if(e in this.#pe)return this.#pe[e];if(!(e in this.#he))throw new Error(`Template with type "${e}" not found.`);return this.#pe[e]=ge(this.#he[e])}}class ve{#fe;constructor(e){this.#fe=new be(e)}render(e){let t=e.bannerData;return t=Array.isArray(t)?t.filter((e=>null!==e.content)):t,this.#fe.getTemplate(e.positionData.displayType)({banner:e,data:t})}}class ye{static create(e,t,n,r,i,s){let a=[];for(let e in i)a.push({pixels:parseInt(e),ratio:i[e]});a=a.sort(((e,t)=>t.pixels-e.pixels));const o=e=>{const t=getComputedStyle(e),n=(e.offsetWidth-(parseFloat(t.paddingLeft)+parseFloat(t.paddingRight))-(parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)))*(e.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom))-(parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)));for(let e of a)if(n>=e.pixels)return e.ratio;return r};return new IntersectionObserver((r=>{const i=[];let a={},c={};for(let t of r){const r=t.target.dataset.ampBannerFingerprint,s=e.getBannerByFingerprint(r);if(!s)continue;const l=n[r];if(!l)continue;const u={fingerprint:l.fingerprint,element:t.target,banner:s};if(i.push({...u,entry:t}),!l.alreadySeen){const e=t.intersectionRatio>=o(t.target);a[r]=!(r in a)||!a[r].isIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isIntersecting:e}:a[r]}if(!l.alreadyFullySeen){const e=.99<=t.intersectionRatio;c[r]=!(r in c)||!c[r].isFullyIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isFullyIntersecting:e}:c[r]}}for(let e of Object.values(a)){const{fingerprintArgs:n,fingerprintMetadata:r,isIntersecting:i}=e;i&&!r.alreadySeen&&null===r.firstTimeSeenTimeoutId?r.firstTimeSeenTimeoutId=setTimeout((()=>{r.alreadySeen=!0,t.dispatch(H.ON_BANNER_FIRST_TIME_SEEN,n)}),s):i||null===r.firstTimeSeenTimeoutId||(clearTimeout(r.firstTimeSeenTimeoutId),r.firstTimeSeenTimeoutId=null)}for(let e of Object.values(c)){const{fingerprintArgs:n,fingerprintMetadata:r,isFullyIntersecting:i}=e;i&&!r.alreadyFullySeen&&null===r.firstTimeFullySeenTimeoutId?r.firstTimeFullySeenTimeoutId=setTimeout((()=>{r.alreadyFullySeen=!0,t.dispatch(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,n)}),s):i||null===r.firstTimeFullySeenTimeoutId||(clearTimeout(r.firstTimeFullySeenTimeoutId),r.firstTimeFullySeenTimeoutId=null)}for(let e of i)t.dispatch(H.ON_BANNER_INTERSECTION_CHANGED,e)}),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,.99]})}}class Ee{#me;#ie;#q;#P;#ge;constructor(e,t,n){this.#me=!1,this.#ie=e,this.#q=t,this.#P={},this.#ge=ye.create(e,t,this.#P,n.defaultIntersectionRatio,n.intersectionRatioMap,n.firstTimeSeenTimeout)}start(){if(this.#me)return;this.#me=!0,this.#q.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;W.RENDERED!==t.state||t.isEmbed()||this.#be(t)}),null,-100),this.#q.subscribe(H.ON_BANNER_MUTATED,(e=>{let{banner:t,mutation:n}=e;W.RENDERED===t.state&&!t.isEmbed()&&0<n.addedNodes.length&&this.#be(t)}));const e=this.#ie.getBannersByState({state:W.RENDERED,embed:!1});for(let t of e)this.#be(t)}#be(e){const t=this,n=e.element.querySelectorAll("[data-amp-banner-fingerprint]");for(let e of n){const n=e.dataset.ampBannerFingerprint;n in this.#P||(this.#P[n]={fingerprint:J.createFromValue(n),alreadySeen:!1,alreadyFullySeen:!1,firstTimeSeenTimeoutId:null,firstTimeFullySeenTimeoutId:null}),e._ampBannerFingerprintObserved||(e._ampBannerFingerprintObserved=!0,this.#ge.observe(e));const r=e.getElementsByTagName("a");for(let e of r)e._ampClickingMetricsAttached||(e._ampClickingMetricsAttached=!0,e.addEventListener("click",(function(e){const r=t.#P[n];if(!r)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the fingerprint "${n}" not managed.`);const i=t.#ie.getBannerByFingerprint(n);if(!i)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the banner for fingerprint "${n}" not found.`);const s={fingerprint:r.fingerprint,element:this.closest("[data-amp-banner-fingerprint]"),banner:i,target:this,clickEvent:e};r.alreadySeen||(r.alreadySeen=!0,t.#q.dispatch(H.ON_BANNER_FIRST_TIME_SEEN,s)),t.#q.dispatch(H.ON_BANNER_LINK_CLICKED,s)})))}}}class we{static get BANNER_LOADED(){return"amp:banner:loaded"}static get BANNER_DISPLAYED(){return"amp:banner:displayed"}static get BANNER_FULLY_DISPLAYED(){return"amp:banner:fully-displayed"}static get BANNER_CLICKED(){return"amp:banner:clicked"}static get BANNER_CLOSED(){return"amp:banner:closed"}static get EVENTS(){return[we.BANNER_LOADED,we.BANNER_DISPLAYED,we.BANNER_FULLY_DISPLAYED,we.BANNER_CLICKED,we.BANNER_CLOSED]}}class Ne{constructor(e){const t={channel_code:"channel_code",banner_id:"banner_id",banner_name:"banner_name",position_id:"position_id",position_code:"position_code",position_name:"position_name",campaign_id:"campaign_id",campaign_code:"campaign_code",campaign_name:"campaign_name",breakpoint:"breakpoint",link:"link"};if("params"in e)for(let n in e.params)n in t&&"string"==typeof e.params[n]&&(t[n]=e.params[n]);const n="extraParams"in e&&"object"==typeof e.extraParams?e.extraParams:{},r={},i=e=>({name:e,enabled:!0,params:{...t},extraParams:{...n}});if(r[we.BANNER_LOADED]=i(we.BANNER_LOADED),r[we.BANNER_DISPLAYED]=i(we.BANNER_DISPLAYED),r[we.BANNER_FULLY_DISPLAYED]=i(we.BANNER_FULLY_DISPLAYED),r[we.BANNER_CLICKED]=i(we.BANNER_CLICKED),r[we.BANNER_CLOSED]=i(we.BANNER_CLOSED),"events"in e)for(let t in e.events){const n=e.events[t];if(!0!==n&&t in r)if(!1!==n)if("string"!=typeof n){if("object"==typeof n){if("name"in n&&"string"==typeof n.name&&(r[t].name=n.name),"params"in n&&"object"==typeof n.params)for(let e in n.params)e in r[t].params&&"string"==typeof n.params[e]&&(r[t].params[e]=n.params[e]);"extraParams"in n&&"object"==typeof n.extraParams&&(r[t].extraParams={...r[t].extraParams,...n.extraParams})}}else r[t].name=n;else r[t].enabled=!1}this.events=r}}class Te{#ve;#q;#ye;#Ee;#we={started:!1,events:[],cleanup:[]};constructor(e,t,n){this.#ve=e,this.#q=t,this.#ye=n,this.#Ee=!1}collectBeforeAttach(){if(this.#we.started||this.#Ee)return;this.#we.started=!0;const e=this.#q,t=new Ne({}),n=t.events[we.BANNER_LOADED],r=t.events[we.BANNER_DISPLAYED],i=t.events[we.BANNER_FULLY_DISPLAYED],s=t.events[we.BANNER_CLICKED],a=t.events[we.BANNER_CLOSED];this.#we.cleanup.push(e.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&W.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)this.#we.events.push({name:we.BANNER_LOADED,params:this.#Ne({event:n,fingerprint:e,banner:t})})}))),this.#we.cleanup.push(e.subscribe(H.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#we.events.push({name:we.BANNER_DISPLAYED,params:this.#Ne({event:r,fingerprint:t,banner:n})})}))),this.#we.cleanup.push(e.subscribe(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#we.events.push({name:we.BANNER_FULLY_DISPLAYED,params:this.#Ne({event:i,fingerprint:t,banner:n})})}))),this.#we.cleanup.push(e.subscribe(H.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:n,target:r}=e;const i=this.#Ne({event:s,fingerprint:t,banner:n});i[s.params.link]=r.href||"",this.#we.events.push({name:we.BANNER_CLICKED,params:i})}))),this.#we.cleanup.push(e.subscribe(H.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:n}=e;this.#we.events.push({name:we.BANNER_CLOSED,params:this.#Ne({event:a,fingerprint:t,banner:n})})})))}attach(e){if(this.#Ee)return;this.#Ee=!0;const t=this.#q,n=this.#ve;if(!n.hasAnyReceiver())return void this.#Te();const r=e.events[we.BANNER_LOADED],i=e.events[we.BANNER_DISPLAYED],s=e.events[we.BANNER_FULLY_DISPLAYED],a=e.events[we.BANNER_CLICKED],o=e.events[we.BANNER_CLOSED];if(this.#we.started){for(let t in this.#we.events){const{name:r,params:i}=this.#we.events[t],s=e.events[r];if(!s.enabled)continue;const a={};for(let e in i)a[s.params[e]]=i[e];n.send(s.name,{...a,...s.extraParams})}this.#Te()}r.enabled&&t.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&W.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)n.send(r.name,this.#Ne({event:r,fingerprint:e,banner:t}))})),i.enabled&&t.subscribe(H.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(i.name,this.#Ne({event:i,fingerprint:t,banner:r}))})),s.enabled&&t.subscribe(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(s.name,this.#Ne({event:s,fingerprint:t,banner:r}))})),a.enabled&&t.subscribe(H.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:r,target:i}=e;const s=this.#Ne({event:a,fingerprint:t,banner:r});s[a.params.link]=i.href||"",n.send(a.name,s)})),o.enabled&&t.subscribe(H.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:r}=e;n.send(o.name,this.#Ne({event:o,fingerprint:t,banner:r}))}))}#Ne=e=>{let{event:t,fingerprint:n,banner:r}=e,i=r.getCurrentBreakpoint(n.bannerId);i=null===i?"default":`${"min"===r.positionData.breakpointType?">=":"<="}${i}`;const s={};return s[t.params.channel_code]=this.#ye,s[t.params.banner_id]=n.bannerId,s[t.params.banner_name]=n.bannerName,s[t.params.position_id]=n.positionId,s[t.params.position_code]=n.positionCode,s[t.params.position_name]=n.positionName,s[t.params.campaign_id]=n.campaignId,s[t.params.campaign_code]=n.campaignCode,s[t.params.campaign_name]=n.campaignName,s[t.params.breakpoint]=i,{...s,...t.extraParams}};#Te(){for(let e in this.#we.cleanup)this.#we.cleanup[e]();this.#we.events=[],this.#we.cleanup=[]}}let Se=!1;const Re=(e,t)=>{if(!("plausible"in window)||"function"!=typeof window.plausible)return!Se&&console.warn("Unable to send metrics to Plausible because the function plausible() does not occur in the window."),void(Se=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.plausible(e,{props:t})};let _e=!1;const Ae=(e,t)=>{if(!("gtag"in window)||"function"!=typeof window.gtag)return!_e&&console.warn("Unable to send metrics to Google Analytics because the function gtag() does not occur in the window."),void(_e=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.gtag("event",e,t)};let Be=!1;const Ie=(e,t)=>{if(!("dataLayer"in window))return!Be&&console.warn("Unable to send metrics to GTM because the dataLayer does not occur in the window."),void(Be=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.dataLayer.push({event:e,...t})},Oe=(e,t)=>{console.log("Sending metrics.",{eventName:e,eventArgs:t})};class xe{#Se;constructor(e){this.#Se=Array.isArray(e)?e:[e]}static createFromReceivers(e){if(!e)return new xe([]);e=Array.isArray(e)?e:[e];const t=[];for(let n of e)if("function"!=typeof n)switch(n){case"plausible":t.push(Re);break;case"gtag":t.push(Ae);break;case"gtm":t.push(Ie);break;case"debug":t.push(Oe);break;default:console.warn("Unable to send metrics to a receiver of unknown type",n)}else t.push(n);return new xe(t)}hasAnyReceiver(){return this.#Se.length}send(e,t){for(let n of this.#Se)n(e,t)}}class Me{#Re;#q;constructor(e){let{origins:t=[]}=e;this.#q=new me,this.#Re=t}on(e,t){this.#q.subscribe(e,t)}send(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";e.postMessage({message:t,data:n},r)}listen(){window.addEventListener("message",(e=>{if(0<this.#Re.length&&-1===this.#Re.indexOf(e.origin)||"object"!=typeof e.data||!("message"in e.data)||!("data"in e.data))return;const{message:t,data:n}=e.data,r={data:n,origin:e.origin};this._beforeDispatch(t,r)&&this.#q.dispatch(t,r)}),!1)}_beforeDispatch(){return!0}}class Ce extends Me{#h;#_e;#ie;#ve;#Ae=[];constructor(e){let{origin:t,connectionData:n,bannerManager:r,metricsSender:i}=e;super({origins:[t]}),this.#h=t,this.#_e=n,this.#ie=r,this.#ve=i;const s={};s.adjustHeight=this.#Be,s.stateChanged=this.#Ie,s.linkClicked=this.#Oe,s.metrics=this.#xe;for(let e in s)this.on(e,s[e].bind(this));window.addEventListener("resize",(()=>{const e=this.#ie.getBannersByState({state:this.#ie.STATE.RENDERED,managed:!1,external:!1,embed:!0});for(let t of e)this.sendToBanner(t,"windowResized",{windowWidth:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth})}))}connectBanner(e){e.iframe.addEventListener("load",(()=>{const t=this.#_e;t.uid=e.uid,t.windowWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.sendToBanner(e,"connect",t)}))}sendToBanner(e,t,n){this.send(e.iframe.contentWindow,t,n,this.#h)}_beforeDispatch(e,t){let{data:n}=t;const{uid:r}=n;if(-1===this.#Ae.indexOf(r)){const e=this.#Me(r);e&&(e.iframe.style.visibility="visible",this.#Ae.push(r))}return!0}#Be(e){let{data:t}=e;const n=this.#Me(t.uid);n&&(n.iframe.style.height=t.height+"px")}#Ie(e){let{data:t}=e;const n=this.#Me(t.uid);null!==n&&("positionData"in t&&n.updatePositionData(t.positionData),"fingerprints"in t&&n.updateFingerprints(t.fingerprints),n.setState(t.state,`[embed]: ${t.stateInfo}`))}#Oe(e){let{data:t}=e;const{href:n,target:r}=t;"_blank"===r?window.open(n,r):window.location.href=n}#xe(e){let{data:t}=e;const{eventName:n,eventArgs:r}=t;this.#ve.hasAnyReceiver()&&this.#ve.send(n,r)}#Me(e){const t=this.#ie.getBannerByUid(e);return t instanceof oe?t:(console.warn(`Error in communication with embed banner. Embed banner with UID ${e} not attached.`),null)}}class De{#Ce;#De;#q;#ke;#Le;#Fe=null;#ie;#Pe;#je;#ve;#$e;#Ue;constructor(e,t){this.EVENTS=H,this.#Ce=e,this.#De=t=function(e){const t=o({method:"GET",url:null,version:1,channel:null,locale:null,resources:{},origin:null,template:c,interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{receiver:null,events:{},params:{},extraParams:{}},closing:{storage:"localStorage",key:"amp-closed-banners",maxItems:500}},e);if("string"!=typeof t.method||!(t.method.toUpperCase()in{GET:1,POST:1}))throw new Error(`The option "method" must be one of these ["GET", "POST"], ${t.method} passed.`);if(t.method=t.method.toUpperCase(),"string"!=typeof t.url)throw new Error(`The option "url" is required and must be a valid URL, ${t.url} passed.`);if("number"!=typeof t.version)throw new Error(`The option "version" must be a number, ${t.version} passed.`);if("string"!=typeof t.channel)throw new Error(`The option "channel" is required and must be a string, ${t.channel} passed.`);if(null!==t.locale&&"string"!=typeof t.locale)throw new Error(`The option "locale" must be a string, ${t.locale} passed.`);if("object"!=typeof t.resources)throw new Error(`The option "resources" must be an object of that describes resources, ${t.resources} passed.`);if(null!==t.origin&&"string"!=typeof t.origin)throw new Error(`The option "origin" must be a valid URL, ${t.origin} passed.`);if("object"!=typeof t.template)throw new Error(`The option "template" must be an object of the format { single: string, random: string, multiple: string }, ${t.template} passed.`);for(const[e,n]of Object.entries(t.template))if("string"!=typeof n)throw new Error(`The option "template.${e}" must be a string (lodash template), ${n} passed.`);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=l(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=l(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { receiver: null|string|function|array<string|function>, events: object, params: object }, ${t.metrics} passed.`);if(null!==t.metrics.receiver&&-1===["string","function"].indexOf(typeof t.metrics.receiver)&&!Array.isArray(t.metrics.receiver))throw new Error(`The option "metrics.receiver" must be a null or a string or a function or an array of strings|functions, "${t.metrics.receiver}" passed.`);if(Array.isArray(t.metrics.receiver)){for(let e in t.metrics.receiver)if(-1===["string","function"].indexOf(typeof t.metrics.receiver[e]))throw new Error(`The option "metrics.receiver.${e}" must be a string or a function, "${t.metrics.receiver[e]}" passed.`)}else t.metrics.receiver=null!==t.metrics.receiver?[t.metrics.receiver]:[];if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.closing||"string"!=typeof t.closing.storage||"string"!=typeof t.closing.key||!Number.isInteger(t.closing.maxItems)||1>t.closing.maxItems)throw new Error(`The option "closing" must be an object of the format { storage: "memoryStorage"|"localStorage"|"sessionStorage", key: string, maxItems: integer<1, max> }, ${JSON.stringify(t.closing)} passed.`);return t}(t),this.#q=new me,this.#ke=new $(t.method,t.url,t.version,t.channel),this.#Le=new U(t.url,t.version,t.channel),this.#ie=new le(this.#q,ue.fromCurrentWindow(),new ve(t.template)),this.#Pe=new Ee(this.#ie,this.#q,t.interaction),this.#ve=xe.createFromReceivers(t.metrics.receiver),this.#$e=new Te(this.#ve,this.#q,t.channel),this.#Ue=new Ce({origin:t.url,connectionData:{extendedConfig:{interaction:t.interaction,metrics:{events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams}}},bannerManager:this.#ie,metricsSender:this.#ve}),this.#je=new fe({bannerManager:this.#ie,eventBus:this.#q,config:{storage:t.closing.storage,key:t.closing.key,maxItems:t.closing.maxItems},bannerFrameMessenger:this.#Ue}),this.setLocale(t.locale),this.#ke.origin=t.origin;for(let e in t.resources)this.#ke.addDefaultResource(e,t.resources[e]),this.#Le.addDefaultResource(e,t.resources[e]);window.addEventListener("resize",(()=>{const e=this.#ie.getBannersByState({state:this.#ie.STATE.RENDERED,managed:!0,external:!0,embed:!1});for(let t of e)t.redrawIfNeeded()})),this.#Ue.listen(),this.#$e.attach(new Ne({events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams})),this.#Pe.start(),this.#je.attachUi()}get version(){return this.#Ce}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#q.subscribe(e,t,n)}setLocale(e){this.#ke.locale=e,this.#Le.locale=e}setGateway(e){if(!function(e){return e instanceof u}(e))throw new TypeError("Argument gateway mut be instance of AbstractGateway.");this.#Fe=e}getGateway(){return null===this.#Fe&&this.setGateway(new F),this.#Fe}createBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"managed",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window;if(e=ne(e,s),"embed"===i){const i=this.#We(e,t,n,r),s=this.#ie.addEmbedBanner(e,i,t,r);return this.#Ue.connectBanner(s),e.insertAdjacentElement("beforeend",i),s}return this.#ie.addManagedBanner(e,t,n,r,s)}closeBanner(e,t){this.#je.closeBanner(e,t)}attachBanners(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;const n=e.querySelectorAll("[data-amp-banner]:not([data-amp-attached])");for(let e of n){const n=e.dataset.ampBanner;if(!n){console.warn("Unable to attach a banner to the element ",e,' because the attribute "data-amp-banner" has an empty value.');continue}let r;if("ampBannerExternal"in e.dataset)r=this.#ie.addExternalBanner(e,t);else{const i=se.parseResources(e),s=se.parseOptions(e),a=e.dataset.ampMode||"managed";r=this.createBanner(e,n,i,s,a,t)}this.#q.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:r})}}fetch(){const e=this.#ie.getBannersByState({state:this.#ie.STATE.NEW,managed:!0,external:!1,embed:!1});if(!e.length)return;const t=this.#ke.create();for(let n of e)t.addPosition(n.position,n.resources,"1"!==n.options.get("omit-default-resources","0").toString());this.#q.dispatch(this.EVENTS.ON_BEFORE_FETCH),this.getGateway().fetch(t,(t=>{const n=t.data;for(let t of e){if(!(t.position in n)||!("banners"in n[t.position])||!Object.values(n[t.position].banners).length){t.setState(this.#ie.STATE.NOT_FOUND,"Banner not found in fetched response.");continue}const e=n[t.position];if(this.#je.isPositionClosed(t.position))e.banners=[];else{const n=Array.isArray(e.banners)?e.banners:Object.values(e.banners),r=[];for(let e=0;e<n.length;e++){const i=n[e];i.id&&!this.#je.isBannerClosed(t.position,i.id)&&r.push(i)}e.banners=r}"embed"===e.mode&&0<e.banners.length?("options"in e&&t.overrideOptions(e.options),this.createBanner(t.element,t.position,t.rawResources,t.options.options,e.mode),this.#ie.removeBanner(t)):t.setResponseData(e)}this.#q.dispatch(this.EVENTS.ON_FETCH_SUCCESS,{response:t})}),(t=>{for(let t of e)t.setState(this.#ie.STATE.ERROR,"Request on api failed.");this.#q.dispatch(this.EVENTS.ON_FETCH_ERROR,{response:t})}))}#We(e,t,n,r){const i=document.createElement("iframe"),s=`cv=${encodeURIComponent(this.version.semver)}`,a=new Y(r);let o=e.dataset.ampEmbedSrc||this.#Le.create(t,n,a.options);o+=-1===o.indexOf("?")?`?${s}`:`&${s}`,i.width="100%",i.height="100%",i.allowFullscreen=!0,i.scrolling="no",i.style.border="none",i.style.overflow="hidden",i.style.background="transparent",i.style.visibility="hidden",i.setAttribute("allowtransparency","true");const c=a.evaluate("loading",0),l=a.evaluate("fetchpriority",0);return null!==c&&(i.loading=c),null!==l&&i.setAttribute("fetchpriority",l),[...e.attributes].map((e=>{let{name:t,value:n}=e;return t.startsWith("data-iframe-")&&i.setAttribute(t.substring(12),n)})),i.src=o,i}}const ke=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};function Le(e){const t=o({interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{events:{},params:{},extraParams:{}}},e);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=ke(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=ke(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { events: object, params: object }, ${JSON.stringify(t.metrics)} passed.`);if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);return t}class Fe extends Me{#He;#h;#f;#qe;constructor(e){let{clientEventBus:t,origin:n}=e;super({origins:void 0!==n?[n]:[]}),this.#He=t,this.#h=n,this.#f=null,this.#qe=[];const r={};r.connect=this.#Ge;const i={};i[H.ON_BANNER_STATE_CHANGED]=[this.#Ve,0],i[H.ON_BANNER_LINK_CLICKED]=[this.#Qe,-100];for(let e in i)this.#He.subscribe(e,i[e][0].bind(this),null,i[e][1]);for(let e in r)this.on(e,r[e].bind(this))}sendToParent(e,t){null!==this.#f?(t.uid=this.#f,this.send(window.parent,e,t,this.#h||"*")):this.#qe.push({message:e,data:t})}#Ge(e){let{data:t}=e;if(null!==this.#f)return void console.warn(`The frame is already connected to the parent under the UID ${this.#f}.`);const{uid:n}=t;let r;this.#f=n;const i=()=>{const e=document.body.scrollHeight;r!==e&&(r=e,this.sendToParent("adjustHeight",{height:e}))};i(),setInterval(i,100),this.#Ye()}#Ve(e){let{banner:t}=e;if(W.NEW===t.state)return;const n={state:t.state,stateInfo:t.stateInfo};1===t.stateCounter&&(n.positionData=t.positionData.toObject(),n.fingerprints=t.fingerprints.map((e=>e.value))),this.sendToParent("stateChanged",n)}#Qe(e){let{target:t,clickEvent:n}=e;n.preventDefault(),this.sendToParent("linkClicked",{href:t.href,target:t.target||null})}#Ye(){for(let e of this.#qe)this.sendToParent(e.message,e.data);this.#qe=[]}}class Pe{#Ce;#ze;#Je;#q;#ie;#Ue;#Pe;#je;#ve;#$e;#Ee;#Ke=null;constructor(e,t){this.EVENTS=H,this.#Ce=e,this.#ze=function(e){return o({channel:null},e)}(t),this.#Je=Le({}),this.#Je=null,this.#q=new me,this.#ie=new le(this.#q,new ue((()=>this.#Ke||document.documentElement.clientWidth||document.body.clientWidth))),this.#Ue=new Fe({clientEventBus:this.#q}),this.#je=new fe({bannerManager:this.#ie,eventBus:this.#q,parentFrameMessenger:this.#Ue}),this.#Ee=!1,this.#Pe=null,this.#ve=new xe([this.#Xe.bind(this)]),this.#$e=new Te(this.#ve,this.#q,this.#ze.channel),this.#Ue.on("connect",(e=>{let{data:t}=e;this.#Je=Le(t.extendedConfig),this.#Ke=t.windowWidth,this.#Pe=new Ee(this.#ie,this.#q,this.#Je.interaction),this.#Ze(),this.#$e.attach(new Ne(this.#Je.metrics)),this.#Pe.start()})),this.#Ue.on("windowResized",(e=>{let{data:t}=e;this.#Ke=t.windowWidth,this.#Ze()})),this.#Ue.listen(),this.#$e.collectBeforeAttach(),this.#je.attachUi()}get version(){return this.#Ce}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#q.subscribe(e,t,n)}attachBanner(){if(this.#Ee)throw new Error("Method attachBanner() should be called only once.");const e=document.querySelector("[data-amp-banner]:not([data-amp-attached])");if(!e)return void console.warn("No banner found in the embed client.");const t=this.#ie.addExternalBanner(e);this.#Ee=!0,this.#q.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:t})}#Xe(e,t){this.#Ue.sendToParent("metrics",{eventName:e,eventArgs:t})}#Ze(){for(let e of this.#ie.getBannersByState({state:W.RENDERED}))e.redrawIfNeeded()}}const je=s.rE;class $e{static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new De(new a(je,`standard@${je}`),e)}static createEmbed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Pe(new a(je,`embed@${je}`),e)}static get version(){return je}}AMPClientFactory=r.default})();