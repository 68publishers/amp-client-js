var AMPClientFactory;(()=>{"use strict";var e={9306:(e,t,n)=>{var r=n(4901),i=n(6823),a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(i(e)+" is not a function")}},3506:(e,t,n)=>{var r=n(3925),i=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a("Can't set "+i(e)+" as a prototype")}},679:(e,t,n)=>{var r=n(1625),i=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new i("Incorrect invocation")}},8551:(e,t,n)=>{var r=n(34),i=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(i(e)+" is not an object")}},9617:(e,t,n)=>{var r=n(5397),i=n(5610),a=n(6198),s=function(e){return function(t,n,s){var o=r(t),c=a(o);if(0===c)return!e&&-1;var l,u=i(s,c);if(e&&n!=n){for(;c>u;)if((l=o[u++])!=l)return!0}else for(;c>u;u++)if((e||u in o)&&o[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},4527:(e,t,n)=>{var r=n(3724),i=n(4376),a=TypeError,s=Object.getOwnPropertyDescriptor,o=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=o?function(e,t){if(i(e)&&!s(e,"length").writable)throw new a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},2195:(e,t,n)=>{var r=n(9504),i=r({}.toString),a=r("".slice);e.exports=function(e){return a(i(e),8,-1)}},6955:(e,t,n)=>{var r=n(2140),i=n(4901),a=n(2195),s=n(8227)("toStringTag"),o=Object,c="Arguments"===a(function(){return arguments}());e.exports=r?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=o(e),s))?n:c?a(t):"Object"===(r=a(t))&&i(t.callee)?"Arguments":r}},7740:(e,t,n)=>{var r=n(9297),i=n(5031),a=n(7347),s=n(4913);e.exports=function(e,t,n){for(var o=i(t),c=s.f,l=a.f,u=0;u<o.length;u++){var d=o[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},6699:(e,t,n)=>{var r=n(3724),i=n(4913),a=n(6980);e.exports=r?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},6980:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6840:(e,t,n)=>{var r=n(4901),i=n(4913),a=n(283),s=n(9433);e.exports=function(e,t,n,o){o||(o={});var c=o.enumerable,l=void 0!==o.name?o.name:t;if(r(n)&&a(n,l,o),o.global)c?e[t]=n:s(t,n);else{try{o.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},9433:(e,t,n)=>{var r=n(4576),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4606:(e,t,n)=>{var r=n(6823),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+r(t)+" of "+r(e))}},3724:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:(e,t,n)=>{var r=n(4576),i=n(34),a=r.document,s=i(a)&&i(a.createElement);e.exports=function(e){return s?a.createElement(e):{}}},6837:e=>{var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},5002:e=>{e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8727:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2839:(e,t,n)=>{var r=n(4576).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},9519:(e,t,n)=>{var r,i,a=n(4576),s=n(2839),o=a.process,c=a.Deno,l=o&&o.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},6193:(e,t,n)=>{var r=n(9504),i=Error,a=r("".replace),s=String(new i("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,c=o.test(s);e.exports=function(e,t){if(c&&"string"==typeof e&&!i.prepareStackTrace)for(;t--;)e=a(e,o,"");return e}},6518:(e,t,n)=>{var r=n(4576),i=n(7347).f,a=n(6699),s=n(6840),o=n(9433),c=n(7740),l=n(2796);e.exports=function(e,t){var n,u,d,h,p,f=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[f]||o(f,{}):r[f]&&r[f].prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(p=i(n,u))&&p.value:n[u],!l(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&a(h,"sham",!0),s(n,u,h,e)}}},9039:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},616:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9565:(e,t,n)=>{var r=n(616),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},350:(e,t,n)=>{var r=n(3724),i=n(9297),a=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,o=i(a,"name"),c=o&&"something"===function(){}.name,l=o&&(!r||r&&s(a,"name").configurable);e.exports={EXISTS:o,PROPER:c,CONFIGURABLE:l}},6706:(e,t,n)=>{var r=n(9504),i=n(9306);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},9504:(e,t,n)=>{var r=n(616),i=Function.prototype,a=i.call,s=r&&i.bind.bind(a,a);e.exports=r?s:function(e){return function(){return a.apply(e,arguments)}}},7751:(e,t,n)=>{var r=n(4576),i=n(4901);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},5966:(e,t,n)=>{var r=n(9306),i=n(4117);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},4576:function(e,t,n){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(e,t,n)=>{var r=n(9504),i=n(8981),a=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(i(e),t)}},421:e=>{e.exports={}},5917:(e,t,n)=>{var r=n(3724),i=n(9039),a=n(4055);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},7055:(e,t,n)=>{var r=n(9504),i=n(9039),a=n(2195),s=Object,o=r("".split);e.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"===a(e)?o(e,""):s(e)}:s},3167:(e,t,n)=>{var r=n(4901),i=n(34),a=n(2967);e.exports=function(e,t,n){var s,o;return a&&r(s=t.constructor)&&s!==n&&i(o=s.prototype)&&o!==n.prototype&&a(e,o),e}},3706:(e,t,n)=>{var r=n(9504),i=n(4901),a=n(7629),s=r(Function.toString);i(a.inspectSource)||(a.inspectSource=function(e){return s(e)}),e.exports=a.inspectSource},1181:(e,t,n)=>{var r,i,a,s=n(8622),o=n(4576),c=n(34),l=n(6699),u=n(9297),d=n(7629),h=n(6119),p=n(421),f="Object already initialized",m=o.TypeError,g=o.WeakMap;if(s||d.state){var b=d.state||(d.state=new g);b.get=b.get,b.has=b.has,b.set=b.set,r=function(e,t){if(b.has(e))throw new m(f);return t.facade=e,b.set(e,t),t},i=function(e){return b.get(e)||{}},a=function(e){return b.has(e)}}else{var v=h("state");p[v]=!0,r=function(e,t){if(u(e,v))throw new m(f);return t.facade=e,l(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},a=function(e){return u(e,v)}}e.exports={set:r,get:i,has:a,enforce:function(e){return a(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},4376:(e,t,n)=>{var r=n(2195);e.exports=Array.isArray||function(e){return"Array"===r(e)}},4901:e=>{var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},2796:(e,t,n)=>{var r=n(9039),i=n(4901),a=/#|\.prototype\./,s=function(e,t){var n=c[o(e)];return n===u||n!==l&&(i(t)?r(t):!!t)},o=s.normalize=function(e){return String(e).replace(a,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},4117:e=>{e.exports=function(e){return null==e}},34:(e,t,n)=>{var r=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},3925:(e,t,n)=>{var r=n(34);e.exports=function(e){return r(e)||null===e}},6395:e=>{e.exports=!1},757:(e,t,n)=>{var r=n(7751),i=n(4901),a=n(1625),s=n(7040),o=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&a(t.prototype,o(e))}},6198:(e,t,n)=>{var r=n(8014);e.exports=function(e){return r(e.length)}},283:(e,t,n)=>{var r=n(9504),i=n(9039),a=n(4901),s=n(9297),o=n(3724),c=n(350).CONFIGURABLE,l=n(3706),u=n(1181),d=u.enforce,h=u.get,p=String,f=Object.defineProperty,m=r("".slice),g=r("".replace),b=r([].join),v=o&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),E=String(String).split("String"),y=e.exports=function(e,t,n){"Symbol("===m(p(t),0,7)&&(t="["+g(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||c&&e.name!==t)&&(o?f(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&s(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?o&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return s(r,"source")||(r.source=b(E,"string"==typeof t?t:"")),e};Function.prototype.toString=y((function(){return a(this)&&h(this).source||l(this)}),"toString")},741:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},2603:(e,t,n)=>{var r=n(655);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},4913:(e,t,n)=>{var r=n(3724),i=n(5917),a=n(8686),s=n(8551),o=n(6969),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=r?a?function(e,t,n){if(s(e),t=o(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(s(e),t=o(t),s(n),i)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},7347:(e,t,n)=>{var r=n(3724),i=n(9565),a=n(8773),s=n(6980),o=n(5397),c=n(6969),l=n(9297),u=n(5917),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=o(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return s(!i(a.f,e,t),e[t])}},8480:(e,t,n)=>{var r=n(1828),i=n(8727).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},3717:(e,t)=>{t.f=Object.getOwnPropertySymbols},1625:(e,t,n)=>{var r=n(9504);e.exports=r({}.isPrototypeOf)},1828:(e,t,n)=>{var r=n(9504),i=n(9297),a=n(5397),s=n(9617).indexOf,o=n(421),c=r([].push);e.exports=function(e,t){var n,r=a(e),l=0,u=[];for(n in r)!i(o,n)&&i(r,n)&&c(u,n);for(;t.length>l;)i(r,n=t[l++])&&(~s(u,n)||c(u,n));return u}},8773:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2967:(e,t,n)=>{var r=n(6706),i=n(34),a=n(7750),s=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return a(n),s(r),i(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},4270:(e,t,n)=>{var r=n(9565),i=n(4901),a=n(34),s=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&i(n=e.toString)&&!a(o=r(n,e)))return o;if(i(n=e.valueOf)&&!a(o=r(n,e)))return o;if("string"!==t&&i(n=e.toString)&&!a(o=r(n,e)))return o;throw new s("Can't convert object to primitive value")}},5031:(e,t,n)=>{var r=n(7751),i=n(9504),a=n(8480),s=n(3717),o=n(8551),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=a.f(o(e)),n=s.f;return n?c(t,n(e)):t}},7750:(e,t,n)=>{var r=n(4117),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},6119:(e,t,n)=>{var r=n(5745),i=n(3392),a=r("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},7629:(e,t,n)=>{var r=n(6395),i=n(4576),a=n(9433),s="__core-js_shared__",o=e.exports=i[s]||a(s,{});(o.versions||(o.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(e,t,n)=>{var r=n(7629);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},4495:(e,t,n)=>{var r=n(9519),i=n(9039),a=n(4576).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},5610:(e,t,n)=>{var r=n(1291),i=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):a(n,t)}},5397:(e,t,n)=>{var r=n(7055),i=n(7750);e.exports=function(e){return r(i(e))}},1291:(e,t,n)=>{var r=n(741);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},8014:(e,t,n)=>{var r=n(1291),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8981:(e,t,n)=>{var r=n(7750),i=Object;e.exports=function(e){return i(r(e))}},2777:(e,t,n)=>{var r=n(9565),i=n(34),a=n(757),s=n(5966),o=n(4270),c=n(8227),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!i(e)||a(e))return e;var n,c=s(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!i(n)||a(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},6969:(e,t,n)=>{var r=n(2777),i=n(757);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2140:(e,t,n)=>{var r={};r[n(8227)("toStringTag")]="z",e.exports="[object z]"===String(r)},655:(e,t,n)=>{var r=n(6955),i=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},6823:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},3392:(e,t,n)=>{var r=n(9504),i=0,a=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+a,36)}},7040:(e,t,n)=>{var r=n(4495);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(e,t,n)=>{var r=n(3724),i=n(9039);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(e,t,n)=>{var r=n(4576),i=n(4901),a=r.WeakMap;e.exports=i(a)&&/native code/.test(String(a))},8227:(e,t,n)=>{var r=n(4576),i=n(5745),a=n(9297),s=n(3392),o=n(4495),c=n(7040),l=r.Symbol,u=i("wks"),d=c?l.for||l:l&&l.withoutSetter||s;e.exports=function(e){return a(u,e)||(u[e]=o&&a(l,e)?l[e]:d("Symbol."+e)),u[e]}},4114:(e,t,n)=>{var r=n(6518),i=n(8981),a=n(6198),s=n(4527),o=n(6837);r({target:"Array",proto:!0,arity:1,forced:n(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=i(this),n=a(t),r=arguments.length;o(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return s(t,n),n}})},3609:(e,t,n)=>{var r=n(6518),i=n(8981),a=n(6198),s=n(4527),o=n(4606),c=n(6837);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=i(this),n=a(t),r=arguments.length;if(r){c(n+r);for(var l=n;l--;){var u=l+r;l in t?t[u]=t[l]:o(t,u)}for(var d=0;d<r;d++)t[d]=arguments[d]}return s(t,n+r)}})},4979:(e,t,n)=>{var r=n(6518),i=n(4576),a=n(7751),s=n(6980),o=n(4913).f,c=n(9297),l=n(679),u=n(3167),d=n(2603),h=n(5002),p=n(6193),f=n(3724),m=n(6395),g="DOMException",b=a("Error"),v=a(g),E=function(){l(this,y);var e=arguments.length,t=d(e<1?void 0:arguments[0]),n=d(e<2?void 0:arguments[1],"Error"),r=new v(t,n),i=new b(t);return i.name=g,o(r,"stack",s(1,p(i.stack,1))),u(r,this,E),r},y=E.prototype=v.prototype,w="stack"in new b(g),T="stack"in new v(1,2),N=v&&f&&Object.getOwnPropertyDescriptor(i,g),R=!(!N||N.writable&&N.configurable),S=w&&!R&&!T;r({global:!0,constructor:!0,forced:m||S},{DOMException:S?E:v});var _=a(g),B=_.prototype;if(B.constructor!==_)for(var A in m||o(B,"constructor",s(1,_)),h)if(c(h,A)){var I=h[A],O=I.s;c(_,O)||o(_,O,s(6,I.c))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.d(r,{default:()=>Pe});var i={};n.r(i),n.d(i,{exclude:()=>L,extract:()=>I,parse:()=>O,parseUrl:()=>M,pick:()=>x,stringify:()=>D,stringifyUrl:()=>C});const a=JSON.parse('{"rE":"1.8.0-beta.0"}');class s{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get semver(){return this.#e}get full(){return this.#t}}n(4114);const o=_.merge,c={single:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--single"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',random:'\n    <% if(null !== data.content) { %>\n        <div class="amp-banner amp-banner--random"\n             data-amp-banner-fingerprint="<%= data.fingerprint %>">\n    \n            <% if(\'img\' === data.content.type) { %>\n                <a class="amp-banner__content amp-banner__content--img"\n                   href="<%= data.content.href %>"\n                   <% if(null !== data.content.target) { %>target="<%- data.content.target %>"<% } %>>\n                    <picture>\n                        <% (data.content.sources || []).forEach(function(source) { %>\n                            <source type="<%= source.type %>"\n                                    srcset="<%= source.srcset %>"\n                                    sizes="<%- data.content.sizes %>">\n                        <% }); %>\n                        <img srcset="<%= data.content.srcset %>"\n                             src="<%= data.content.src %>"\n                             sizes="<%- data.content.sizes %>"\n                             alt="<%- data.content.alt %>"\n                             <% if(null !== data.content.dimensions.width) { %>width="<%- data.content.dimensions.width %>"<% } %>\n                             <% if(null !== data.content.dimensions.height) { %>height="<%- data.content.dimensions.height %>"<% } %>\n                             <% if(\'\' !== data.content.title) { %>title="<%- data.content.title %>"<% } %>\n                             <% var loading; if(loading = banner.options.evaluate(\'loading\', 0)) { %>loading="<%- loading %>"<% } %>\n                             <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', 0)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                    </picture>\n                </a>\n            <% } else if (\'html\' === data.content.type) { %>\n                <div class="amp-banner__content amp-banner__content--html">\n                    <%= data.content.html %>\n                </div>\n            <% } %>\n    \n        </div>\n    <% } %>\n',multiple:'\n    <% if(data.length) { %>\n        <div class="amp-banner amp-banner--multiple">\n            <div class="amp-banner__list">\n                <% for (index in data) { var b = data[index]; %>\n                    <div class="amp-banner__item"\n                         data-amp-banner-fingerprint="<%= b.fingerprint %>">\n    \n                        <% if(\'img\' === b.content.type) { %>\n                            <a class="amp-banner__content amp-banner__content--img"\n                               href="<%= b.content.href %>"\n                               <% if(null !== b.content.target) { %>target="<%- b.content.target %>"<% } %>>\n                                <picture>\n                                    <% (b.content.sources || []).forEach(function(source) { %>\n                                        <source type="<%= source.type %>"\n                                                srcset="<%= source.srcset %>"\n                                                sizes="<%- b.content.sizes %>">\n                                    <% }); %>\n                                    <img srcset="<%= b.content.srcset %>"\n                                         src="<%= b.content.src %>"\n                                         sizes="<%- b.content.sizes %>"\n                                         alt="<%- b.content.alt %>"\n                                         <% if(null !== b.content.dimensions.width) { %>width="<%- b.content.dimensions.width %>"<% } %>\n                                         <% if(null !== b.content.dimensions.height) { %>height="<%- b.content.dimensions.height %>"<% } %>\n                                         <% if(\'\' !== b.content.title) { %>title="<%- b.content.title %>"<% } %>\n                                         <% var loading; if(loading = banner.options.evaluate(\'loading\', index)) { %>loading="<%- loading %>"<% } %>\n                                         <% var fetchPriority; if(fetchPriority = banner.options.evaluate(\'fetchpriority\', index)) { %>fetchpriority="<%- fetchPriority %>"<% } %>>\n                                </picture>\n                            </a>\n                        <% } else if (\'html\' === b.content.type) { %>\n                            <div class="amp-banner__content amp-banner__content--html">\n                                <%= b.content.html %>\n                            </div>\n                        <% } %>\n    \n                    </div>\n                <% } %>\n            </div>\n        </div>\n    <% } %>\n'},l=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};class u{constructor(){if(this.constructor===u)throw new TypeError("Can not construct abstract class AbstractGateway.");if(this.fetch===u.prototype.fetch)throw new TypeError("Please implement abstract method ::fetch().")}fetch(e,t){throw new TypeError("Do not call abstract method ::fetch() from child.")}}const d="%[a-f0-9]{2}",h=new RegExp("("+d+")|([^%]+?)","gi"),p=new RegExp("("+d+")+","gi");function f(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],f(n),f(r))}function m(e){try{return decodeURIComponent(e)}catch{let t=e.match(h)||[];for(let n=1;n<t.length;n++)t=(e=f(t,n).join("")).match(h)||[];return e}}function g(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"��","%FF%FE":"��"};let n=p.exec(e);for(;n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{const e=m(n[0]);e!==n[0]&&(t[n[0]]=e)}n=p.exec(e)}t["%C2"]="�";const r=Object.keys(t);for(const n of r)e=e.replace(new RegExp(n,"g"),t[n]);return e}(e)}}function b(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const n=e.indexOf(t);return-1===n?[]:[e.slice(0,n),e.slice(n+t.length)]}function v(e,t){const n={};if(Array.isArray(t))for(const r of t){const t=Object.getOwnPropertyDescriptor(e,r);t?.enumerable&&Object.defineProperty(n,r,t)}else for(const r of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){t(r,e[r],e)&&Object.defineProperty(n,r,i)}}return n}const E=e=>null==e,y=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)),w=Symbol("encodeFragmentIdentifier");function T(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function N(e,t){return t.encode?t.strict?y(e):encodeURIComponent(e):e}function R(e,t){return t.decode?g(e):e}function S(e){return Array.isArray(e)?e.sort():"object"==typeof e?S(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function B(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function A(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function I(e){const t=(e=B(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function O(e,t){T((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...t}).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),a="string"==typeof n&&!i&&R(n,e).includes(e.arrayFormatSeparator);n=a?R(n,e):n;const s=i||a?n.split(e.arrayFormatSeparator).map((t=>R(t,e))):null===n?n:R(n,e);r[t]=s};case"bracket-separator":return(t,n,r)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i)return void(r[t]=n?R(n,e):n);const a=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>R(t,e)));void 0!==r[t]?r[t]=[...r[t],...a]:r[t]=a};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[...[n[e]].flat(),t]:n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){if(""===i)continue;const e=t.decode?i.replace(/\+/g," "):i;let[a,s]=b(e,"=");void 0===a&&(a=e),s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:R(s,t),n(R(a,t),s,r)}for(const[e,n]of Object.entries(r))if("object"==typeof n&&null!==n)for(const[e,r]of Object.entries(n))n[e]=A(r,t);else r[e]=A(n,t);return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=S(n):e[t]=n,e}),Object.create(null))}function D(e,t){if(!e)return"";T((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const n=n=>t.skipNull&&E(e[n])||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[N(t,e),"[",i,"]"].join("")]:[...n,[N(t,e),"[",N(i,e),"]=",N(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[N(t,e),"[]"].join("")]:[...n,[N(t,e),"[]=",N(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[N(t,e),":list="].join("")]:[...n,[N(t,e),":list=",N(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length?[[N(n,e),t,N(i,e)].join("")]:[[r,N(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,N(t,e)]:[...n,[N(t,e),"=",N(r,e)].join("")]}}(t),i={};for(const[t,r]of Object.entries(e))n(t)||(i[t]=r);const a=Object.keys(i);return!1!==t.sort&&a.sort(t.sort),a.map((n=>{const i=e[n];return void 0===i?"":null===i?N(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?N(n,t)+"[]":i.reduce(r(n),[]).join("&"):N(n,t)+"="+N(i,t)})).filter((e=>e.length>0)).join("&")}function M(e,t){t={decode:!0,...t};let[n,r]=b(e,"#");return void 0===n&&(n=e),{url:n?.split("?")?.[0]??"",query:O(I(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:R(r,t)}:{}}}function C(e,t){t={encode:!0,strict:!0,[w]:!0,...t};const n=B(e.url).split("?")[0]||"";let r=D({...O(I(e.url),{sort:!1}),...e.query},t);r&&(r=`?${r}`);let i=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);if(e.fragmentIdentifier){const r=new URL(n);r.hash=e.fragmentIdentifier,i=t[w]?r.hash:`#${e.fragmentIdentifier}`}return`${n}${r}${i}`}function x(e,t,n){n={parseFragmentIdentifier:!0,[w]:!1,...n};const{url:r,query:i,fragmentIdentifier:a}=M(e,n);return C({url:r,query:v(i,t),fragmentIdentifier:a},n)}function L(e,t,n){return x(e,Array.isArray(t)?e=>!t.includes(e):(e,n)=>!t(e,n),n)}const k=i;class P extends u{fetch(e,t,n){const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(XMLHttpRequest.DONE!==r.readyState||0===r.status)return!1;const e=JSON.parse(r.responseText);200<=r.status&&300>r.status?t(e):n(e)},r.onerror=()=>{n({status:"error",data:{code:r.status,error:r.statusText||"unknown"}})};let i=e.endpoint;"GET"===e.method&&(i+=`?${k.stringify(e.parameters)}`),r.open(e.method,i,!0),r.overrideMimeType("application/json"),r.setRequestHeader("Accept","application/json");for(let t of e.headers)r.setRequestHeader(t.name,t.value);r.send("POST"===e.method?JSON.stringify(e.parameters):null)}}class F{#n;#r;constructor(e,t){this.#n=e,this.#r=this.#i(t)}get name(){return this.#n}get value(){return this.#r}withValues(e){return new F(this.name,this.#i(e).concat(this.value).filter(((e,t,n)=>n.indexOf(e)===t)))}#i(e){return Array.isArray(e)?e:[e]}}class j{#a;#s;#o;#c;#l;#u;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.#a=e,this.#s=t,this.#o=n,this.#c={},this.#l=r,this.#u=i}addPosition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.#c;if(e in r)throw new Error('Position "'+e+'" already exists.');r[e]={},n&&this.addPositionResources(e,this.#l),this.addPositionResources(e,t)}addPositionResources(e,t){for(let n in t)this.addPositionResource(e,t[n])}addPositionResource(e,t){if(!(t instanceof F))throw new TypeError("Argument resource must be instance of Resource class.");const n=this.#c;if(!(e in n))throw new Error('Missing position "'+e+'".');const r=n[e];t.name in r?r[t.name]=r[t.name].withValues(t.value):r[t.name]=t}get method(){return this.#a}get endpoint(){return this.#s}get locale(){return this.#o}get parameters(){const e=this.#d(this.#c),t={query:"GET"===this.method?JSON.stringify(e):e};return null!==this.locale&&(t.locale=this.locale),t}get headers(){return this.#u}#d=e=>{const t={};for(let n in e){t[n]={};for(let r in e[n]){const i=e[n][r].value.filter((e=>""!==e));i.length&&(t[n][r]=i)}}return t}}class ${#a;#s;#o;#l;#h;constructor(e,t,n,r){this.#a=e,this.#s=`${t}/api/v${n}/content/${encodeURIComponent(r)}`,this.#o=null,this.#l=[],this.#h=null}set locale(e){this.#o=e}set origin(e){this.#h=e}addDefaultResource(e,t){this.#l.push(new F(e,t))}create(){const e=[];return"string"==typeof this.#h&&""!==this.#h&&e.push({name:"X-Amp-Origin",value:this.#h}),new j(this.#a,this.#s,this.#o,this.#l,e)}}class U{#s;#o;#l;constructor(e,t,n){this.#s=`${e}/api/v${t}/preview/position/${encodeURIComponent(n)}`,this.#o=null,this.#l={}}set locale(e){this.#o=e}addDefaultResource(e,t){const n=this.#l,r=new F(e,t);r.name in n?n[r.name]=n[r.name].withValues(r.value):n[r.name]=r}create(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"1"!==(r["omit-default-resources"]||"0").toString()?t={...this.#l}:(t={},delete r["omit-default-resources"]);for(let e in n){const r=new F(e,n[e]);r.name in t?t[r.name]=t[r.name].withValues(r.value):t[r.name]=r}let i={};for(let e in t){t[e].value.filter((e=>""!==e)).length&&(i[e]=t[e].value)}i=JSON.stringify(i);const a=JSON.stringify(r),s={};"{}"!==i&&(s.resources=i),"{}"!==a&&(s.options=a),null!==this.#o&&(s.locale=this.#o);const o=k.stringify(s);return`${this.#s}/${encodeURIComponent(e)}${""!==o?"?"+o:""}`}}class W{static get NEW(){return"NEW"}static get RENDERED(){return"RENDERED"}static get NOT_FOUND(){return"NOT_FOUND"}static get ERROR(){return"ERROR"}static get CLOSED(){return"CLOSED"}static get STATES(){return[W.NEW,W.RENDERED,W.NOT_FOUND,W.ERROR,W.CLOSED]}}class H{static get ON_BANNER_ATTACHED(){return"amp:banner:attached"}static get ON_BANNER_STATE_CHANGED(){return"amp:banner:state-changed"}static get ON_BANNER_INTERSECTION_CHANGED(){return"amp:banner:intersection-changed"}static get ON_BANNER_FIRST_TIME_SEEN(){return"amp:banner:first-time-seen"}static get ON_BANNER_FIRST_TIME_FULLY_SEEN(){return"amp:banner:first-time-fully-seen"}static get ON_BANNER_LINK_CLICKED(){return"amp:banner:link-clicked"}static get ON_BANNER_BEFORE_CLOSE(){return"amp:banner:before-close"}static get ON_BANNER_AFTER_CLOSE(){return"amp:banner:after-close"}static get ON_BANNER_MUTATED(){return"amp:banner:mutated"}static get ON_BEFORE_FETCH(){return"amp:fetch:before"}static get ON_FETCH_ERROR(){return"amp:fetch:error"}static get ON_FETCH_SUCCESS(){return"amp:fetch:success"}}class q{constructor(e){let{id:t,code:n,name:r,rotationSeconds:i,displayType:a,breakpointType:s}=e;this.id=t,this.code=n,this.name=r,this.rotationSeconds=i,this.displayType=a,this.breakpointType=s}static createInitial(e){return new q({id:null,code:e,name:null,rotationSeconds:0,displayType:null,breakpointType:null})}isSingle(){return"single"===this.displayType}isRandom(){return"random"===this.displayType}isMultiple(){return"multiple"===this.displayType}toObject(){return{id:this.id,code:this.code,name:this.name,rotationSeconds:this.rotationSeconds,displayType:this.displayType,breakpointType:this.breakpointType}}}const V=/^(?:(?<INTERVAL_FROM>\d+)-(?<INTERVAL_TO>\d+):|(?<EQ>\d+):|<(?<LT>\d+):|<=(?<LTE>\d+):|>(?<GT>\d+):|>=(?<GTE>\d+):)?(?<VALUE>[^:\s]+)$/,G={};function Q(e,t){const n=function(e){if(e in G)return G[e];const t=e.split(",").map((e=>e.trim())),n=[];for(let e=0;e<t.length;e++){const r=t[e].match(V);if(null===r||void 0===r.groups||void 0===r.groups.VALUE)continue;let i;switch(!0){case void 0!==r.groups.INTERVAL_FROM&&void 0!==r.groups.INTERVAL_TO:i={from:parseInt(r.groups.INTERVAL_FROM),to:parseInt(r.groups.INTERVAL_TO),matches:function(e){return e>=this.from&&e<=this.to}};break;case void 0!==r.groups.EQ:i={eq:parseInt(r.groups.EQ),matches:function(e){return e===this.eq}};break;case void 0!==r.groups.LT:i={lt:parseInt(r.groups.LT),matches:function(e){return e<this.lt}};break;case void 0!==r.groups.LTE:i={lte:parseInt(r.groups.LTE),matches:function(e){return e<=this.lte}};break;case void 0!==r.groups.GT:i={gt:parseInt(r.groups.GT),matches:function(e){return e>this.gt}};break;case void 0!==r.groups.GTE:i={gte:parseInt(r.groups.GTE),matches:function(e){return e>=this.gte}};break;default:i={matches:function(){return!0}}}i&&(i.matches=i.matches.bind(i),i.value=r.groups.VALUE,n.push(i))}const r={rules:n,cache:{}};return r.evaluate=function(e){Number.isInteger(e)||(e=parseInt(e));const t=`i_${e}`;if(t in this.cache)return this.cache[t];for(let n=0;n<this.rules.length;n++){const r=this.rules[n];if(r.matches(e))return this.cache[t]=r.value}return this.cache[t]=null}.bind(r),G[e]=r,r}(e);return n.evaluate(t)}class Y{constructor(e){this.options={},this.options=this.#p({...e})}has(e){return void 0!==this.options[e]}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.options[e]||t}evaluate(e,t){return void 0===this.options[e]?null:Q(this.options[e],t)}override(e){this.options={...this.options,...this.#p({...e})}}#p(e){if("loading-offset"in e){const t=e["loading-offset"],n="loading"in e?e.loading:"loading"in this.options?this.options.loading:null,r=null!==n?`>=${t}:${n}`:null;let i='AMP deprecation warning: The banner option "loading-offset" is deprecated and will be removed in some future release.';null!==r&&(i+=` Instead of options {"loading": "${n}", "loading-offset": "${t}"} use an expression based option {"loading": "${r}"}.`),console.warn(i),delete e["loading-offset"],null!==r&&(e.loading=r)}return e}}class z{#f;#m;#g;#b=null;#v=null;#E={};constructor(e,t,n,r,i){if(this.constructor===z)throw new TypeError("Can not construct abstract class Banner.");this.#f=t,this.#m=n,this.#g=new Y(i),this._eventBus=e,this._positionData=q.createInitial(r),this.STATE=W}get uid(){return this.#f}get element(){return this.#m}get state(){return this.#b}get stateInfo(){return this.#v}get stateCounter(){return this.#E[this.state]||0}get position(){return this.positionData.code}get positionData(){return this._positionData}get options(){return this.#g}get fingerprints(){return[]}unsetFingerprint(e){}setState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(-1===this.STATE.STATES.indexOf(e))throw new TypeError(`${e} is not valid state.`);this.#b=e,this.#v=t.toString(),this.#E[e]=(this.#E[e]||0)+1,this._eventBus.dispatch(H.ON_BANNER_STATE_CHANGED,{banner:this})}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.startsWith("amp:banner:"))throw new Error(`Unable to attach listener on event "${e}" through a banner.`);return this._eventBus.subscribe(e,(function(e){const{banner:r}=e;r===this&&(null!==n?t.call(n,e):t(e))}),this)}getCurrentBreakpoint(e){return null}overrideOptions(e){this.#g.override(e)}redrawIfNeeded(){}isManaged(){return!1}isExternal(){return!1}isEmbed(){return!1}}n(4979);class K{constructor(e,t){let{bannerId:n,bannerName:r,positionId:i,positionCode:a,positionName:s,campaignId:o,campaignCode:c,campaignName:l}=t;this.value=e,this.bannerId=n,this.bannerName=r,this.positionId=i,this.positionCode=a,this.positionName=s,this.campaignId=o,this.campaignCode=c,this.campaignName=l}static createFromProperties(e){return new K(btoa(encodeURIComponent(JSON.stringify(e))),e)}static createFromValue(e){return new K(e,JSON.parse(decodeURIComponent(atob(e))))}toString(){return this.value}}n(3609);class J{#y;#w;constructor(e,t){this.#y=e,this.#w=t}get breakpoint(){return this.#y}get data(){return this.#w}}class X{#T;#N;#R=[];#S=void 0;#_={min:null,max:null,reset:function(){this.min=this.max=null}};constructor(e,t){this.#T=e,this.#N=t}addContent(e,t){this.#R.push(new J(e,t)),this.#S=void 0}get contents(){return this.#R}get content(){if(void 0!==this.#S&&!this.needRedraw())return this.#S;this.#_.reset();const e=this.#T.width,t=this.#N;let n=null,r=null,i=null;const a=[];this.#B(this.#R,(s=>{let o=s.breakpoint;null!==o?(a.push(o),("min"===t&&e>=o&&(null===i||i<o)||"max"===t&&e<=o&&(null===i||i>o))&&(r=s,i=o,this.#_[t]=o)):n=s})),a.sort(((e,t)=>e-t)),"min"===t?a.unshift(null):a.push(null);const s=a.indexOf(i);return"max"===t&&s-1 in a&&(this.#_.min=a[s-1]),"min"===t&&s+1 in a&&(this.#_.max=a[s+1]),this.#S=null!==r?r:n}needRedraw(){if(void 0===this.#S)return!0;const e=this.#T.width;return null!==this.#_.min&&e<this.#_.min||null!==this.#_.max&&e>this.#_.max}#B(e,t){for(let n in e)t(e[n],n)}}class Z{#w;#R;#A=null;constructor(e,t,n){this.#w=e,this.#R=new X(n,t);for(let e of this.#w.contents)"img"!==e.type||"dimensions"in e||(e.dimensions={width:null,height:null}),this.#R.addContent(e.breakpoint,e)}set fingerprint(e){if(!(e instanceof K))throw new TypeError("The value must be instance of Fingerprint object.");this.#A=e}get fingerprint(){return this.#A}get id(){return this.#w.id}get name(){return this.#w.name||null}get score(){return this.#w.score}get campaign(){return console.warn("Usage of deprecated property `BannerData.campaign`. Please use property `campaignCode` instead."),this.campaignCode()}get campaignId(){return this.#w.campaign_id||null}get campaignCode(){return this.#w.campaign_code||this.#w.campaign||null}get campaignName(){return this.#w.campaign_name||null}get content(){return this.#R.content?.data||null}needRedraw(){return this.#R.needRedraw()}}class ee{#I;constructor(e){this.#I=e}get positionCode(){return this.#I.positionData.code}get rotationSeconds(){return this.#I.positionData.rotationSeconds}get displayType(){return this.#I.positionData.displayType}get breakpointType(){return this.#I.positionData.breakpointType}get fingerprints(){return this.#I.fingerprints}get bannerData(){return this.#I.bannerData}}class te{static randomByWeights(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"weight";const n={};let r=0;for(let n=0;n<e.length;n++)r+=e[n][t];for(let i=0;i<e.length;i++)n[i]=e[i][t]/r;let i=0,a=Math.random();for(;a>0;)a-=n[i],i++;return i--,e[i]?e[i]:e[0]}}class ne extends z{#T;#O;#D=[];#M;#C=!1;#x=null;#L=[];constructor(e,t,n,r,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};super(n,r,i,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:{}),this.#T=e,this.#O=t,this.#M=s;for(let e in s)this.#D.push(new F(e,s[e]));this.setState(this.STATE.NEW,"Banner created.")}set html(e){this.element.innerHTML=e}get resources(){return this.#D}get rawResources(){return this.#M}get data(){return console.warn("Usage of deprecated property `ManagedBanner.data`. Please use property `positionData` for accessing information about a position."),new ee(this)}get fingerprints(){let e;try{e=this.bannerData}catch(e){return[]}return null===e?[]:(this.positionData.isMultiple()||(e=[e]),e.map((e=>e.fingerprint)))}get bannerData(){if(null!==this.#x)return this.#x;if(!this.#L.length)return null;let e=null;const t=this.positionData,n=e=>K.createFromProperties({bannerId:e.id,bannerName:e.name,positionId:t.id,positionCode:t.code,positionName:t.name,campaignId:e.campaignId,campaignCode:e.campaignCode,campaignName:e.campaignName});switch(!0){case t.isSingle():e=this.#L.reduce(((e,t)=>e.score>=t.score?e:t)),e.fingerprint=n(e);break;case t.isRandom():e=te.randomByWeights(this.#L,"score"),e.fingerprint=n(e);break;case t.isMultiple():e=this.#L.sort(((e,t)=>t.score-e.score));for(let t of e)t.fingerprint=n(t);break;default:throw new Error(`Invalid display type ${this.displayType}.`)}return this.#x=e,e}unsetFingerprint(e){const t=e.bannerId,n=this.positionData;if(!!this.#L.filter((e=>e.id===t))[0]){switch(!0){case n.isSingle():this.#L=[],this.#x=null;break;case n.isRandom():this.#x&&this.#x.id===t?(this.#L=[],this.#x=null):this.#L=this.#L.filter((e=>e.id!==t));break;case n.isMultiple():this.#L=this.#L.filter((e=>e.id!==t)),this.#x&&(this.#x=this.#x.filter((e=>e.id!==t)))}0>=this.#L.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):n.isRandom()&&this.redrawIfNeeded()}}setResponseData(e){if(this.#C)throw new Error(`Data for banner on position ${this.position} is already set.`);this._positionData=new q({id:e.position_id||null,code:this._positionData.code,name:e.position_name||null,rotationSeconds:e.rotation_seconds,displayType:e.display_type,breakpointType:e.breakpoint_type}),"options"in e&&this.overrideOptions(e.options);const t=[];for(let n in e.banners||[])t.push(new Z(e.banners[n],e.breakpoint_type,this.#T));this.#L=t,this.#C=!0,0>=this.#L.length?this.setState(this.STATE.CLOSED,"Banner has empty data."):this.#k("Banner was successfully rendered.")}getCurrentBreakpoint(e){let t=this.bannerData;t=(Array.isArray(t)?t:t?[t]:[]).find((t=>t.id===e));const n=t&&t.content?t.content.breakpoint:null;return null===n?null:parseInt(n)}isManaged(){return!0}redrawIfNeeded(){this.#P()&&this.#k("Banner was successfully redrawn.")}#k(e){try{this.html=this.#O.render(this)}catch(e){return void this.setState(this.STATE.ERROR,"Render error: "+e.message)}this.setState(this.STATE.RENDERED,e)}#P(){let e=this.bannerData;Array.isArray(e)||(e=[e]);for(let t in e)if(e[t].needRedraw())return!0;return!1}}class re{static parseResources(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-resource-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(18)]=e.value.split(",").map((e=>e.trim())));return t}static parseOptions(e){const t={},n=[].filter.call(e.attributes,(e=>/^data-amp-option-\S+/.test(e.name)));for(let e of n)e.value&&(t[e.name.slice(16)]=e.value.trim());return t}}class ie extends z{#F=[];#j={};#$=null;constructor(e,t,n,r){if(!("ampBannerExternal"in r.dataset))throw new Error('Unable to initialize ExternalBanner from element that does not have an attribute "data-amp-external".');const i=JSON.parse(decodeURIComponent(atob(r.dataset.ampBannerExternal)));if(!("state"in i)||!("positionData"in i))throw new Error('Unable to initialize ExternalBanner data attribute "data-amp-external" is malformed.');const a=i.state,s=new q(i.positionData),o=re.parseOptions(r);super(t,n,r,s.code,o);const c=[],l={},u=r.cloneNode(!0),d=u.querySelectorAll("[data-amp-banner-fingerprint]"),h=d.item(0)?.parentElement;let p=h;for(;null!==p&&p!==u&&p.parentElement!==u;)p=p.parentElement;for(let t of d){const n=K.createFromValue(t.dataset.ampBannerFingerprint);c.push(n);for(let r of t.querySelectorAll("[data-amp-content-breakpoint]")){let i=r.dataset.ampContentBreakpoint;i="default"===i?null:parseInt(i),n.bannerId in l||(l[n.bannerId]=new X(e,s.breakpointType));const a=t.cloneNode(!1);a.insertAdjacentElement("afterbegin",r),l[n.bannerId].addContent(i,{html:a.outerHTML})}}h&&(h.dataset.ampBannerList="true"),h&&(h.innerHTML=""),this._positionData=s,this.#F=c,this.#j=l,this.#$=p,this.#U(!1),this.setState(a.value,a.info)}get fingerprints(){return this.#F}unsetFingerprint(e){this.#F=this.#F.filter((t=>t.value!==e.value));const t=e.bannerId;t in this.#j&&delete this.#j[t],0>=this.#F.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){const t=this.#j[e]||null;return null===t?null:t.content?.breakpoint||null}isExternal(){return!0}delegateResponsiveBehaviour(){}redrawIfNeeded(){this.#U(!0)&&this.setState(this.STATE.RENDERED,"Banner was successfully redrawn.")}#U(e){let t=!e;if(!t)for(let e in this.#j){if(this.#j[e].needRedraw()){t=!0;break}}if(!t)return!1;const n=[];for(let e in this.#j){const t=this.#j[e].content;null!==t&&n.push(t.data.html)}if(0>=n.length)return this.element.innerHTML="",!0;const r=this.#$?this.#$.cloneNode(!0):null;return((null!==r&&void 0===r.dataset.ampBannerList?r.querySelector("[data-amp-banner-list]"):null)??r??this.element).innerHTML=n.join("\n"),null!==r&&(this.element.innerHTML=r.outerHTML),!0}}class ae extends z{#W;#F;constructor(e,t,n,r,i,a){super(e,t,n,i,a),this.#W=r,this.#F=[],this.setState(this.STATE.NEW,"Banner created.")}get iframe(){return this.#W}get fingerprints(){return this.#F}unsetFingerprint(e){this.#F=this.#F.filter((t=>t.value!==e.value)),0>=this.#F.length&&this.setState(this.STATE.CLOSED,"Banner has empty data.")}getCurrentBreakpoint(e){throw new Error("Method EmbedBanner.getCurrentBreakpoint() is not readable.")}isEmbed(){return!0}updatePositionData(e){const t=["id","name","rotationSeconds","displayType","breakpointType","dimensions"],n=this.positionData;for(let r of t)r in e&&(n[r]=e[r])}updateFingerprints(e){this.#F=e.map((e=>e instanceof K?e:K.createFromValue(e)))}}class se{#H;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.#H=e-1}getNextIdentifier(){return++this.#H}}function oe(e,t){if(e instanceof t.HTMLElement)return e;if("string"!=typeof e)throw new TypeError("Element must be instance of HTMLElement or String");let n;if(n="#"===e.charAt(0)?document.getElementById(e.slice(1)):document.querySelector(e),!(n instanceof t.HTMLElement))throw new TypeError("Selector "+e+" is invalid.");return n}class ce{#q;#T;#V;#G;#L=[];#Q;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.#q=e,this.#T=t,this.#V=n,this.#G=new se,this.#Q=new MutationObserver((e=>{for(const t of e){if(!(t.target instanceof HTMLElement))continue;const e=t.target.closest("[data-amp-attached]")?.dataset?.ampAttached,n=void 0!==e?this.getBannerByUid(parseInt(e)):null;n&&this.#q.dispatch(H.ON_BANNER_MUTATED,{banner:n,mutation:t})}})),this.STATE=W}addExternalBanner(e){e=oe(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:window);const t=this.#G.getNextIdentifier();e.setAttribute("data-amp-attached",t);const n=new ie(this.#T,this.#q,t,e);return this.#Y(e),this.#L.push(n),n}addManagedBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window;if(null===this.#V)throw new Error("Unable to add managed banner, renderer is not provided.");e=oe(e,i);const a=this.#G.getNextIdentifier();e.setAttribute("data-amp-attached",a);const s=new ne(this.#T,this.#V,this.#q,a,e,t,n,r);return this.#Y(e),this.#L.push(s),s}addEmbedBanner(e,t,n,r){e=oe(e,window),t=oe(t,window);const i=this.#G.getNextIdentifier();e.setAttribute("data-amp-attached",i);const a=new ae(this.#q,i,e,t,n,r);return this.#Y(e),this.#L.push(a),a}removeBanner(e){const t=this.#L.length;return this.#L=this.#L.filter((t=>t!==e)),t!==this.#L.length}getBannersByState(e){let{state:t,managed:n=!0,external:r=!0,embed:i=!0}=e;return this.#L.filter((e=>e instanceof z&&e.state===t&&!(e instanceof ne&&!n||e instanceof ie&&!r||e instanceof ae&&!i)))}getBannerByFingerprint(e){const t=e instanceof K?e.value:e;for(let e of this.#L)if(!(e instanceof ae))for(let n of e.fingerprints)if(n.value===t)return e;return null}getBannerByUid(e){for(let t of this.#L)if(t.uid===e)return t;return null}#Y(e){e._ampBannerMutationsObserved||(this.#Q.observe(e,{subtree:!0,childList:!0,characterData:!1,attributes:!0,attributeFilter:["data-amp-banner-close"]}),e._ampBannerMutationsObserved=!0)}}class le{#z;constructor(e){this.#z=e}static fromCurrentWindow(){return new le((()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth))}get width(){return this.#z()}}class ue{#K;#J;#X;#Z=null;constructor(e){let{storage:t,key:n,maxItems:r,onExternalChange:i}=e;switch(t){case"localStorage":"localStorage"in window?t=window.localStorage:(console.warn("LocalStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ee());break;case"sessionStorage":"sessionStorage"in window?t=window.sessionStorage:(console.warn("SessionStorage is not accessible in the window, fallback to memoryStorage."),t=this.#ee());break;default:"memoryStorage"!==t&&console.warn(`Unknown storage "${t}", fallback to memoryStorage.`),t=this.#ee()}this.#K=t,this.#J=n,this.#X=r,i&&this.#K instanceof Storage&&window.addEventListener("storage",(e=>{if(null!==e.key&&this.#J!==e.key)return;const t=this.#Z||[],n=null!==e.newValue&&""!==e.newValue?e.newValue.split(","):[],r=n.filter((e=>!t.includes(e)));this.#Z=n,0<r.length&&i(r)}))}persist(e,t){const n=this.#te(),r=n.indexOf(e);let i=!1;t&&-1===r?(n.push(e),i=!0):t||-1===r||(n.splice(r,1),i=!0),i&&(n.length>this.#X&&n.splice(n.length-this.#X),this.#Z=n,this.#ne())}isClosed(e){return-1!==this.#te().indexOf(e)}#te(){if(null!==this.#Z)return this.#Z;const e=this.#K.getItem(this.#J),t=null!==e&&""!==e?e.split(","):[];return this.#Z=t}#ne(){null!==this.#Z&&this.#K.setItem(this.#J,this.#Z.join(","))}#ee(){const e={items:{}};return e.setItem=function(e,t){this.items[e]=t}.bind(e),e.getItem=function(e){return e in this.items?this.items[e]:null}.bind(e),e}}class de{#re;#q;#ie;#ae;constructor(e){let{bannerManager:t,eventBus:n,config:r={storage:"memoryStorage",key:"amp-closed-banners",maxItems:500},frameMessenger:i}=e;this.#re=t,this.#q=n,this.#ie=i;const{storage:a,key:s,maxItems:o}=r;this.#ae=new ue({storage:a,key:s,maxItems:o,onExternalChange:e=>{e.forEach((e=>this.closeBanner(e)))}}),this.#ie&&this.#ie.on("bannerClosed",(e=>{let{data:t}=e;const{uid:n,bannerId:r,fingerprint:i}=t,a=this.#re.getBannerByUid(n);a instanceof ae&&(this.#ae.persist(r,!0),a.unsetFingerprint(i))}))}attachUi(){const e=e=>{let{banner:t,button:n}=e;n._ampCloseActionAttached||(n._ampCloseActionAttached=!0,n.addEventListener("click",(e=>{e.preventDefault();const r=n.closest("[data-amp-banner-fingerprint]");if(!r)return;const i=r.dataset.ampBannerFingerprint,a=t.fingerprints;for(let e=0;e<a.length;e++){const t=a[e];t.value===i&&this.closeBanner(t.bannerId)}})))};this.#q.subscribe(H.ON_BANNER_STATE_CHANGED,(t=>{let{banner:n}=t;n.state===n.STATE.RENDERED?Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})):n.state===n.STATE.CLOSED&&(n.element.innerHTML="")}),null,-100),this.#q.subscribe(H.ON_BANNER_MUTATED,(t=>{let{banner:n,mutation:r}=t;n.state===n.STATE.RENDERED&&(0<r.addedNodes.length&&Array.from(n.element.querySelectorAll("[data-amp-banner-close]")).forEach((t=>{e({banner:n,button:t})})),r.attributeName&&e({banner:n,button:r.target}))}))}isClosed(e){return this.#ae.isClosed(e)}closeBanner(e){const t=this.#re.getBannersByState({state:this.#re.STATE.RENDERED});for(let n=0;n<t.length;n++){const r=t[n],i=r.fingerprints.filter((t=>t.bannerId===e))[0];if(void 0===i)continue;if(r instanceof ae)return void(this.#ie&&this.#ie.sendToBanner(r,"closeBanner",{bannerId:e}));const a=r.element.querySelector(`[data-amp-banner-fingerprint="${i.value}"]`);if(!a)continue;let s=e=>e.remove();const o=e=>s=e;this.#q.dispatch(H.ON_BANNER_BEFORE_CLOSE,{fingerprint:i,element:a,banner:r,setOperation:o}),Promise.resolve(s(a)).then((()=>{this.#ae.persist(e,!0),this.#q.dispatch(H.ON_BANNER_AFTER_CLOSE,{fingerprint:i,element:a,banner:r}),r.unsetFingerprint(i)}))}}}class he{#se;#oe;#ce;constructor(){this.#se=new se,this.#oe={},this.#ce={}}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("function"!=typeof t)throw new TypeError("Listener must be of type function.");const i="idx_"+this.#se.getNextIdentifier();return this.#oe[e]=this.#oe[e]||{},this.#oe[e][i]={callback:t,scope:n,priority:r},e in this.#ce&&delete this.#ce[e],()=>{e in this.#oe&&i in this.#oe[e]&&delete this.#oe[e][i]}}dispatch(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let t of this.getSortedListeners(e))null!==t.scope?t.callback.call(t.scope,...n):t.callback(...n)}reset(){this.#oe={}}getSortedListeners(e){if(e in this.#ce)return this.#ce[e];const t=Object.values(this.#oe[e]||{}).sort(((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:0));return this.#ce[e]=t}}const pe=_.template;class fe{#le;#ue;constructor(e){this.#le=e,this.#ue={}}getTemplate(e){if(e in this.#ue)return this.#ue[e];if(!(e in this.#le))throw new Error(`Template with type "${e}" not found.`);return this.#ue[e]=pe(this.#le[e])}}class me{#de;constructor(e){this.#de=new fe(e)}render(e){let t=e.bannerData;return t=Array.isArray(t)?t.filter((e=>null!==e.content)):t,this.#de.getTemplate(e.positionData.displayType)({banner:e,data:t})}}class ge{static create(e,t,n,r,i,a){let s=[];for(let e in i)s.push({pixels:parseInt(e),ratio:i[e]});s=s.sort(((e,t)=>t.pixels-e.pixels));const o=e=>{const t=getComputedStyle(e),n=(e.offsetWidth-(parseFloat(t.paddingLeft)+parseFloat(t.paddingRight))-(parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)))*(e.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom))-(parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)));for(let e of s)if(n>=e.pixels)return e.ratio;return r};return new IntersectionObserver((r=>{const i=[];let s={},c={};for(let t of r){const r=t.target.dataset.ampBannerFingerprint,a=e.getBannerByFingerprint(r);if(!a)continue;const l=n[r];if(!l)continue;const u={fingerprint:l.fingerprint,element:t.target,banner:a};if(i.push({...u,entry:t}),!l.alreadySeen){const e=t.intersectionRatio>=o(t.target);s[r]=!(r in s)||!s[r].isIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isIntersecting:e}:s[r]}if(!l.alreadyFullySeen){const e=.99<=t.intersectionRatio;c[r]=!(r in c)||!c[r].isFullyIntersecting&&e?{fingerprintArgs:u,fingerprintMetadata:l,isFullyIntersecting:e}:c[r]}}for(let e of Object.values(s)){const{fingerprintArgs:n,fingerprintMetadata:r,isIntersecting:i}=e;i&&!r.alreadySeen&&null===r.firstTimeSeenTimeoutId?r.firstTimeSeenTimeoutId=setTimeout((()=>{r.alreadySeen=!0,t.dispatch(H.ON_BANNER_FIRST_TIME_SEEN,n)}),a):i||null===r.firstTimeSeenTimeoutId||(clearTimeout(r.firstTimeSeenTimeoutId),r.firstTimeSeenTimeoutId=null)}for(let e of Object.values(c)){const{fingerprintArgs:n,fingerprintMetadata:r,isFullyIntersecting:i}=e;i&&!r.alreadyFullySeen&&null===r.firstTimeFullySeenTimeoutId?r.firstTimeFullySeenTimeoutId=setTimeout((()=>{r.alreadyFullySeen=!0,t.dispatch(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,n)}),a):i||null===r.firstTimeFullySeenTimeoutId||(clearTimeout(r.firstTimeFullySeenTimeoutId),r.firstTimeFullySeenTimeoutId=null)}for(let e of i)t.dispatch(H.ON_BANNER_INTERSECTION_CHANGED,e)}),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,.99]})}}class be{#he;#re;#q;#F;#pe;constructor(e,t,n){this.#he=!1,this.#re=e,this.#q=t,this.#F={},this.#pe=ge.create(e,t,this.#F,n.defaultIntersectionRatio,n.intersectionRatioMap,n.firstTimeSeenTimeout)}start(){if(this.#he)return;this.#he=!0,this.#q.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;W.RENDERED!==t.state||t.isEmbed()||this.#fe(t)}),null,-100),this.#q.subscribe(H.ON_BANNER_MUTATED,(e=>{let{banner:t,mutation:n}=e;W.RENDERED===t.state&&!t.isEmbed()&&0<n.addedNodes.length&&this.#fe(t)}));const e=this.#re.getBannersByState({state:W.RENDERED,embed:!1});for(let t of e)this.#fe(t)}#fe(e){const t=this,n=e.element.querySelectorAll("[data-amp-banner-fingerprint]");for(let e of n){const n=e.dataset.ampBannerFingerprint;n in this.#F||(this.#F[n]={fingerprint:K.createFromValue(n),alreadySeen:!1,alreadyFullySeen:!1,firstTimeSeenTimeoutId:null,firstTimeFullySeenTimeoutId:null}),e._ampBannerFingerprintObserved||(e._ampBannerFingerprintObserved=!0,this.#pe.observe(e));const r=e.getElementsByTagName("a");for(let e of r)e._ampClickingMetricsAttached||(e._ampClickingMetricsAttached=!0,e.addEventListener("click",(function(e){const r=t.#F[n];if(!r)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the fingerprint "${n}" not managed.`);const i=t.#re.getBannerByFingerprint(n);if(!i)return void console.warn(`Unable to invoke an event "amp:banner:link-clicked" because the banner for fingerprint "${n}" not found.`);const a={fingerprint:r.fingerprint,element:this.closest("[data-amp-banner-fingerprint]"),banner:i,target:this,clickEvent:e};r.alreadySeen||(r.alreadySeen=!0,t.#q.dispatch(H.ON_BANNER_FIRST_TIME_SEEN,a)),t.#q.dispatch(H.ON_BANNER_LINK_CLICKED,a)})))}}}class ve{static get BANNER_LOADED(){return"amp:banner:loaded"}static get BANNER_DISPLAYED(){return"amp:banner:displayed"}static get BANNER_FULLY_DISPLAYED(){return"amp:banner:fully-displayed"}static get BANNER_CLICKED(){return"amp:banner:clicked"}static get BANNER_CLOSED(){return"amp:banner:closed"}static get EVENTS(){return[ve.BANNER_LOADED,ve.BANNER_DISPLAYED,ve.BANNER_FULLY_DISPLAYED,ve.BANNER_CLICKED,ve.BANNER_CLOSED]}}class Ee{constructor(e){const t={channel_code:"channel_code",banner_id:"banner_id",banner_name:"banner_name",position_id:"position_id",position_code:"position_code",position_name:"position_name",campaign_id:"campaign_id",campaign_code:"campaign_code",campaign_name:"campaign_name",breakpoint:"breakpoint",link:"link"};if("params"in e)for(let n in e.params)n in t&&"string"==typeof e.params[n]&&(t[n]=e.params[n]);const n="extraParams"in e&&"object"==typeof e.extraParams?e.extraParams:{},r={},i=e=>({name:e,enabled:!0,params:{...t},extraParams:{...n}});if(r[ve.BANNER_LOADED]=i(ve.BANNER_LOADED),r[ve.BANNER_DISPLAYED]=i(ve.BANNER_DISPLAYED),r[ve.BANNER_FULLY_DISPLAYED]=i(ve.BANNER_FULLY_DISPLAYED),r[ve.BANNER_CLICKED]=i(ve.BANNER_CLICKED),r[ve.BANNER_CLOSED]=i(ve.BANNER_CLOSED),"events"in e)for(let t in e.events){const n=e.events[t];if(!0!==n&&t in r)if(!1!==n)if("string"!=typeof n){if("object"==typeof n){if("name"in n&&"string"==typeof n.name&&(r[t].name=n.name),"params"in n&&"object"==typeof n.params)for(let e in n.params)e in r[t].params&&"string"==typeof n.params[e]&&(r[t].params[e]=n.params[e]);"extraParams"in n&&"object"==typeof n.extraParams&&(r[t].extraParams={...r[t].extraParams,...n.extraParams})}}else r[t].name=n;else r[t].enabled=!1}this.events=r}}class ye{#me;#q;#ge;#be;#ve={started:!1,events:[],cleanup:[]};constructor(e,t,n){this.#me=e,this.#q=t,this.#ge=n,this.#be=!1}collectBeforeAttach(){if(this.#ve.started||this.#be)return;this.#ve.started=!0;const e=this.#q,t=new Ee({}),n=t.events[ve.BANNER_LOADED],r=t.events[ve.BANNER_DISPLAYED],i=t.events[ve.BANNER_FULLY_DISPLAYED],a=t.events[ve.BANNER_CLICKED],s=t.events[ve.BANNER_CLOSED];this.#ve.cleanup.push(e.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&W.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)this.#ve.events.push({name:ve.BANNER_LOADED,params:this.#Ee({event:n,fingerprint:e,banner:t})})}))),this.#ve.cleanup.push(e.subscribe(H.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#ve.events.push({name:ve.BANNER_DISPLAYED,params:this.#Ee({event:r,fingerprint:t,banner:n})})}))),this.#ve.cleanup.push(e.subscribe(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:n}=e;this.#ve.events.push({name:ve.BANNER_FULLY_DISPLAYED,params:this.#Ee({event:i,fingerprint:t,banner:n})})}))),this.#ve.cleanup.push(e.subscribe(H.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:n,target:r}=e;const i=this.#Ee({event:a,fingerprint:t,banner:n});i[a.params.link]=r.href||"",this.#ve.events.push({name:ve.BANNER_CLICKED,params:i})}))),this.#ve.cleanup.push(e.subscribe(H.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:n}=e;this.#ve.events.push({name:ve.BANNER_CLOSED,params:this.#Ee({event:s,fingerprint:t,banner:n})})})))}attach(e){if(this.#be)return;this.#be=!0;const t=this.#q,n=this.#me;if(!n.hasAnyReceiver())return void this.#ye();const r=e.events[ve.BANNER_LOADED],i=e.events[ve.BANNER_DISPLAYED],a=e.events[ve.BANNER_FULLY_DISPLAYED],s=e.events[ve.BANNER_CLICKED],o=e.events[ve.BANNER_CLOSED];if(this.#ve.started){for(let t in this.#ve.events){const{name:r,params:i}=this.#ve.events[t],a=e.events[r];if(!a.enabled)continue;const s={};for(let e in i)s[a.params[e]]=i[e];n.send(a.name,{...s,...a.extraParams})}this.#ye()}r.enabled&&t.subscribe(H.ON_BANNER_STATE_CHANGED,(e=>{let{banner:t}=e;if(!t.isEmbed()&&W.RENDERED===t.state&&1===t.stateCounter)for(let e of t.fingerprints)n.send(r.name,this.#Ee({event:r,fingerprint:e,banner:t}))})),i.enabled&&t.subscribe(H.ON_BANNER_FIRST_TIME_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(i.name,this.#Ee({event:i,fingerprint:t,banner:r}))})),a.enabled&&t.subscribe(H.ON_BANNER_FIRST_TIME_FULLY_SEEN,(e=>{let{fingerprint:t,banner:r}=e;n.send(a.name,this.#Ee({event:a,fingerprint:t,banner:r}))})),s.enabled&&t.subscribe(H.ON_BANNER_LINK_CLICKED,(e=>{let{fingerprint:t,banner:r,target:i}=e;const a=this.#Ee({event:s,fingerprint:t,banner:r});a[s.params.link]=i.href||"",n.send(s.name,a)})),o.enabled&&t.subscribe(H.ON_BANNER_AFTER_CLOSE,(e=>{let{fingerprint:t,banner:r}=e;n.send(o.name,this.#Ee({event:o,fingerprint:t,banner:r}))}))}#Ee=e=>{let{event:t,fingerprint:n,banner:r}=e,i=r.getCurrentBreakpoint(n.bannerId);i=null===i?"default":`${"min"===r.positionData.breakpointType?">=":"<="}${i}`;const a={};return a[t.params.channel_code]=this.#ge,a[t.params.banner_id]=n.bannerId,a[t.params.banner_name]=n.bannerName,a[t.params.position_id]=n.positionId,a[t.params.position_code]=n.positionCode,a[t.params.position_name]=n.positionName,a[t.params.campaign_id]=n.campaignId,a[t.params.campaign_code]=n.campaignCode,a[t.params.campaign_name]=n.campaignName,a[t.params.breakpoint]=i,{...a,...t.extraParams}};#ye(){for(let e in this.#ve.cleanup)this.#ve.cleanup[e]();this.#ve.events=[],this.#ve.cleanup=[]}}let we=!1;const Te=(e,t)=>{if(!("plausible"in window)||"function"!=typeof window.plausible)return!we&&console.warn("Unable to send metrics to Plausible because the function plausible() does not occur in the window."),void(we=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.plausible(e,{props:t})};let Ne=!1;const Re=(e,t)=>{if(!("gtag"in window)||"function"!=typeof window.gtag)return!Ne&&console.warn("Unable to send metrics to Google Analytics because the function gtag() does not occur in the window."),void(Ne=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.gtag("event",e,t)};let Se=!1;const _e=(e,t)=>{if(!("dataLayer"in window))return!Se&&console.warn("Unable to send metrics to GTM because the dataLayer does not occur in the window."),void(Se=!0);Object.keys(t).forEach((e=>null===t[e]&&delete t[e])),window.dataLayer.push({event:e,...t})},Be=(e,t)=>{console.log("Sending metrics.",{eventName:e,eventArgs:t})};class Ae{#we;constructor(e){this.#we=Array.isArray(e)?e:[e]}static createFromReceivers(e){if(!e)return new Ae([]);e=Array.isArray(e)?e:[e];const t=[];for(let n of e)if("function"!=typeof n)switch(n){case"plausible":t.push(Te);break;case"gtag":t.push(Re);break;case"gtm":t.push(_e);break;case"debug":t.push(Be);break;default:console.warn("Unable to send metrics to a receiver of unknown type",n)}else t.push(n);return new Ae(t)}hasAnyReceiver(){return this.#we.length}send(e,t){for(let n of this.#we)n(e,t)}}class Ie{#Te;#q;constructor(e){let{origins:t=[]}=e;this.#q=new he,this.#Te=t}on(e,t){this.#q.subscribe(e,t)}send(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";e.postMessage({message:t,data:n},r)}listen(){window.addEventListener("message",(e=>{if(0<this.#Te.length&&-1===this.#Te.indexOf(e.origin)||"object"!=typeof e.data||!("message"in e.data)||!("data"in e.data))return;const{message:t,data:n}=e.data,r={data:n,origin:e.origin};this._beforeDispatch(t,r)&&this.#q.dispatch(t,r)}),!1)}_beforeDispatch(){return!0}}class Oe extends Ie{#h;#Ne;#re;#me;#Re=[];constructor(e){let{origin:t,connectionData:n,bannerManager:r,metricsSender:i}=e;super({origins:[t]}),this.#h=t,this.#Ne=n,this.#re=r,this.#me=i;const a={};a.adjustHeight=this.#Se,a.stateChanged=this.#_e,a.linkClicked=this.#Be,a.metrics=this.#Ae;for(let e in a)this.on(e,a[e].bind(this));window.addEventListener("resize",(()=>{const e=this.#re.getBannersByState({state:this.#re.STATE.RENDERED,managed:!1,external:!1,embed:!0});for(let t of e)this.sendToBanner(t,"windowResized",{windowWidth:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth})}))}connectBanner(e){e.iframe.addEventListener("load",(()=>{const t=this.#Ne;t.uid=e.uid,t.windowWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.sendToBanner(e,"connect",t)}))}sendToBanner(e,t,n){this.send(e.iframe.contentWindow,t,n,this.#h)}_beforeDispatch(e,t){let{data:n}=t;const{uid:r}=n;if(-1===this.#Re.indexOf(r)){const e=this.#Ie(r);e&&(e.iframe.style.visibility="visible",this.#Re.push(r))}return!0}#Se(e){let{data:t}=e;const n=this.#Ie(t.uid);n&&(n.iframe.style.height=t.height+"px")}#_e(e){let{data:t}=e;const n=this.#Ie(t.uid);null!==n&&("positionData"in t&&n.updatePositionData(t.positionData),"fingerprints"in t&&n.updateFingerprints(t.fingerprints),n.setState(t.state,`[embed]: ${t.stateInfo}`))}#Be(e){let{data:t}=e;const{href:n,target:r}=t;"_blank"===r?window.open(n,r):window.location.href=n}#Ae(e){let{data:t}=e;const{eventName:n,eventArgs:r}=t;this.#me.hasAnyReceiver()&&this.#me.send(n,r)}#Ie(e){const t=this.#re.getBannerByUid(e);return t instanceof ae?t:(console.warn(`Error in communication with embed banner. Embed banner with UID ${e} not attached.`),null)}}class De{#Oe;#De;#q;#Me;#Ce;#xe=null;#re;#Le;#ke;#me;#Pe;#ie;constructor(e,t){this.EVENTS=H,this.#Oe=e,this.#De=t=function(e){const t=o({method:"GET",url:null,version:1,channel:null,locale:null,resources:{},origin:null,template:c,interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{receiver:null,events:{},params:{},extraParams:{}},closing:{storage:"memoryStorage",key:"amp-closed-banners",maxItems:500}},e);if("string"!=typeof t.method||!(t.method.toUpperCase()in{GET:1,POST:1}))throw new Error(`The option "method" must be one of these ["GET", "POST"], ${t.method} passed.`);if(t.method=t.method.toUpperCase(),"string"!=typeof t.url)throw new Error(`The option "url" is required and must be a valid URL, ${t.url} passed.`);if("number"!=typeof t.version)throw new Error(`The option "version" must be a number, ${t.version} passed.`);if("string"!=typeof t.channel)throw new Error(`The option "channel" is required and must be a string, ${t.channel} passed.`);if(null!==t.locale&&"string"!=typeof t.locale)throw new Error(`The option "locale" must be a string, ${t.locale} passed.`);if("object"!=typeof t.resources)throw new Error(`The option "resources" must be an object of that describes resources, ${t.resources} passed.`);if(null!==t.origin&&"string"!=typeof t.origin)throw new Error(`The option "origin" must be a valid URL, ${t.origin} passed.`);if("object"!=typeof t.template)throw new Error(`The option "template" must be an object of the format { single: string, random: string, multiple: string }, ${t.template} passed.`);for(const[e,n]of Object.entries(t.template))if("string"!=typeof n)throw new Error(`The option "template.${e}" must be a string (lodash template), ${n} passed.`);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=l(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=l(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { receiver: null|string|function|array<string|function>, events: object, params: object }, ${t.metrics} passed.`);if(null!==t.metrics.receiver&&-1===["string","function"].indexOf(typeof t.metrics.receiver)&&!Array.isArray(t.metrics.receiver))throw new Error(`The option "metrics.receiver" must be a null or a string or a function or an array of strings|functions, "${t.metrics.receiver}" passed.`);if(Array.isArray(t.metrics.receiver)){for(let e in t.metrics.receiver)if(-1===["string","function"].indexOf(typeof t.metrics.receiver[e]))throw new Error(`The option "metrics.receiver.${e}" must be a string or a function, "${t.metrics.receiver[e]}" passed.`)}else t.metrics.receiver=null!==t.metrics.receiver?[t.metrics.receiver]:[];if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.closing||"string"!=typeof t.closing.storage||"string"!=typeof t.closing.key||!Number.isInteger(t.closing.maxItems)||1>t.closing.maxItems)throw new Error(`The option "closing" must be an object of the format { storage: "memoryStorage"|"localStorage"|"sessionStorage", key: string, maxItems: integer<1, max> }, ${JSON.stringify(t.closing)} passed.`);return t}(t),this.#q=new he,this.#Me=new $(t.method,t.url,t.version,t.channel),this.#Ce=new U(t.url,t.version,t.channel),this.#re=new ce(this.#q,le.fromCurrentWindow(),new me(t.template)),this.#Le=new be(this.#re,this.#q,t.interaction),this.#me=Ae.createFromReceivers(t.metrics.receiver),this.#Pe=new ye(this.#me,this.#q,t.channel),this.#ie=new Oe({origin:t.url,connectionData:{extendedConfig:{interaction:t.interaction,metrics:{events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams}}},bannerManager:this.#re,metricsSender:this.#me}),this.#ke=new de({bannerManager:this.#re,eventBus:this.#q,config:{storage:t.closing.storage,key:t.closing.key,maxItems:t.closing.maxItems},frameMessenger:this.#ie}),this.setLocale(t.locale),this.#Me.origin=t.origin;for(let e in t.resources)this.#Me.addDefaultResource(e,t.resources[e]),this.#Ce.addDefaultResource(e,t.resources[e]);window.addEventListener("resize",(()=>{const e=this.#re.getBannersByState({state:this.#re.STATE.RENDERED,managed:!0,external:!0,embed:!1});for(let t of e)t.redrawIfNeeded()})),this.#ie.listen(),this.#Pe.attach(new Ee({events:t.metrics.events,params:t.metrics.params,extraParams:t.metrics.extraParams})),this.#Le.start(),this.#ke.attachUi()}get version(){return this.#Oe}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#q.subscribe(e,t,n)}setLocale(e){this.#Me.locale=e,this.#Ce.locale=e}setGateway(e){if(!function(e){return e instanceof u}(e))throw new TypeError("Argument gateway mut be instance of AbstractGateway.");this.#xe=e}getGateway(){return null===this.#xe&&this.setGateway(new P),this.#xe}createBanner(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"managed",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window;if(e=oe(e,a),"embed"===i){const i=this.#Fe(e,t,n,r),a=this.#re.addEmbedBanner(e,i,t,r);return this.#ie.connectBanner(a),e.insertAdjacentElement("beforeend",i),a}return this.#re.addManagedBanner(e,t,n,r,a)}closeBanner(e){this.#ke.closeBanner(e)}attachBanners(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;const n=e.querySelectorAll("[data-amp-banner]:not([data-amp-attached])");for(let e of n){const n=e.dataset.ampBanner;if(!n){console.warn("Unable to attach a banner to the element ",e,' because the attribute "data-amp-banner" has an empty value.');continue}let r;if("ampBannerExternal"in e.dataset)r=this.#re.addExternalBanner(e,t);else{const i=re.parseResources(e),a=re.parseOptions(e),s=e.dataset.ampMode||"managed";r=this.createBanner(e,n,i,a,s,t)}this.#q.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:r})}}fetch(){const e=this.#re.getBannersByState({state:this.#re.STATE.NEW,managed:!0,external:!1,embed:!1});if(!e.length)return;const t=this.#Me.create();for(let n of e)t.addPosition(n.position,n.resources,"1"!==n.options.get("omit-default-resources","0").toString());this.#q.dispatch(this.EVENTS.ON_BEFORE_FETCH),this.getGateway().fetch(t,(t=>{const n=t.data;for(let t of e){if(!(t.position in n)||!("banners"in n[t.position])||!Object.values(n[t.position].banners).length){t.setState(this.#re.STATE.NOT_FOUND,"Banner not found in fetched response.");continue}const e=n[t.position],r=Array.isArray(e.banners)?e.banners:Object.values(e.banners),i=[];for(let e=0;e<r.length;e++){const t=r[e];t.id&&!this.#ke.isClosed(t.id)&&i.push(t)}e.banners=i,"embed"===e.mode&&0<e.banners.length?("options"in e&&t.overrideOptions(e.options),this.createBanner(t.element,t.position,t.rawResources,t.options.options,e.mode),this.#re.removeBanner(t)):t.setResponseData(e)}this.#q.dispatch(this.EVENTS.ON_FETCH_SUCCESS,{response:t})}),(t=>{for(let t of e)t.setState(this.#re.STATE.ERROR,"Request on api failed.");this.#q.dispatch(this.EVENTS.ON_FETCH_ERROR,{response:t})}))}#Fe(e,t,n,r){const i=document.createElement("iframe"),a=`cv=${encodeURIComponent(this.version.semver)}`,s=new Y(r);let o=e.dataset.ampEmbedSrc||this.#Ce.create(t,n,s.options);o+=-1===o.indexOf("?")?`?${a}`:`&${a}`,i.width="100%",i.height="100%",i.allowFullscreen=!0,i.scrolling="no",i.style.border="none",i.style.overflow="hidden",i.style.background="transparent",i.style.visibility="hidden",i.setAttribute("allowtransparency","true");const c=s.evaluate("loading",0),l=s.evaluate("fetchpriority",0);return null!==c&&(i.loading=c),null!==l&&i.setAttribute("fetchpriority",l),[...e.attributes].map((e=>{let{name:t,value:n}=e;return t.startsWith("data-iframe-")&&i.setAttribute(t.substring(12),n)})),i.src=o,i}}const Me=(e,t)=>{const n=Math.round(10*e)/10;return n!==e&&console.warn(`The value for the option "${t}" has been rounded to ${n} (originally ${e}).`),n};function Ce(e){const t=o({interaction:{defaultIntersectionRatio:.5,intersectionRatioMap:{},firstTimeSeenTimeout:1e3},metrics:{events:{},params:{},extraParams:{}}},e);if("object"!=typeof t.interaction)throw new Error(`The option "interaction" must be an object of the format { intersectionRatio: int|float, firstTimeSeenTimeout: int }, ${t.interaction} passed.`);if("number"!=typeof t.interaction.defaultIntersectionRatio||.1>t.interaction.defaultIntersectionRatio||1<t.interaction.defaultIntersectionRatio)throw new Error(`The option "interaction.defaultIntersectionRatio" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.defaultIntersectionRatio}" passed.`);if(t.interaction.defaultIntersectionRatio=Me(t.interaction.defaultIntersectionRatio,"interaction.defaultIntersectionRatio"),"object"!=typeof t.interaction.intersectionRatioMap)throw new Error(`The option "interaction.intersectionRatioMap" must be an object with an integer keys (pixels) and valid ratios as values, ${t.interaction.intersectionRatioMap} passed.`);for(const[e,n]of Object.entries(t.interaction.intersectionRatioMap)){if(Number(e).toString()!==e)throw new Error(`The key "interaction.intersectionRatioMap.${e}" must be an integer.`);if("number"!=typeof n||.1>n||1<n)throw new Error(`The option "interaction.intersectionRatioMap.${e}" must be a number between 0.1 and 1 in increments of 0.1 [e.g. 0.1, 0.2, 0.3, ...], "${t.interaction.intersectionRatioMap[e]}" passed.`);t.interaction.intersectionRatioMap[e]=Me(n,"interaction.intersectionRatioMap."+e)}if(!Number.isInteger(t.interaction.firstTimeSeenTimeout)||500>t.interaction.firstTimeSeenTimeout)throw new Error(`The option "interaction.firstTimeSeenTimeout" must be a int with a minimum value of 500, "${t.interaction.firstTimeSeenTimeout}" passed.`);if("object"!=typeof t.metrics)throw new Error(`The option "metrics" must be an object of the format { events: object, params: object }, ${JSON.stringify(t.metrics)} passed.`);if("object"!=typeof t.metrics.events)throw new Error(`The option "metrics.event" must be an object of the format { *: string|false|{ name?: string, params?: { *: string }, extraParams?: { *: scalar } } }, ${JSON.stringify(t.metrics.events)} passed.`);if("object"!=typeof t.metrics.params)throw new Error(`The option "metrics.params" must be an object of the format { *: string }, ${JSON.stringify(t.metrics.params)} passed.`);if("object"!=typeof t.metrics.extraParams)throw new Error(`The option "metrics.extraParams" must be an object of the format { *: scalar }, ${JSON.stringify(t.metrics.params)} passed.`);return t}class xe extends Ie{#je;#ke;#h;#f;#$e;constructor(e){let{clientEventBus:t,closingManager:n,origin:r}=e;super({origins:void 0!==r?[r]:[]}),this.#je=t,this.#ke=n,this.#h=r,this.#f=null,this.#$e=[];const i={};i.connect=this.#Ue,i.closeBanner=this.#We;const a={};a[H.ON_BANNER_STATE_CHANGED]=[this.#He,0],a[H.ON_BANNER_LINK_CLICKED]=[this.#qe,-100],a[H.ON_BANNER_AFTER_CLOSE]=[this.#Ve,0];for(let e in a)this.#je.subscribe(e,a[e][0].bind(this),null,a[e][1]);for(let e in i)this.on(e,i[e].bind(this))}sendToParent(e,t){null!==this.#f?(t.uid=this.#f,this.send(window.parent,e,t,this.#h||"*")):this.#$e.push({message:e,data:t})}#Ue(e){let{data:t}=e;if(null!==this.#f)return void console.warn(`The frame is already connected to the parent under the UID ${this.#f}.`);const{uid:n}=t;let r;this.#f=n;const i=()=>{const e=document.body.scrollHeight;r!==e&&(r=e,this.sendToParent("adjustHeight",{height:e}))};i(),setInterval(i,100),this.#Ge()}#We(e){let{data:t}=e;const{bannerId:n}=t;n&&this.#ke.closeBanner(n)}#He(e){let{banner:t}=e;if(W.NEW===t.state)return;const n={state:t.state,stateInfo:t.stateInfo};1===t.stateCounter&&(n.positionData=t.positionData.toObject(),n.fingerprints=t.fingerprints.map((e=>e.value))),this.sendToParent("stateChanged",n)}#qe(e){let{target:t,clickEvent:n}=e;n.preventDefault(),this.sendToParent("linkClicked",{href:t.href,target:t.target||null})}#Ve(e){let{fingerprint:t}=e;this.sendToParent("bannerClosed",{bannerId:t.bannerId,fingerprint:t.value})}#Ge(){for(let e of this.#$e)this.sendToParent(e.message,e.data);this.#$e=[]}}class Le{#Oe;#Qe;#Ye;#q;#re;#ie;#Le;#ke;#me;#Pe;#be;#ze=null;constructor(e,t){this.EVENTS=H,this.#Oe=e,this.#Qe=function(e){return o({channel:null},e)}(t),this.#Ye=Ce({}),this.#Ye=null,this.#q=new he,this.#re=new ce(this.#q,new le((()=>this.#ze||window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth))),this.#ke=new de({bannerManager:this.#re,eventBus:this.#q}),this.#ie=new xe({clientEventBus:this.#q,closingManager:this.#ke}),this.#be=!1,this.#Le=null,this.#me=new Ae([this.#Ke.bind(this)]),this.#Pe=new ye(this.#me,this.#q,this.#Qe.channel),this.#ie.on("connect",(e=>{let{data:t}=e;this.#Ye=Ce(t.extendedConfig),this.#ze=t.windowWidth,this.#Le=new be(this.#re,this.#q,this.#Ye.interaction),this.#Je(),this.#Pe.attach(new Ee(this.#Ye.metrics)),this.#Le.start()})),this.#ie.on("windowResized",(e=>{let{data:t}=e;this.#ze=t.windowWidth,this.#Je()})),this.#ie.listen(),this.#Pe.collectBeforeAttach(),this.#ke.attachUi()}get version(){return this.#Oe}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.#q.subscribe(e,t,n)}attachBanner(){if(this.#be)throw new Error("Method attachBanner() should be called only once.");const e=document.querySelector("[data-amp-banner]:not([data-amp-attached])");if(!e)return void console.warn("No banner found in the embed client.");const t=this.#re.addExternalBanner(e);this.#be=!0,this.#q.dispatch(this.EVENTS.ON_BANNER_ATTACHED,{banner:t})}#Ke(e,t){this.#ie.sendToParent("metrics",{eventName:e,eventArgs:t})}#Je(){for(let e of this.#re.getBannersByState({state:W.RENDERED}))e.redrawIfNeeded()}}const ke=a.rE;class Pe{static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new De(new s(ke,`standard@${ke}`),e)}static createEmbed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Le(new s(ke,`embed@${ke}`),e)}static get version(){return ke}}AMPClientFactory=r.default})();